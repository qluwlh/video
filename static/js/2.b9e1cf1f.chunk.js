/*! For license information please see 2.b9e1cf1f.chunk.js.LICENSE.txt */
(this["webpackJsonpmy-video-app"]=this["webpackJsonpmy-video-app"]||[]).push([[2],[function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var n=r(3);var i=r(12),a=r(16);var s=r(9);function o(t){return t}function u(t){return 0===t.length?o:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var l=r(5),c=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var s=this.operator,o=function(t,e,r){if(t){if(t instanceof n.a)return t;if(t[i.a])return t[i.a]()}return t||e||r?new n.a(t,e,r):new n.a(a.a)}(t,e,r);if(s?o.add(s.call(o,this.source)):o.add(this.source||l.a.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),l.a.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){l.a.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,i=e.destination,a=e.isStopped;if(r||a)return!1;t=i&&i instanceof n.a?i:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=d(e))((function(e,n){var i;i=r.subscribe((function(e){try{t(e)}catch(r){n(r),i&&i.unsubscribe()}}),n,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[s.a]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:u(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=d(t))((function(t,r){var n;e.subscribe((function(t){return n=t}),(function(t){return r(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function d(t){if(t||(t=l.a.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function i(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}},function(t,e,r){"use strict";t.exports=r(73)},function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var n=r(1),i=r(20),a=r(16),s=r(4),o=r(12),u=r(5),l=r(10),c=function(t){function e(r,n,i){var s=t.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=a.a;break;case 1:if(!r){s.destination=a.a;break}if("object"===typeof r){r instanceof e?(s.syncErrorThrowable=r.syncErrorThrowable,s.destination=r,r.add(s)):(s.syncErrorThrowable=!0,s.destination=new d(s,r));break}default:s.syncErrorThrowable=!0,s.destination=new d(s,r,n,i)}return s}return n.a(e,t),e.prototype[o.a]=function(){return this},e.create=function(t,r,n){var i=new e(t,r,n);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(s.a),d=function(t){function e(e,r,n,s){var o,u=t.call(this)||this;u._parentSubscriber=e;var l=u;return Object(i.a)(r)?o=r:r&&(o=r.next,n=r.error,s=r.complete,r!==a.a&&(l=Object.create(r),Object(i.a)(l.unsubscribe)&&u.add(l.unsubscribe.bind(l)),l.unsubscribe=u.unsubscribe.bind(u))),u._context=l,u._next=o,u._error=n,u._complete=s,u}return n.a(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;u.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=u.a.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):Object(l.a)(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;Object(l.a)(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};u.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(r){if(this.unsubscribe(),u.a.useDeprecatedSynchronousErrorHandling)throw r;Object(l.a)(r)}},e.prototype.__tryOrSetError=function(t,e,r){if(!u.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(n){return u.a.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=n,t.syncErrorThrown=!0,!0):(Object(l.a)(n),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(c)},function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(21),i=r(13),a=r(20),s=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),o=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this,o=r._parentOrParents,l=r._ctorUnsubscribe,c=r._unsubscribe,d=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,o instanceof t)o.remove(this);else if(null!==o)for(var f=0;f<o.length;++f){o[f].remove(this)}if(Object(a.a)(c)){l&&(this._unsubscribe=void 0);try{c.call(this)}catch(g){e=g instanceof s?u(g.errors):[g]}}if(Object(n.a)(d)){f=-1;for(var h=d.length;++f<h;){var p=d[f];if(Object(i.a)(p))try{p.unsubscribe()}catch(g){e=e||[],g instanceof s?e=e.concat(u(g.errors)):e.push(g)}}}if(e)throw new s(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!==typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=r._parentOrParents;if(null===i)r._parentOrParents=this;else if(i instanceof t){if(i===this)return r;r._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return r;i.push(this)}var a=this._subscriptions;return null===a?this._subscriptions=[r]:a.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function u(t){return t.reduce((function(t,e){return t.concat(e instanceof s?e.errors:e)}),[])}},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;n=t},get useDeprecatedSynchronousErrorHandling(){return n}}},function(t,e,r){"use strict";var n=r(34),i=Object.prototype.toString;function a(t){return"[object Array]"===i.call(t)}function s(t){return"undefined"===typeof t}function o(t){return null!==t&&"object"===typeof t}function u(t){if("[object Object]"!==i.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function l(t){return"[object Function]"===i.call(t)}function c(t,e){if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),a(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:a,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:function(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!==typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"===typeof t},isNumber:function(t){return"number"===typeof t},isObject:o,isPlainObject:u,isUndefined:s,isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:l,isStream:function(t){return o(t)&&l(t.pipe)},isURLSearchParams:function(t){return"undefined"!==typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)},forEach:c,merge:function t(){var e={};function r(r,n){u(e[n])&&u(r)?e[n]=t(e[n],r):u(r)?e[n]=t({},r):a(r)?e[n]=r.slice():e[n]=r}for(var n=0,i=arguments.length;n<i;n++)c(arguments[n],r);return e},extend:function(t,e,r){return c(e,(function(e,i){t[i]=r&&"function"===typeof e?n(e,r):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}}},function(t,e,r){"use strict";t.exports=r(48)},function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return l}));var n=r(1),i=r(3),a=r(0),s=r(27),o=function(t){function e(e){var r=t.call(this)||this;return r.parent=e,r}return n.a(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(i.a),u=(i.a,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n.a(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(i.a));i.a;function l(t,e){if(!e.closed){if(t instanceof a.a)return t.subscribe(e);var r;try{r=Object(s.a)(t)(e)}catch(n){e.error(n)}return r}}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){return"function"===typeof Symbol&&Symbol.observable||"@@observable"}()},function(t,e,r){"use strict";function n(t){setTimeout((function(){throw t}),0)}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";function n(){return"function"===typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}r.d(e,"a",(function(){return i}));var i=n()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){return"function"===typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},function(t,e,r){"use strict";function n(t){return null!==t&&"object"===typeof t}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(0),i=r(4);function a(t,e){return new n.a((function(r){var n=new i.a,a=0;return n.add(e.schedule((function(){a!==t.length?(r.next(t[a++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}},function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n=r(0),i=r(27),a=r(4),s=r(9);var o=r(14),u=r(11);var l=r(25),c=r(23);function d(t,e){if(null!=t){if(function(t){return t&&"function"===typeof t[s.a]}(t))return function(t,e){return new n.a((function(r){var n=new a.a;return n.add(e.schedule((function(){var i=t[s.a]();n.add(i.subscribe({next:function(t){n.add(e.schedule((function(){return r.next(t)})))},error:function(t){n.add(e.schedule((function(){return r.error(t)})))},complete:function(){n.add(e.schedule((function(){return r.complete()})))}}))}))),n}))}(t,e);if(Object(l.a)(t))return function(t,e){return new n.a((function(r){var n=new a.a;return n.add(e.schedule((function(){return t.then((function(t){n.add(e.schedule((function(){r.next(t),n.add(e.schedule((function(){return r.complete()})))})))}),(function(t){n.add(e.schedule((function(){return r.error(t)})))}))}))),n}))}(t,e);if(Object(c.a)(t))return Object(o.a)(t,e);if(function(t){return t&&"function"===typeof t[u.a]}(t)||"string"===typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new n.a((function(r){var n,i=new a.a;return i.add((function(){n&&"function"===typeof n.return&&n.return()})),i.add(e.schedule((function(){n=t[u.a](),i.add(e.schedule((function(){if(!r.closed){var t,e;try{var i=n.next();t=i.value,e=i.done}catch(a){return void r.error(a)}e?r.complete():(r.next(t),this.schedule())}})))}))),i}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function f(t,e){return e?d(t,e):t instanceof n.a?t:new n.a(Object(i.a)(t))}},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(5),i=r(10),a={closed:!0,next:function(t){},error:function(t){if(n.a.useDeprecatedSynchronousErrorHandling)throw t;Object(i.a)(t)},complete:function(){}}},function(t,e,r){var n;"undefined"!==typeof window&&(n=function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,i="~";function a(){}function s(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,r,n,a){if("function"!==typeof r)throw new TypeError("The listener must be a function");var o=new s(r,n||t,a),u=i?i+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],o]:t._events[u].push(o):(t._events[u]=o,t._eventsCount++),t}function u(t,e){0===--t._eventsCount?t._events=new a:delete t._events[e]}function l(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(i=!1)),l.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},l.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,a=r.length,s=new Array(a);n<a;n++)s[n]=r[n].fn;return s},l.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},l.prototype.emit=function(t,e,r,n,a,s){var o=i?i+t:t;if(!this._events[o])return!1;var u,l,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,r),!0;case 4:return c.fn.call(c.context,e,r,n),!0;case 5:return c.fn.call(c.context,e,r,n,a),!0;case 6:return c.fn.call(c.context,e,r,n,a,s),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var f,h=c.length;for(l=0;l<h;l++)switch(c[l].once&&this.removeListener(t,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,e);break;case 3:c[l].fn.call(c[l].context,e,r);break;case 4:c[l].fn.call(c[l].context,e,r,n);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];c[l].fn.apply(c[l].context,u)}}return!0},l.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},l.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},l.prototype.removeListener=function(t,e,r,n){var a=i?i+t:t;if(!this._events[a])return this;if(!e)return u(this,a),this;var s=this._events[a];if(s.fn)s.fn!==e||n&&!s.once||r&&s.context!==r||u(this,a);else{for(var o=0,l=[],c=s.length;o<c;o++)(s[o].fn!==e||n&&!s[o].once||r&&s[o].context!==r)&&l.push(s[o]);l.length?this._events[a]=1===l.length?l[0]:l:u(this,a)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&u(this,e)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=i,l.EventEmitter=l,t.exports=l},"./node_modules/url-toolkit/src/url-toolkit.js":function(t,e,r){!function(e){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,n=/^([^\/?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;var i=s.parseURL(t);if(!i)throw new Error("Error trying to parse base URL.");return i.path=s.normalizePath(i.path),s.buildURLFromParts(i)}var a=s.parseURL(e);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):e;var o=s.parseURL(t);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var u=n.exec(o.path);o.netLoc=u[1],o.path=u[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(d)}else l.path=o.path,a.params||(l.params=o.params,a.query||(l.query=o.query));return null===l.path&&(l.path=r.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(l)},parseURL:function(t){var e=r.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(i,"");t.length!==(t=t.replace(a,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=s}()},"./node_modules/webworkify-webpack/index.js":function(t,e,r){function n(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.i=function(t){return t},r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r.oe=function(t){throw console.error(t),t};var n=r(r.s=ENTRY_MODULE);return n.default||n}var i="[\\.|\\-|\\+|\\w|/|@]+",a="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function s(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(t,e,n){var o={};o[n]=[];var u=e.toString(),l=u.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return o;for(var c,d=l[1],f=new RegExp("(\\\\n|\\W)"+s(d)+a,"g");c=f.exec(u);)"dll-reference"!==c[3]&&o[n].push(c[3]);for(f=new RegExp("\\("+s(d)+'\\("(dll-reference\\s('+i+'))"\\)\\)'+a,"g");c=f.exec(u);)t[c[2]]||(o[n].push(c[1]),t[c[2]]=r(c[1]).m),o[c[2]]=o[c[2]]||[],o[c[2]].push(c[4]);for(var h,p=Object.keys(o),g=0;g<p.length;g++)for(var m=0;m<o[p[g]].length;m++)h=o[p[g]][m],isNaN(1*h)||(o[p[g]][m]=1*o[p[g]][m]);return o}function u(t){return Object.keys(t).reduce((function(e,r){return e||t[r].length>0}),!1)}t.exports=function(t,e){e=e||{};var i={main:r.m},a=e.all?{main:Object.keys(i.main)}:function(t,e){for(var r={main:[e]},n={main:[]},i={main:{}};u(r);)for(var a=Object.keys(r),s=0;s<a.length;s++){var l=a[s],c=r[l].pop();if(i[l]=i[l]||{},!i[l][c]&&t[l][c]){i[l][c]=!0,n[l]=n[l]||[],n[l].push(c);for(var d=o(t,t[l][c],l),f=Object.keys(d),h=0;h<f.length;h++)r[f[h]]=r[f[h]]||[],r[f[h]]=r[f[h]].concat(d[f[h]])}}return n}(i,t),s="";Object.keys(a).filter((function(t){return"main"!==t})).forEach((function(t){for(var e=0;a[t][e];)e++;a[t].push(e),i[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",s=s+"var "+t+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a[t].map((function(e){return JSON.stringify(e)+": "+i[t][e].toString()})).join(",")+"});\n"})),s=s+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a.main.map((function(t){return JSON.stringify(t)+": "+i.main[t].toString()})).join(",")+"}))(self);";var l=new window.Blob([s],{type:"text/javascript"});if(e.bare)return l;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(l),d=new window.Worker(c);return d.objectURL=c,d}},"./src/config.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"hlsDefaultConfig",(function(){return S})),r.d(e,"mergeConfig",(function(){return w})),r.d(e,"enableStreamingMode",(function(){return _}));var n=r("./src/controller/abr-controller.ts"),i=r("./src/controller/audio-stream-controller.ts"),a=r("./src/controller/audio-track-controller.ts"),s=r("./src/controller/subtitle-stream-controller.ts"),o=r("./src/controller/subtitle-track-controller.ts"),u=r("./src/controller/buffer-controller.ts"),l=r("./src/controller/timeline-controller.ts"),c=r("./src/controller/cap-level-controller.ts"),d=r("./src/controller/fps-controller.ts"),f=r("./src/controller/eme-controller.ts"),h=r("./src/utils/xhr-loader.ts"),p=r("./src/utils/fetch-loader.ts"),g=r("./src/utils/cues.ts"),m=r("./src/utils/mediakeys-helper.ts"),v=r("./src/utils/logger.ts");function y(){return(y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function b(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function E(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?b(Object(r),!0).forEach((function(e){T(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function T(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var S=E(E({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:h.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:n.default,bufferController:u.default,capLevelController:c.default,fpsController:d.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:m.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0},{cueHandler:g.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:s.SubtitleStreamController,subtitleTrackController:o.default,timelineController:l.TimelineController,audioStreamController:i.default,audioTrackController:a.default,emeController:f.default});function w(t,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==e.liveMaxLatencyDurationCount&&(void 0===e.liveSyncDurationCount||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==e.liveMaxLatencyDuration&&(void 0===e.liveSyncDuration||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return y({},t,e)}function _(t){var e=t.loader;e!==p.default&&e!==h.default?(v.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1):Object(p.fetchSupported)()&&(t.loader=p.default,t.progressive=!0,t.enableSoftwareAES=!0,v.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}},"./src/controller/abr-controller.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/polyfills/number.ts"),i=r("./src/utils/ewma-bandwidth-estimator.ts"),a=r("./src/events.ts"),s=r("./src/utils/buffer-helper.ts"),o=r("./src/errors.ts"),u=r("./src/types/loader.ts"),l=r("./src/utils/logger.ts");function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var d=function(){function t(t){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=t;var e=t.config;this.bwEstimator=new i.default(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate),this.registerListeners()}var e,r,d,f=t.prototype;return f.registerListeners=function(){var t=this.hls;t.on(a.Events.FRAG_LOADING,this.onFragLoading,this),t.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),t.on(a.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.on(a.Events.ERROR,this.onError,this)},f.unregisterListeners=function(){var t=this.hls;t.off(a.Events.FRAG_LOADING,this.onFragLoading,this),t.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),t.off(a.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.off(a.Events.ERROR,this.onError,this)},f.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},f.onFragLoading=function(t,e){var r,n=e.frag;n.type===u.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=n,this.partCurrent=null!=(r=e.part)?r:null,this.timer=self.setInterval(this.onCheck,100)))},f.onLevelLoaded=function(t,e){var r=this.hls.config;e.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)},f._abandonRulesCheck=function(){var t=this.fragCurrent,e=this.partCurrent,r=this.hls,i=r.autoLevelEnabled,o=r.config,u=r.media;if(t&&u){var c=e?e.stats:t.stats,d=e?e.duration:t.duration;if(c.aborted)return l.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(i&&!u.paused&&u.playbackRate&&u.readyState){var f=performance.now()-c.loading.start,h=Math.abs(u.playbackRate);if(!(f<=500*d/h)){var p=r.levels,g=r.minAutoLevel,m=p[t.level],v=c.total||Math.max(c.loaded,Math.round(d*m.maxBitrate/8)),y=Math.max(1,c.bwEstimate?c.bwEstimate/8:1e3*c.loaded/f),b=(v-c.loaded)/y,E=u.currentTime,T=(s.BufferHelper.bufferInfo(u,E,o.maxBufferHole).end-E)/h;if(!(T>=2*d/h||b<=T)){var S,w=Number.POSITIVE_INFINITY;for(S=t.level-1;S>g&&!((w=d*p[S].maxBitrate/(6.4*y))<T);S--);if(!(w>=b)){var _=this.bwEstimator.getEstimate();l.logger.warn("Fragment "+t.sn+(e?" part "+e.index:"")+" of level "+t.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+S+"\n      Current BW estimate: "+(Object(n.isFiniteNumber)(_)?(_/1024).toFixed(3):"Unknown")+" Kb/s\n      Estimated load time for current fragment: "+b.toFixed(3)+" s\n      Estimated load time for the next fragment: "+w.toFixed(3)+" s\n      Time to underbuffer: "+T.toFixed(3)+" s"),r.nextLoadLevel=S,this.bwEstimator.sample(f,c.loaded),this.clearTimer(),t.loader&&(this.fragCurrent=this.partCurrent=null,t.loader.abort()),r.trigger(a.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:e,stats:c})}}}}}},f.onFragLoaded=function(t,e){var r=e.frag,i=e.part;if(r.type===u.PlaylistLevelType.MAIN&&Object(n.isFiniteNumber)(r.sn)){var s=i?i.stats:r.stats,o=i?i.duration:r.duration;if(this.clearTimer(),this.lastLoadedFragLevel=r.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var l=this.hls.levels[r.level],c=(l.loaded?l.loaded.bytes:0)+s.loaded,d=(l.loaded?l.loaded.duration:0)+o;l.loaded={bytes:c,duration:d},l.realBitrate=Math.round(8*c/d)}if(r.bitrateTest){var f={stats:s,frag:r,part:i,id:r.type};this.onFragBuffered(a.Events.FRAG_BUFFERED,f),r.bitrateTest=!1}}},f.onFragBuffered=function(t,e){var r=e.frag,n=e.part,i=n?n.stats:r.stats;if(!i.aborted&&r.type===u.PlaylistLevelType.MAIN&&"initSegment"!==r.sn){var a=i.parsing.end-i.loading.start;this.bwEstimator.sample(a,i.loaded),i.bwEstimate=this.bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}},f.onError=function(t,e){switch(e.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},f.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},f.getNextABRAutoLevel=function(){var t=this.fragCurrent,e=this.partCurrent,r=this.hls,n=r.maxAutoLevel,i=r.config,a=r.minAutoLevel,o=r.media,u=e?e.duration:t?t.duration:0,c=o?o.currentTime:0,d=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,f=this.bwEstimator?this.bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,h=(s.BufferHelper.bufferInfo(o,c,i.maxBufferHole).end-c)/d,p=this.findBestLevel(f,a,n,h,i.abrBandWidthFactor,i.abrBandWidthUpFactor);if(p>=0)return p;l.logger.trace((h?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var g=u?Math.min(u,i.maxStarvationDelay):i.maxStarvationDelay,m=i.abrBandWidthFactor,v=i.abrBandWidthUpFactor;if(!h){var y=this.bitrateTestDelay;y&&(g=(u?Math.min(u,i.maxLoadingDelay):i.maxLoadingDelay)-y,l.logger.trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*g)+" ms"),m=v=1)}return p=this.findBestLevel(f,a,n,h+g,m,v),Math.max(p,0)},f.findBestLevel=function(t,e,r,n,i,a){for(var s,o=this.fragCurrent,u=this.partCurrent,c=this.lastLoadedFragLevel,d=this.hls.levels,f=d[c],h=!(null===f||void 0===f||null===(s=f.details)||void 0===s||!s.live),p=null===f||void 0===f?void 0:f.codecSet,g=u?u.duration:o?o.duration:0,m=r;m>=e;m--){var v=d[m];if(v&&(!p||v.codecSet===p)){var y=v.details,b=(u?null===y||void 0===y?void 0:y.partTarget:null===y||void 0===y?void 0:y.averagetargetduration)||g,E=void 0;E=m<=c?i*t:a*t;var T=d[m].maxBitrate,S=T*b/E;if(l.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+m+"/"+Math.round(E)+"/"+T+"/"+b+"/"+n+"/"+S),E>T&&(!S||h&&!this.bitrateTestDelay||S<n))return m}}return-1},e=t,(r=[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,e=this.bwEstimator;if(-1!==t&&(!e||!e.canEstimate()))return t;var r=this.getNextABRAutoLevel();return-1!==t&&(r=Math.min(t,r)),r},set:function(t){this._nextAutoLevel=t}}])&&c(e.prototype,r),d&&c(e,d),t}();e.default=d},"./src/controller/audio-stream-controller.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/polyfills/number.ts"),i=r("./src/controller/base-stream-controller.ts"),a=r("./src/events.ts"),s=r("./src/utils/buffer-helper.ts"),o=r("./src/controller/fragment-tracker.ts"),u=r("./src/types/level.ts"),l=r("./src/types/loader.ts"),c=r("./src/loader/fragment.ts"),d=r("./src/demux/chunk-cache.ts"),f=r("./src/demux/transmuxer-interface.ts"),h=r("./src/types/transmuxer.ts"),p=r("./src/controller/fragment-finders.ts"),g=r("./src/utils/discontinuities.ts"),m=r("./src/controller/gap-controller.ts"),v=r("./src/errors.ts"),y=r("./src/utils/logger.ts");function b(){return(b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var T=function(t){var e,r;function T(e,r){var n;return(n=t.call(this,e,r,"[audio-stream-controller]")||this).videoBuffer=null,n.videoTrackCC=-1,n.waitingVideoCC=-1,n.audioSwitch=!1,n.trackId=-1,n.waitingData=null,n.mainDetails=null,n._registerListeners(),n}r=t,(e=T).prototype=Object.create(r.prototype),e.prototype.constructor=e,E(e,r);var S=T.prototype;return S.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},S._registerListeners=function(){var t=this.hls;t.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.on(a.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(a.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(a.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(a.Events.ERROR,this.onError,this),t.on(a.Events.BUFFER_RESET,this.onBufferReset,this),t.on(a.Events.BUFFER_CREATED,this.onBufferCreated,this),t.on(a.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(a.Events.FRAG_BUFFERED,this.onFragBuffered,this)},S._unregisterListeners=function(){var t=this.hls;t.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.off(a.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(a.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(a.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(a.Events.ERROR,this.onError,this),t.off(a.Events.BUFFER_RESET,this.onBufferReset,this),t.off(a.Events.BUFFER_CREATED,this.onBufferCreated,this),t.off(a.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(a.Events.FRAG_BUFFERED,this.onFragBuffered,this)},S.onInitPtsFound=function(t,e){var r=e.frag,n=e.id,a=e.initPTS;if("main"===n){var s=r.cc;this.initPTS[r.cc]=a,this.log("InitPTS for cc: "+s+" found from main: "+a),this.videoTrackCC=s,this.state===i.State.WAITING_INIT_PTS&&this.tick()}},S.startLoad=function(t){if(!this.levels)return this.startPosition=t,void(this.state=i.State.STOPPED);var e=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,e>0&&-1===t?(this.log("Override startPosition with lastCurrentTime @"+e.toFixed(3)),this.state=i.State.IDLE):(this.loadedmetadata=!1,this.state=i.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()},S.doTick=function(){switch(this.state){case i.State.IDLE:this.doTickIdle();break;case i.State.WAITING_TRACK:var e,r=this.levels,n=this.trackId,a=null===r||void 0===r||null===(e=r[n])||void 0===e?void 0:e.details;if(a){if(this.waitForCdnTuneIn(a))break;this.state=i.State.WAITING_INIT_PTS}break;case i.State.FRAG_LOADING_WAITING_RETRY:var o,u=performance.now(),l=this.retryDate;(!l||u>=l||null!==(o=this.media)&&void 0!==o&&o.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=i.State.IDLE);break;case i.State.WAITING_INIT_PTS:var c=this.waitingData;if(c){var d=c.frag,f=c.part,h=c.cache,g=c.complete;if(void 0!==this.initPTS[d.cc]){this.waitingData=null,this.state=i.State.FRAG_LOADING;var m={frag:d,part:f,payload:h.flush(),networkDetails:null};this._handleFragmentLoadProgress(m),g&&t.prototype._handleFragmentLoadComplete.call(this,m)}else if(this.videoTrackCC!==this.waitingVideoCC)y.logger.log("Waiting fragment cc ("+d.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var v=s.BufferHelper.bufferInfo(this.mediaBuffer,this.media.currentTime,this.config.maxBufferHole);Object(p.fragmentWithinToleranceTest)(v.end,this.config.maxFragLookUpTolerance,d)<0&&(y.logger.log("Waiting fragment cc ("+d.cc+") @ "+d.start+" cancelled because another fragment at "+v.end+" is needed"),this.clearWaitingFragment())}}else this.state=i.State.IDLE}this.onTickEnd()},S.clearWaitingFragment=function(){var t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=i.State.IDLE)},S.onTickEnd=function(){var t=this.media;if(t&&t.readyState){var e=(this.mediaBuffer?this.mediaBuffer:t).buffered;!this.loadedmetadata&&e.length&&(this.loadedmetadata=!0),this.lastCurrentTime=t.currentTime}},S.doTickIdle=function(){var t,e,r=this.hls,o=this.levels,u=this.media,l=this.trackId,c=r.config;if(o&&o[l]&&(u||!this.startFragRequested&&c.startFragPrefetch)){var d=this.getLoadPosition();if(Object(n.isFiniteNumber)(d)){var f=o[l].details;if(!f||f.live&&this.levelLastLoaded!==l||this.waitForCdnTuneIn(f))this.state=i.State.WAITING_TRACK;else{var h=f.initSegment,p=0;if(!h||h.data){var g=this.mediaBuffer?this.mediaBuffer:this.media,v=this.videoBuffer?this.videoBuffer:this.media,y=d<c.maxBufferHole?Math.max(m.MAX_START_GAP_JUMP,c.maxBufferHole):c.maxBufferHole,b=s.BufferHelper.bufferInfo(g,d,y),E=s.BufferHelper.bufferInfo(v,d,y),T=b.len,S=Math.min(c.maxBufferLength,c.maxMaxBufferLength),w=Math.max(S,E.len),_=this.audioSwitch;if(T>=w&&!_)return;if(!_&&this._streamEnded(b,f))return r.trigger(a.Events.BUFFER_EOS,{type:"audio"}),void(this.state=i.State.ENDED);var k=f.fragments[0].start;if(p=b.end,_&&(p=d,f.PTSKnown&&d<k&&(b.end>k||b.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),u.currentTime=k+.05)),!(h=this.getNextFragment(p,f)))return}"identity"!==(null===(t=h.decryptdata)||void 0===t?void 0:t.keyFormat)||null!==(e=h.decryptdata)&&void 0!==e&&e.key?this.loadFragment(h,f,p):(this.log("Loading key for "+h.sn+" of ["+f.startSN+" ,"+f.endSN+"],track "+l),this.state=i.State.KEY_LOADING,r.trigger(a.Events.KEY_LOADING,{frag:h}))}}}},S.onMediaDetaching=function(){this.videoBuffer=null,t.prototype.onMediaDetaching.call(this)},S.onAudioTracksUpdated=function(t,e){var r=e.audioTracks;this.levels=r.map((function(t){return new u.Level(t)}))},S.onAudioTrackSwitching=function(t,e){var r=!!e.url;this.trackId=e.id;var n=this.fragCurrent,a=this.transmuxer;null!==n&&void 0!==n&&n.loader&&n.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),r?this.setInterval(100):a&&(a.destroy(),this.transmuxer=null),r?(this.audioSwitch=!0,this.state=i.State.IDLE):this.state=i.State.STOPPED,this.tick()},S.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0},S.onLevelLoaded=function(t,e){if(null===this.mainDetails){var r=this.mainDetails=e.details,n=this.levelLastLoaded;if(null!==n&&this.levels&&-1===this.startPosition&&r.live){var i=this.levels[n];if(!i.details||!i.details.fragments[0])return;Object(g.alignPDT)(i.details,r),this.setStartPosition(i.details,i.details.fragments[0].start)}}},S.onAudioTrackLoaded=function(t,e){var r,n=this.levels,a=e.details,s=e.id;if(n){this.log("Track "+s+" loaded ["+a.startSN+","+a.endSN+"],duration:"+a.totalduration);var o=n[s],u=0;if(a.live||null!==(r=o.details)&&void 0!==r&&r.live){var l;if(a.fragments[0]||(a.deltaUpdateFailed=!0),a.deltaUpdateFailed)return;!o.details&&null!==(l=this.mainDetails)&&void 0!==l&&l.hasProgramDateTime&&a.hasProgramDateTime?(Object(g.alignPDT)(a,this.mainDetails),u=a.fragments[0].start):u=this.alignPlaylists(a,o.details)}o.details=a,this.levelLastLoaded=s,this.startFragRequested||!this.mainDetails&&a.live||this.setStartPosition(o.details,u),this.state!==i.State.WAITING_TRACK||this.waitForCdnTuneIn(a)||(this.state=i.State.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+s)},S._handleFragmentLoadProgress=function(t){var e,r=t.frag,n=t.part,a=t.payload,s=this.config,o=this.trackId,u=this.levels;if(u){var c=u[o];console.assert(c,"Audio track is defined on fragment load progress");var p=c.details;console.assert(p,"Audio track details are defined on fragment load progress");var g=s.defaultAudioCodec||c.audioCodec||"mp4a.40.2",m=this.transmuxer;m||(m=this.transmuxer=new f.default(this.hls,l.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var v=this.initPTS[r.cc],b=null===(e=p.initSegment)||void 0===e?void 0:e.data;if(void 0!==v){var E=n?n.index:-1,T=-1!==E,S=new h.ChunkMetadata(r.level,r.sn,r.stats.chunkCount,a.byteLength,E,T);m.push(a,b,g,"",r,n,p.totalduration,!1,S,v)}else y.logger.log("Unknown video PTS for cc "+r.cc+", waiting for video PTS before demuxing audio frag "+r.sn+" of ["+p.startSN+" ,"+p.endSN+"],track "+o),(this.waitingData=this.waitingData||{frag:r,part:n,cache:new d.default,complete:!1}).cache.push(new Uint8Array(a)),this.waitingVideoCC=this.videoTrackCC,this.state=i.State.WAITING_INIT_PTS}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},S._handleFragmentLoadComplete=function(e){this.waitingData?this.waitingData.complete=!0:t.prototype._handleFragmentLoadComplete.call(this,e)},S.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},S.onBufferCreated=function(t,e){var r=e.tracks.audio;r&&(this.mediaBuffer=r.buffer),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},S.onFragBuffered=function(t,e){var r=e.frag,n=e.part;r.type===l.PlaylistLevelType.AUDIO&&(this.fragContextChanged(r)?this.warn("Fragment "+r.sn+(n?" p: "+n.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):("initSegment"!==r.sn&&(this.fragPrevious=r,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(a.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(r,n)))},S.onError=function(t,e){switch(e.details){case v.ErrorDetails.FRAG_LOAD_ERROR:case v.ErrorDetails.FRAG_LOAD_TIMEOUT:case v.ErrorDetails.KEY_LOAD_ERROR:case v.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(l.PlaylistLevelType.AUDIO,e);break;case v.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case v.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==i.State.ERROR&&this.state!==i.State.STOPPED&&(this.state=e.fatal?i.State.ERROR:i.State.IDLE,this.warn(e.details+" while loading frag, switching to "+this.state+" state"));break;case v.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===i.State.PARSING||this.state===i.State.PARSED)){var r=this.mediaBuffer,n=this.media.currentTime;r&&s.BufferHelper.isBuffered(r,n)&&s.BufferHelper.isBuffered(r,n+.5)?(this.reduceMaxBufferLength(),this.state=i.State.IDLE):(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.hls.trigger(a.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}))}}},S.onBufferFlushed=function(t,e){var r=e.type;if(r===c.ElementaryStreamTypes.AUDIO){var n=this.mediaBuffer?this.mediaBuffer:this.media;this.afterBufferFlushed(n,r)}},S._handleTransmuxComplete=function(t){var e,r="audio",n=this.hls,s=t.remuxResult,o=t.chunkMeta,u=this.getCurrentContext(o);if(!u)return this.warn("The loading context changed while buffering fragment "+o.sn+" of level "+o.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(o.level);var l=u.frag,d=u.part,f=s.audio,h=s.text,p=s.id3,g=s.initSegment;if(!this.fragContextChanged(l)){if(this.state=i.State.PARSING,this.audioSwitch&&f&&this.completeAudioSwitch(),null!==g&&void 0!==g&&g.tracks&&(this._bufferInitSegment(g.tracks,l,o),n.trigger(a.Events.FRAG_PARSING_INIT_SEGMENT,{frag:l,id:r,tracks:g.tracks})),f){var m=f.startPTS,v=f.endPTS,y=f.startDTS,E=f.endDTS;d&&(d.elementaryStreams[c.ElementaryStreamTypes.AUDIO]={startPTS:m,endPTS:v,startDTS:y,endDTS:E}),l.setElementaryStreamInfo(c.ElementaryStreamTypes.AUDIO,m,v,y,E),this.bufferFragmentData(f,l,d,o)}if(null!==p&&void 0!==p&&null!==(e=p.samples)&&void 0!==e&&e.length){var T=b({frag:l,id:r},p);n.trigger(a.Events.FRAG_PARSING_METADATA,T)}if(h){var S=b({frag:l,id:r},h);n.trigger(a.Events.FRAG_PARSING_USERDATA,S)}}},S._bufferInitSegment=function(t,e,r){if(this.state===i.State.PARSING){t.video&&delete t.video;var n=t.audio;if(n){n.levelCodec=n.codec,n.id="audio",this.log("Init audio buffer, container:"+n.container+", codecs[parsed]=["+n.codec+"]"),this.hls.trigger(a.Events.BUFFER_CODECS,t);var s=n.initSegment;if(null!==s&&void 0!==s&&s.byteLength){var o={type:"audio",frag:e,part:null,chunkMeta:r,parent:e.type,data:s};this.hls.trigger(a.Events.BUFFER_APPENDING,o)}this.tick()}}},S.loadFragment=function(e,r,a){var s=this.fragmentTracker.getState(e);this.fragCurrent=e,(this.audioSwitch||s===o.FragmentState.NOT_LOADED||s===o.FragmentState.PARTIAL)&&("initSegment"===e.sn?this._loadInitSegment(e):r.live&&!Object(n.isFiniteNumber)(this.initPTS[e.cc])?(this.log("Waiting for video PTS in continuity counter "+e.cc+" of live stream before loading audio fragment "+e.sn+" of level "+this.trackId),this.state=i.State.WAITING_INIT_PTS):(this.startFragRequested=!0,t.prototype.loadFragment.call(this,e,r,a)))},S.completeAudioSwitch=function(){var t=this.hls,e=this.media,r=this.trackId;e&&(this.log("Switching audio track : flushing all audio"),t.trigger(a.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})),this.audioSwitch=!1,t.trigger(a.Events.AUDIO_TRACK_SWITCHED,{id:r})},T}(i.default);e.default=T},"./src/controller/audio-track-controller.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/events.ts"),i=r("./src/errors.ts"),a=r("./src/controller/base-playlist-controller.ts"),s=r("./src/types/loader.ts");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=function(t){var e,r;function a(e){var r;return(r=t.call(this,e,"[audio-track-controller]")||this).tracks=[],r.groupId=null,r.tracksInGroup=[],r.trackId=-1,r.selectDefaultTrack=!0,r.registerListeners(),r}r=t,(e=a).prototype=Object.create(r.prototype),e.prototype.constructor=e,u(e,r);var l,c,d,f=a.prototype;return f.registerListeners=function(){var t=this.hls;t.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(n.Events.ERROR,this.onError,this)},f.unregisterListeners=function(){var t=this.hls;t.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(n.Events.ERROR,this.onError,this)},f.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,t.prototype.destroy.call(this)},f.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},f.onManifestParsed=function(t,e){this.tracks=e.audioTracks||[]},f.onAudioTrackLoaded=function(t,e){var r=e.id,n=e.details,i=this.tracksInGroup[r];if(i){var a=i.details;i.details=e.details,this.log("audioTrack "+r+" loaded ["+n.startSN+"-"+n.endSN+"]"),r===this.trackId&&(this.retryCount=0,this.playlistLoaded(r,e,a))}else this.warn("Invalid audio track id "+r)},f.onLevelLoading=function(t,e){this.switchLevel(e.level)},f.onLevelSwitching=function(t,e){this.switchLevel(e.level)},f.switchLevel=function(t){var e=this.hls.levels[t];if(null!==e&&void 0!==e&&e.audioGroupIds){var r=e.audioGroupIds[e.urlId];if(this.groupId!==r){this.groupId=r;var i=this.tracks.filter((function(t){return!r||t.groupId===r}));this.selectDefaultTrack&&!i.some((function(t){return t.default}))&&(this.selectDefaultTrack=!1),this.tracksInGroup=i;var a={audioTracks:i};this.log("Updating audio tracks, "+i.length+' track(s) found in "'+r+'" group-id'),this.hls.trigger(n.Events.AUDIO_TRACKS_UPDATED,a),this.selectInitialTrack()}}},f.onError=function(e,r){t.prototype.onError.call(this,e,r),!r.fatal&&r.context&&r.context.type===s.PlaylistContextType.AUDIO_TRACK&&r.context.id===this.trackId&&r.context.groupId===this.groupId&&this.retryLoadingOrFail(r)},f.setAudioTrack=function(t){var e,r=this.tracksInGroup;if(this.trackId!==t||null===(e=r[t])||void 0===e||!e.details)if(t<0||t>=r.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var i=r[this.trackId],a=r[t];this.log("Now switching to audio-track index "+t),this.trackId=t;var s=a.url,o=a.type,u=a.id;this.hls.trigger(n.Events.AUDIO_TRACK_SWITCHING,{id:u,type:o,url:s});var l=this.switchParams(a.url,null===i||void 0===i?void 0:i.details);this.loadPlaylist(l)}},f.selectInitialTrack=function(){var t,e=this.tracksInGroup;console.assert(e.length,"Initial audio track should be selected when tracks are known");var r=null===(t=e[this.trackId])||void 0===t?void 0:t.name,a=this.findTrackId(r)||this.findTrackId();-1!==a?this.setAudioTrack(a):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},f.findTrackId=function(t){for(var e=this.tracksInGroup,r=0;r<e.length;r++){var n=e[r];if((!this.selectDefaultTrack||n.default)&&(!t||t===n.name))return n.id}return-1},f.loadPlaylist=function(t){var e=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(e)){var r=e.id,i=e.groupId,a=e.url;if(t)try{a=t.addDirectives(a)}catch(s){this.warn("Could not construct new URL with HLS Delivery Directives: "+s)}this.log("loading audio-track playlist for id: "+r),this.clearTimer(),this.hls.trigger(n.Events.AUDIO_TRACK_LOADING,{url:a,id:r,groupId:i,deliveryDirectives:t||null})}},l=a,(c=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}}])&&o(l.prototype,c),d&&o(l,d),a}(a.default);e.default=l},"./src/controller/base-playlist-controller.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return u}));var n=r("./src/polyfills/number.ts"),i=r("./src/types/level.ts"),a=r("./src/controller/level-helper.ts"),s=r("./src/utils/logger.ts"),o=r("./src/errors.ts"),u=function(){function t(t,e){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=s.logger.log.bind(s.logger,e+":"),this.warn=s.logger.warn.bind(s.logger,e+":"),this.hls=t}var e=t.prototype;return e.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},e.onError=function(t,e){e.fatal&&e.type===o.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},e.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},e.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},e.stopLoad=function(){this.canLoad=!1,this.clearTimer()},e.switchParams=function(t,e){var r=null===e||void 0===e?void 0:e.renditionReports;if(r)for(var a=0;a<r.length;a++){var s=r[a],o=""+s.URI;if(o===t.substr(-o.length)){var u=parseInt(s["LAST-MSN"]),l=parseInt(s["LAST-PART"]);if(e&&this.hls.config.lowLatencyMode){var c=Math.min(e.age-e.partTarget,e.targetduration);void 0!==l&&c>e.partTarget&&(l+=1)}if(Object(n.isFiniteNumber)(u))return new i.HlsUrlParameters(u,Object(n.isFiniteNumber)(l)?l:void 0,i.HlsSkip.No)}}},e.loadPlaylist=function(t){},e.shouldLoadTrack=function(t){return this.canLoad&&t&&!!t.url&&(!t.details||t.details.live)},e.playlistLoaded=function(t,e,r){var n=this,i=e.details,s=e.stats,o=s.loading.end?Math.max(0,self.performance.now()-s.loading.end):0;if(i.advancedDateTime=Date.now()-o,i.live||null!==r&&void 0!==r&&r.live){if(i.reloaded(r),r&&this.log("live playlist "+t+" "+(i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:"MISSED")),r&&i.fragments.length>0&&a.mergeDetails(r,i),!this.canLoad||!i.live)return;var u=void 0,l=void 0;if(i.canBlockReload&&i.endSN&&i.advanced){var c=this.hls.config.lowLatencyMode,d=i.lastPartIndex;c?(u=-1!==d?i.lastPartSn:i.endSN+1,l=-1!==d?d+1:void 0):(u=-1!==d?i.lastPartSn+1:i.endSN+1,l=-1!==d?0:void 0);var f=i.age,h=f+i.ageHeader,p=Math.min(h-i.partTarget,1.5*i.targetduration);if(p>0){if(r&&p>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+r.tuneInGoal+" to: "+p+" with playlist age: "+i.age),p=0;else{var g=Math.floor(p/i.targetduration);u+=g,void 0!==l&&(l+=Math.round(p%i.targetduration/i.partTarget)),this.log("CDN Tune-in age: "+i.ageHeader+"s last advanced "+f.toFixed(2)+"s goal: "+p+" skip sn "+g+" to part "+l)}i.tuneInGoal=p}var m=this.getDeliveryDirectives(i,e.deliveryDirectives,u,l);return void this.loadPlaylist(m)}var v=Object(a.computeReloadInterval)(i,s);this.log("reload live playlist "+t+" in "+Math.round(v)+" ms");var y=this.getDeliveryDirectives(i,e.deliveryDirectives,u,l);this.timer=self.setTimeout((function(){return n.loadPlaylist(y)}),v)}else this.clearTimer()},e.getDeliveryDirectives=function(t,e,r,n){var a=Object(i.getSkipValue)(t,r);return null!==e&&void 0!==e&&e.skip&&t.deltaUpdateFailed&&(r=e.msn,n=e.part,a=i.HlsSkip.No),new i.HlsUrlParameters(r,n,a)},e.retryLoadingOrFail=function(t){var e,r=this,n=this.hls.config,i=this.retryCount<n.levelLoadingMaxRetry;if(i)if(this.retryCount++,t.details.indexOf("LoadTimeOut")>-1&&null!==(e=t.context)&&void 0!==e&&e.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+t.details+'"'),this.loadPlaylist();else{var a=Math.min(Math.pow(2,this.retryCount)*n.levelLoadingRetryDelay,n.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout((function(){return r.loadPlaylist()}),a),this.warn("retry playlist loading #"+this.retryCount+" in "+a+' ms after "'+t.details+'"')}else this.warn('cannot recover from error "'+t.details+'"'),this.clearTimer(),t.fatal=!0;return i},t}()},"./src/controller/base-stream-controller.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"State",(function(){return T})),r.d(e,"default",(function(){return S}));var n=r("./src/polyfills/number.ts"),i=r("./src/task-loop.ts"),a=r("./src/controller/fragment-tracker.ts"),s=r("./src/utils/buffer-helper.ts"),o=r("./src/utils/logger.ts"),u=r("./src/events.ts"),l=r("./src/errors.ts"),c=r("./src/controller/level-helper.ts"),d=r("./src/types/transmuxer.ts"),f=r("./src/utils/mp4-tools.ts"),h=r("./src/utils/discontinuities.ts"),p=r("./src/controller/fragment-finders.ts"),g=r("./src/loader/fragment-loader.ts"),m=r("./src/crypt/decrypter.ts"),v=r("./src/utils/time-ranges.ts"),y=r("./src/types/loader.ts");function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var T={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},S=function(t){var e,r;function i(e,r,n){var i;return(i=t.call(this)||this).hls=void 0,i.fragPrevious=null,i.fragCurrent=null,i.fragmentTracker=void 0,i.transmuxer=null,i._state=T.STOPPED,i.media=void 0,i.mediaBuffer=void 0,i.config=void 0,i.bitrateTest=!1,i.lastCurrentTime=0,i.nextLoadPosition=0,i.startPosition=0,i.loadedmetadata=!1,i.fragLoadError=0,i.retryDate=0,i.levels=null,i.fragmentLoader=void 0,i.levelLastLoaded=null,i.startFragRequested=!1,i.decrypter=void 0,i.initPTS=[],i.onvseeking=null,i.onvended=null,i.logPrefix="",i.log=void 0,i.warn=void 0,i.logPrefix=n,i.log=o.logger.log.bind(o.logger,n+":"),i.warn=o.logger.warn.bind(o.logger,n+":"),i.hls=e,i.fragmentLoader=new g.default(e.config),i.fragmentTracker=r,i.config=e.config,i.decrypter=new m.default(e,e.config),e.on(u.Events.KEY_LOADED,i.onKeyLoaded,function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i)),i}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,E(e,r);var S,w,_,k=i.prototype;return k.doTick=function(){this.onTickEnd()},k.onTickEnd=function(){},k.startLoad=function(t){},k.stopLoad=function(){this.fragmentLoader.abort();var t=this.fragCurrent;t&&this.fragmentTracker.removeFragment(t),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=T.STOPPED},k._streamEnded=function(t,e){var r=this.fragCurrent,n=this.fragmentTracker;if(!e.live&&r&&r.sn===e.endSN&&!t.nextStart){var i=n.getState(r);return i===a.FragmentState.PARTIAL||i===a.FragmentState.OK}return!1},k.onMediaAttached=function(t,e){var r=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),r.addEventListener("seeking",this.onvseeking),r.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.state===T.STOPPED&&this.startLoad(n.startPosition)},k.onMediaDetaching=function(){var t=this.media;null!==t&&void 0!==t&&t.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},k.onMediaSeeking=function(){var t=this.config,e=this.fragCurrent,r=this.media,i=this.mediaBuffer,a=this.state,o=r?r.currentTime:null,u=s.BufferHelper.bufferInfo(i||r,o,t.maxBufferHole);if(this.log("media seeking to "+(Object(n.isFiniteNumber)(o)?o.toFixed(3):o)+", state: "+a),a===T.ENDED)u.len||(this.fragPrevious=null,this.fragCurrent=null),this.state=T.IDLE;else if(e&&!u.len){var l=t.maxFragLookUpTolerance,c=e.start-l,d=e.start+e.duration+l;(o<c||o>d)&&(e.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),e.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=T.IDLE)}r&&(this.lastCurrentTime=o),this.loadedmetadata||u.len||(this.nextLoadPosition=this.startPosition=o),this.tick()},k.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},k.onKeyLoaded=function(t,e){if(this.state===T.KEY_LOADING&&this.levels){this.state=T.IDLE;var r=this.levels[e.frag.level].details;r&&this.loadFragment(e.frag,r,e.frag.start)}},k.onHandlerDestroying=function(){this.stopLoad(),t.prototype.onHandlerDestroying.call(this)},k.onHandlerDestroyed=function(){this.state=T.STOPPED,this.hls.off(u.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,t.prototype.onHandlerDestroyed.call(this)},k.loadFragment=function(t,e,r){this._loadFragForPlayback(t,e,r)},k._loadFragForPlayback=function(t,e,r){var n=this;this._doFragLoad(t,e,r,(function(e){if(n.fragContextChanged(t))return n.warn("Fragment "+t.sn+(e.part?" p: "+e.part.index:"")+" of level "+t.level+" was dropped during download."),void n.fragmentTracker.removeFragment(t);t.stats.chunkCount++,n._handleFragmentLoadProgress(e)})).then((function(e){if(e){n.fragLoadError=0;var r=n.state;if(!n.fragContextChanged(t))return"payload"in e&&(n.log("Loaded fragment "+t.sn+" of level "+t.level),n.hls.trigger(u.Events.FRAG_LOADED,e),n.state===T.BACKTRACKING)?(n.fragmentTracker.backtrack(t,e),void n.resetFragmentLoading(t)):void n._handleFragmentLoadComplete(e);(r===T.FRAG_LOADING||r===T.BACKTRACKING||!n.fragCurrent&&r===T.PARSING)&&(n.fragmentTracker.removeFragment(t),n.state=T.IDLE)}})).catch((function(e){n.warn(e),n.resetFragmentLoading(t)}))},k.flushMainBuffer=function(t,e,r){void 0===r&&(r=null);var n={startOffset:t,endOffset:e,type:r};this.fragLoadError=0,this.hls.trigger(u.Events.BUFFER_FLUSHING,n)},k._loadInitSegment=function(t){var e=this;this._doFragLoad(t).then((function(r){if(!r||e.fragContextChanged(t)||!e.levels)throw new Error("init load aborted");return r})).then((function(r){var n=e.hls,i=r.payload,a=t.decryptdata;if(i&&i.byteLength>0&&a&&a.key&&a.iv&&"AES-128"===a.method){var s=self.performance.now();return e.decrypter.webCryptoDecrypt(new Uint8Array(i),a.key.buffer,a.iv.buffer).then((function(e){var i=self.performance.now();return n.trigger(u.Events.FRAG_DECRYPTED,{frag:t,payload:e,stats:{tstart:s,tdecrypt:i}}),r.payload=e,r}))}return r})).then((function(r){var n=e.fragCurrent,i=e.hls,a=e.levels;if(!a)throw new Error("init load aborted, missing levels");var s=a[t.level].details;console.assert(s,"Level details are defined when init segment is loaded");var o=s.initSegment;console.assert(o,"Fragment initSegment is defined when init segment is loaded");var l=t.stats;e.state=T.IDLE,e.fragLoadError=0,o.data=new Uint8Array(r.payload),l.parsing.start=l.buffering.start=self.performance.now(),l.parsing.end=l.buffering.end=self.performance.now(),r.frag===n&&i.trigger(u.Events.FRAG_BUFFERED,{stats:l,frag:n,part:null,id:t.type}),e.tick()})).catch((function(r){e.warn(r),e.resetFragmentLoading(t)}))},k.fragContextChanged=function(t){var e=this.fragCurrent;return!t||!e||t.level!==e.level||t.sn!==e.sn||t.urlId!==e.urlId},k.fragBufferedComplete=function(t,e){var r=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+t.type+" sn: "+t.sn+(e?" part: "+e.index:"")+" of "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+t.level+" "+v.default.toString(s.BufferHelper.getBuffered(r))),this.state=T.IDLE,this.tick()},k._handleFragmentLoadComplete=function(t){var e=this.transmuxer;if(e){var r=t.frag,n=t.part,i=t.partsLoaded,a=!i||0===i.length||i.some((function(t){return!t})),s=new d.ChunkMetadata(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!a);e.flush(s)}},k._handleFragmentLoadProgress=function(t){},k._doFragLoad=function(t,e,r,i){var a=this;if(void 0===r&&(r=null),!this.levels)throw new Error("frag load aborted, missing levels");if(r=Math.max(t.start,r||0),this.config.lowLatencyMode&&e){var s=e.partList;if(s&&i){r>t.end&&e.fragmentHint&&(t=e.fragmentHint);var o=this.getNextPart(s,t,r);if(o>-1){var l=s[o];return this.log("Loading part sn: "+t.sn+" p: "+l.index+" cc: "+t.cc+" of playlist ["+e.startSN+"-"+e.endSN+"] parts [0-"+o+"-"+(s.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+t.level+", target: "+parseFloat(r.toFixed(3))),this.nextLoadPosition=l.start+l.duration,this.state=T.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:t,part:s[o],targetBufferTime:r}),this.doFragPartsLoad(t,s,o,i).catch((function(t){return a.handleFragLoadError(t)}))}if(!t.url||this.loadedEndOfParts(s,r))return Promise.resolve(null)}}return this.log("Loading fragment "+t.sn+" cc: "+t.cc+" "+(e?"of ["+e.startSN+"-"+e.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+t.level+", target: "+parseFloat(r.toFixed(3))),Object(n.isFiniteNumber)(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=T.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:t,targetBufferTime:r}),this.fragmentLoader.load(t,i).catch((function(t){return a.handleFragLoadError(t)}))},k.doFragPartsLoad=function(t,e,r,n){var i=this;return new Promise((function(a,s){var o=[];!function r(l){var c=e[l];i.fragmentLoader.loadPart(t,c,n).then((function(n){o[c.index]=n;var s=n.part;i.hls.trigger(u.Events.FRAG_LOADED,n);var d=e[l+1];if(!d||d.fragment!==t)return a({frag:t,part:s,partsLoaded:o});r(l+1)})).catch(s)}(r)}))},k.handleFragLoadError=function(t){var e=t.data;return e&&e.details===l.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(e.frag,e.part):this.hls.trigger(u.Events.ERROR,e),null},k._handleTransmuxerFlush=function(t){var e=this.getCurrentContext(t);if(e&&this.state===T.PARSING){var r=e.frag,n=e.part,i=e.level,a=self.performance.now();r.stats.parsing.end=a,n&&(n.stats.parsing.end=a),this.updateLevelTiming(r,n,i,t.partial)}else this.fragCurrent||(this.state=T.IDLE)},k.getCurrentContext=function(t){var e=this.levels,r=t.level,n=t.sn,i=t.part;if(!e||!e[r])return this.warn("Levels object was unset while buffering fragment "+n+" of level "+r+". The current chunk will not be buffered."),null;var a=e[r],s=i>-1?c.getPartWith(a,n,i):null,o=s?s.fragment:c.getFragmentWithSN(a,n);return o?{frag:o,part:s,level:a}:null},k.bufferFragmentData=function(t,e,r,n){if(t&&this.state===T.PARSING){var i=t.data1,a=t.data2,s=i;if(i&&a&&(s=Object(f.appendUint8Array)(i,a)),s&&s.length){var o={type:t.type,frag:e,part:r,chunkMeta:n,parent:e.type,data:s};this.hls.trigger(u.Events.BUFFER_APPENDING,o),t.dropped&&t.independent&&!r&&this.flushBufferGap(e)}}},k.flushBufferGap=function(t){var e=this.media;if(e)if(s.BufferHelper.isBuffered(e,e.currentTime)){var r=e.currentTime,n=s.BufferHelper.bufferInfo(e,r,0),i=t.duration,a=Math.min(2*this.config.maxFragLookUpTolerance,.25*i),o=Math.max(Math.min(t.start-a,n.end-a),r+a);t.start-o>a&&this.flushMainBuffer(o,t.start)}else this.flushMainBuffer(0,t.start)},k.reduceMaxBufferLength=function(t){var e=this.config,r=t||e.maxBufferLength;return e.maxMaxBufferLength>=r&&(e.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+e.maxMaxBufferLength+"s"),!0)},k.getNextFragment=function(t,e){var r=e.fragments,n=r.length;if(!n)return null;var i,a=this.config,s=r[0].start;if(!e.initSegment||e.initSegment.data||this.bitrateTest)if(e.live){var o=a.initialLiveManifestSize;if(n<o)return this.warn("Not enough fragments to start playback (have: "+n+", need: "+o+")"),null;e.PTSKnown||this.startFragRequested||(i=this.getInitialLiveFragment(e,r))}else t<=s&&(i=r[0]);else i=e.initSegment;if(!i){var u=a.lowLatencyMode?e.partEnd:e.fragmentEnd;i=this.getFragmentAtPosition(t,u,e)}return i},k.getNextPart=function(t,e,r){for(var n=-1,i=!1,a=!0,s=0,o=t.length;s<o;s++){var u=t[s];if(a=a&&!u.independent,n>-1&&r<u.start)break;var l=u.loaded;!l&&(i||u.independent||a)&&u.fragment===e&&(n=s),i=l}return n},k.loadedEndOfParts=function(t,e){var r=t[t.length-1];return r&&e>r.start&&r.loaded},k.getInitialLiveFragment=function(t,e){var r=this.fragPrevious,n=null;if(r){if(t.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),n=Object(p.findFragmentByPDT)(e,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){var i=r.sn+1;if(i>=t.startSN&&i<=t.endSN){var a=e[i-t.startSN];r.cc===a.cc&&(n=a,this.log("Live playlist, switching playlist, load frag with next SN: "+n.sn))}n||(n=Object(p.findFragWithCC)(e,r.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+n.sn)}}else{var s=this.hls.liveSyncPosition;null!==s&&(n=this.getFragmentAtPosition(s,this.bitrateTest?t.fragmentEnd:t.edge,t))}return n},k.getFragmentAtPosition=function(t,e,r){var n,i=this.config,s=this.fragPrevious,o=r.fragments,u=r.endSN,l=r.fragmentHint,c=i.maxFragLookUpTolerance,d=!!(i.lowLatencyMode&&r.partList&&l);if(d&&l&&!this.bitrateTest&&(o=o.concat(l),u=l.sn),t<e){var f=t>e-c?0:c;n=Object(p.findFragmentByPTS)(s,o,t,f)}else n=o[o.length-1];if(n){var h=n.sn-r.startSN,g=s&&n.level===s.level,m=o[h+1];if(this.fragmentTracker.getState(n)===a.FragmentState.BACKTRACKED){n=null;for(var v=h;o[v]&&this.fragmentTracker.getState(o[v])===a.FragmentState.BACKTRACKED;)n=s?o[v--]:o[--v];n||(n=m)}else s&&n.sn===s.sn&&!d&&g&&(n.sn<u&&this.fragmentTracker.getState(m)!==a.FragmentState.OK?(this.log("SN "+n.sn+" just loaded, load next one: "+m.sn),n=m):n=null)}return n},k.synchronizeToLiveEdge=function(t){var e=this.config,r=this.media;if(r){var n=this.hls.liveSyncPosition,i=r.currentTime,a=t.fragments[0].start,s=t.edge;if(null!==n&&r.duration>n&&(i<n||i<a-e.maxFragLookUpTolerance||i>s)){var o=void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:e.liveMaxLatencyDurationCount*t.targetduration;(r.readyState<4||i<s-o)&&(this.loadedmetadata||(this.nextLoadPosition=n),r.readyState&&(this.warn("Playback: "+i.toFixed(3)+" is located too far from the end of live sliding playlist: "+s+", reset currentTime to : "+n.toFixed(3)),r.currentTime=n))}}},k.alignPlaylists=function(t,e){var r=this.levels,i=this.levelLastLoaded,a=null!==i?r[i]:null,s=0;return e&&t.fragments.length>0?(s=t.fragments[0].start,t.alignedSliding&&Object(n.isFiniteNumber)(s)?this.log("Live playlist sliding:"+s.toFixed(3)):s||(this.warn("["+this.constructor.name+"] Live playlist - outdated PTS, unknown sliding"),Object(h.alignStream)(this.fragPrevious,a,t))):(this.log("Live playlist - first load, unknown sliding"),Object(h.alignStream)(this.fragPrevious,a,t)),s},k.waitForCdnTuneIn=function(t){return t.live&&t.canBlockReload&&t.tuneInGoal>Math.max(t.partHoldBack,3*t.partTarget)},k.setStartPosition=function(t,e){if(-1===this.startPosition||-1===this.lastCurrentTime){var r=t.startTimeOffset;Object(n.isFiniteNumber)(r)?(r<0&&(this.log("Negative start time offset "+r+", count from end of last fragment"),r=e+t.totalduration+r),this.log("Start time offset found in playlist, adjust startPosition to "+r),this.startPosition=r):t.live?(this.startPosition=this.hls.liveSyncPosition||e,this.log("Configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition},k.getLoadPosition=function(){var t=this.media,e=0;return this.loadedmetadata?e=t.currentTime:this.nextLoadPosition&&(e=this.nextLoadPosition),e},k.handleFragLoadAborted=function(t,e){this.transmuxer&&"initSegment"!==t.sn&&(this.warn("Fragment "+t.sn+(e?" part"+e.index:"")+" of level "+t.level+" was aborted"),this.resetFragmentLoading(t))},k.resetFragmentLoading=function(t){this.fragCurrent&&this.fragContextChanged(t)||(this.state=T.IDLE)},k.onFragmentOrKeyLoadError=function(t,e){if(!e.fatal){var r=e.frag;if(r&&r.type===t){var n=this.fragCurrent;console.assert(n&&r.sn===n.sn&&r.level===n.level&&r.urlId===n.urlId,"Frag load error must match current frag to retry");var i=this.config;if(this.fragLoadError+1<=i.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(r.level))return;var a=Math.min(Math.pow(2,this.fragLoadError)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);this.warn("Fragment "+r.sn+" of "+t+" "+r.level+" failed to load, retrying in "+a+"ms"),this.retryDate=self.performance.now()+a,this.fragLoadError++,this.state=T.FRAG_LOADING_WAITING_RETRY}else e.levelRetry?(t===y.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=T.IDLE):(o.logger.error(e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.stopLoad(),this.state=T.ERROR)}}},k.afterBufferFlushed=function(t,e){if(t){var r=s.BufferHelper.getBuffered(t);this.fragmentTracker.detectEvictedFragments(e,r)}},k.resetLiveStartWhenNotLoaded=function(t){if(!this.loadedmetadata){this.startFragRequested=!1;var e=this.levels?this.levels[t].details:null;if(null!==e&&void 0!==e&&e.live)return this.startPosition=-1,this.setStartPosition(e,0),this.state=T.IDLE,!0;this.nextLoadPosition=this.startPosition}return!1},k.updateLevelTiming=function(t,e,r,n){var i=this,a=r.details;console.assert(!!a,"level.details must be defined"),Object.keys(t.elementaryStreams).reduce((function(e,s){var o=t.elementaryStreams[s];if(o){var l=o.endPTS-o.startPTS;if(l<=0)return i.warn("Could not parse fragment "+t.sn+" "+s+" duration reliably ("+l+") resetting transmuxer to fallback to playlist timing"),i.transmuxer&&(i.transmuxer.destroy(),i.transmuxer=null),e||!1;var d=n?0:c.updateFragPTSDTS(a,t,o.startPTS,o.endPTS,o.startDTS,o.endDTS);return i.hls.trigger(u.Events.LEVEL_PTS_UPDATED,{details:a,level:r,drift:d,type:s,frag:t,start:o.startPTS,end:o.endPTS}),!0}return e}),!1)?(this.state=T.PARSED,this.hls.trigger(u.Events.FRAG_PARSED,{frag:t,part:e})):(this.fragCurrent=null,this.fragPrevious=null,this.state=T.IDLE)},S=i,(w=[{key:"state",get:function(){return this._state},set:function(t){var e=this._state;e!==t&&(this._state=t,this.log(e+"->"+t))}}])&&b(S.prototype,w),_&&b(S,_),i}(i.default)},"./src/controller/buffer-controller.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return h}));var n=r("./src/polyfills/number.ts"),i=r("./src/events.ts"),a=r("./src/utils/logger.ts"),s=r("./src/errors.ts"),o=r("./src/utils/buffer-helper.ts"),u=r("./src/utils/mediasource-helper.ts"),l=r("./src/loader/fragment.ts"),c=r("./src/controller/buffer-operation-queue.ts"),d=Object(u.getMediaSource)(),f=/([ha]vc.)(?:\.[^.,]+)+/,h=function(){function t(t){var e=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var t=e.hls,r=e.media,n=e.mediaSource;a.logger.log("[buffer-controller]: Media source opened"),r&&(e.updateMediaElementDuration(),t.trigger(i.Events.MEDIA_ATTACHED,{media:r})),n&&n.removeEventListener("sourceopen",e._onMediaSourceOpen),e.checkPendingTracks()},this._onMediaSourceClose=function(){a.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){a.logger.log("[buffer-controller]: Media source ended")},this.hls=t,this._initSourceBuffer(),this.registerListeners()}var e=t.prototype;return e.destroy=function(){this.unregisterListeners(),this.details=null},e.registerListeners=function(){var t=this.hls;t.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(i.Events.BUFFER_RESET,this.onBufferReset,this),t.on(i.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.on(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(i.Events.BUFFER_EOS,this.onBufferEos,this),t.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(i.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(i.Events.FRAG_PARSED,this.onFragParsed,this),t.on(i.Events.FRAG_CHANGED,this.onFragChanged,this)},e.unregisterListeners=function(){var t=this.hls;t.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(i.Events.BUFFER_RESET,this.onBufferReset,this),t.off(i.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.off(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(i.Events.BUFFER_EOS,this.onBufferEos,this),t.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(i.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(i.Events.FRAG_PARSED,this.onFragParsed,this),t.off(i.Events.FRAG_CHANGED,this.onFragChanged,this)},e._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new c.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},e.onManifestParsed=function(t,e){var r=2;(e.audio&&!e.video||!e.altAudio)&&(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,this.details=null,a.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},e.onMediaAttaching=function(t,e){var r=this.media=e.media;if(r&&d){var n=this.mediaSource=new d;n.addEventListener("sourceopen",this._onMediaSourceOpen),n.addEventListener("sourceended",this._onMediaSourceEnded),n.addEventListener("sourceclose",this._onMediaSourceClose),r.src=self.URL.createObjectURL(n),this._objectUrl=r.src}},e.onMediaDetaching=function(){var t=this.media,e=this.mediaSource,r=this._objectUrl;if(e){if(a.logger.log("[buffer-controller]: media source detaching"),"open"===e.readyState)try{e.endOfStream()}catch(n){a.logger.warn("[buffer-controller]: onMediaDetaching: "+n.message+" while calling endOfStream")}this.onBufferReset(),e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(r&&self.URL.revokeObjectURL(r),t.src===r?(t.removeAttribute("src"),t.load()):a.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(i.Events.MEDIA_DETACHED,void 0)},e.onBufferReset=function(){var t=this,e=this.sourceBuffer;this.getSourceBufferTypes().forEach((function(r){var n=e[r];try{n&&(t.removeBufferListeners(r),t.mediaSource&&t.mediaSource.removeSourceBuffer(n),e[r]=void 0)}catch(i){a.logger.warn("[buffer-controller]: Failed to reset the "+r+" buffer",i)}})),this._initSourceBuffer()},e.onBufferCodecs=function(t,e){var r=this,n=Object.keys(this.sourceBuffer).length;Object.keys(e).forEach((function(t){if(n){var i=r.tracks[t];if(i&&"function"===typeof i.buffer.changeType){var a=e[t],s=a.codec,o=a.levelCodec,u=a.container;if((i.levelCodec||i.codec).replace(f,"$1")!==(o||s).replace(f,"$1")){var l=u+";codecs="+(o||s);r.appendChangeType(t,l)}}}else r.pendingTracks[t]=e[t]})),n||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},e.appendChangeType=function(t,e){var r=this,n=this.operationQueue,i={execute:function(){var i=r.sourceBuffer[t];i&&(a.logger.log("[buffer-controller]: changing "+t+" sourceBuffer type to "+e),i.changeType(e)),n.shiftAndExecuteNext(t)},onStart:function(){},onComplete:function(){},onError:function(e){a.logger.warn("[buffer-controller]: Failed to change "+t+" SourceBuffer type",e)}};n.append(i,t)},e.onBufferAppending=function(t,e){var r=this,n=this.hls,u=this.operationQueue,l=this.tracks,c=e.data,d=e.type,f=e.frag,h=e.part,p=e.chunkMeta,g=p.buffering[d],m=self.performance.now();g.start=m;var v=f.stats.buffering,y=h?h.stats.buffering:null;0===v.start&&(v.start=m),y&&0===y.start&&(y.start=m);var b=l.audio,E="audio"===d&&1===p.id&&"audio/mpeg"===(null===b||void 0===b?void 0:b.container),T={execute:function(){if(g.executeStart=self.performance.now(),E){var t=r.sourceBuffer[d];if(t){var e=f.start-t.timestampOffset;Math.abs(e)>=.1&&(a.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+f.start+" (delta: "+e+") sn: "+f.sn+")"),t.timestampOffset=f.start)}}r.appendExecutor(c,d)},onStart:function(){},onComplete:function(){var t=self.performance.now();g.executeEnd=g.end=t,0===v.first&&(v.first=t),y&&0===y.first&&(y.first=t);var e=r.sourceBuffer,n={};for(var a in e)n[a]=o.BufferHelper.getBuffered(e[a]);r.appendError=0,r.hls.trigger(i.Events.BUFFER_APPENDED,{type:d,frag:f,part:h,chunkMeta:p,parent:f.type,timeRanges:n})},onError:function(t){a.logger.error("[buffer-controller]: Error encountered while trying to append to the "+d+" SourceBuffer",t);var e={type:s.ErrorTypes.MEDIA_ERROR,parent:f.type,details:s.ErrorDetails.BUFFER_APPEND_ERROR,err:t,fatal:!1};t.code===DOMException.QUOTA_EXCEEDED_ERR?e.details=s.ErrorDetails.BUFFER_FULL_ERROR:(r.appendError++,e.details=s.ErrorDetails.BUFFER_APPEND_ERROR,r.appendError>n.config.appendErrorMaxRetry&&(a.logger.error("[buffer-controller]: Failed "+n.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),e.fatal=!0)),n.trigger(i.Events.ERROR,e)}};u.append(T,d)},e.onBufferFlushing=function(t,e){var r=this,n=this.operationQueue,s=function(t){return{execute:r.removeExecutor.bind(r,t,e.startOffset,e.endOffset),onStart:function(){},onComplete:function(){r.hls.trigger(i.Events.BUFFER_FLUSHED,{type:t})},onError:function(e){a.logger.warn("[buffer-controller]: Failed to remove from "+t+" SourceBuffer",e)}}};e.type?n.append(s(e.type),e.type):(n.append(s("audio"),"audio"),n.append(s("video"),"video"))},e.onFragParsed=function(t,e){var r=this,n=e.frag,s=e.part,o=[],u=s?s.elementaryStreams:n.elementaryStreams;u[l.ElementaryStreamTypes.AUDIOVIDEO]?o.push("audiovideo"):(u[l.ElementaryStreamTypes.AUDIO]&&o.push("audio"),u[l.ElementaryStreamTypes.VIDEO]&&o.push("video")),0===o.length&&a.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+n.type+" level: "+n.level+" sn: "+n.sn),this.blockBuffers((function(){var t=self.performance.now();n.stats.buffering.end=t,s&&(s.stats.buffering.end=t);var e=s?s.stats:n.stats;r.hls.trigger(i.Events.FRAG_BUFFERED,{frag:n,part:s,stats:e,id:n.type})}),o)},e.onFragChanged=function(t,e){this.flushBackBuffer()},e.onBufferEos=function(t,e){var r=this;this.getSourceBufferTypes().reduce((function(t,n){var i=r.sourceBuffer[n];return e.type&&e.type!==n||i&&!i.ended&&(i.ended=!0,a.logger.log("[buffer-controller]: "+n+" sourceBuffer now EOS")),t&&!(i&&!i.ended)}),!0)&&this.blockBuffers((function(){var t=r.mediaSource;t&&"open"===t.readyState&&t.endOfStream()}))},e.onLevelUpdated=function(t,e){var r=e.details;r.fragments.length&&(this.details=r,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},e.flushBackBuffer=function(){var t=this.hls,e=this.details,r=this.media,a=this.sourceBuffer;if(r&&null!==e){var s=this.getSourceBufferTypes();if(s.length){var u=e.live&&null!==t.config.liveBackBufferLength?t.config.liveBackBufferLength:t.config.backBufferLength;if(Object(n.isFiniteNumber)(u)&&!(u<0)){var l=r.currentTime,c=e.levelTargetDuration,d=Math.max(u,c),f=Math.floor(l/c)*c-d;s.forEach((function(r){var n=a[r];if(n){var s=o.BufferHelper.getBuffered(n);s.length>0&&f>s.start(0)&&(t.trigger(i.Events.BACK_BUFFER_REACHED,{bufferEnd:f}),e.live&&t.trigger(i.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:f}),t.trigger(i.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:f,type:r}))}}))}}}},e.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var t=this.details,e=this.hls,r=this.media,i=this.mediaSource,s=t.fragments[0].start+t.totalduration,o=r.duration,u=Object(n.isFiniteNumber)(i.duration)?i.duration:0;t.live&&e.config.liveDurationInfinity?(a.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),i.duration=1/0,this.updateSeekableRange(t)):(s>u&&s>o||!Object(n.isFiniteNumber)(o))&&(a.logger.log("[buffer-controller]: Updating Media Source duration to "+s.toFixed(3)),i.duration=s)}},e.updateSeekableRange=function(t){var e=this.mediaSource,r=t.fragments;if(r.length&&t.live&&null!==e&&void 0!==e&&e.setLiveSeekableRange){var n=Math.max(0,r[0].start),i=Math.max(n,n+t.totalduration);e.setLiveSeekableRange(n,i)}},e.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,e=this.operationQueue,r=this.pendingTracks,n=Object.keys(r).length;if(n&&!t||2===n){this.createSourceBuffers(r),this.pendingTracks={};var a=Object.keys(this.sourceBuffer);if(0===a.length)return void this.hls.trigger(i.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});a.forEach((function(t){e.executeNext(t)}))}},e.createSourceBuffers=function(t){var e=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");var n=0;for(var o in t)if(!e[o]){var u=t[o];if(!u)throw Error("source buffer exists for track "+o+", however track does not");var l=u.levelCodec||u.codec,c=u.container+";codecs="+l;a.logger.log("[buffer-controller]: creating sourceBuffer("+c+")");try{var d=e[o]=r.addSourceBuffer(c),f=o;this.addBufferListener(f,"updatestart",this._onSBUpdateStart),this.addBufferListener(f,"updateend",this._onSBUpdateEnd),this.addBufferListener(f,"error",this._onSBUpdateError),this.tracks[o]={buffer:d,codec:l,container:u.container,levelCodec:u.levelCodec,id:u.id},n++}catch(h){a.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+h.message),this.hls.trigger(i.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,mimeType:c})}}n&&this.hls.trigger(i.Events.BUFFER_CREATED,{tracks:this.tracks})},e._onSBUpdateStart=function(t){this.operationQueue.current(t).onStart()},e._onSBUpdateEnd=function(t){var e=this.operationQueue;e.current(t).onComplete(),e.shiftAndExecuteNext(t)},e._onSBUpdateError=function(t,e){a.logger.error("[buffer-controller]: "+t+" SourceBuffer error",e),this.hls.trigger(i.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var r=this.operationQueue.current(t);r&&r.onError(e)},e.removeExecutor=function(t,e,r){var i=this.media,s=this.mediaSource,o=this.operationQueue,u=this.sourceBuffer[t];if(!i||!s||!u)return a.logger.warn("[buffer-controller]: Attempting to remove from the "+t+" SourceBuffer, but it does not exist"),void o.shiftAndExecuteNext(t);var l=Object(n.isFiniteNumber)(i.duration)?i.duration:1/0,c=Object(n.isFiniteNumber)(s.duration)?s.duration:1/0,d=Math.max(0,e),f=Math.min(r,l,c);f>d?(a.logger.log("[buffer-controller]: Removing ["+d+","+f+"] from the "+t+" SourceBuffer"),console.assert(!u.updating,t+" sourceBuffer must not be updating"),u.remove(d,f)):o.shiftAndExecuteNext(t)},e.appendExecutor=function(t,e){var r=this.operationQueue,n=this.sourceBuffer[e];if(!n)return a.logger.warn("[buffer-controller]: Attempting to append to the "+e+" SourceBuffer, but it does not exist"),void r.shiftAndExecuteNext(e);n.ended=!1,console.assert(!n.updating,e+" sourceBuffer must not be updating"),n.appendBuffer(t)},e.blockBuffers=function(t,e){var r=this;if(void 0===e&&(e=this.getSourceBufferTypes()),!e.length)return a.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve(t);var n=this.operationQueue,i=e.map((function(t){return n.appendBlocker(t)}));Promise.all(i).then((function(){t(),e.forEach((function(t){var e=r.sourceBuffer[t];e&&e.updating||n.shiftAndExecuteNext(t)}))}))},e.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},e.addBufferListener=function(t,e,r){var n=this.sourceBuffer[t];if(n){var i=r.bind(this,t);this.listeners[t].push({event:e,listener:i}),n.addEventListener(e,i)}},e.removeBufferListeners=function(t){var e=this.sourceBuffer[t];e&&this.listeners[t].forEach((function(t){e.removeEventListener(t.event,t.listener)}))},t}()},"./src/controller/buffer-operation-queue.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return i}));var n=r("./src/utils/logger.ts"),i=function(){function t(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}var e=t.prototype;return e.append=function(t,e){var r=this.queues[e];r.push(t),1===r.length&&this.buffers[e]&&this.executeNext(e)},e.insertAbort=function(t,e){this.queues[e].unshift(t),this.executeNext(e)},e.appendBlocker=function(t){var e,r=new Promise((function(t){e=t})),n={execute:e,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(n,t),r},e.executeNext=function(t){var e=this.buffers,r=this.queues,i=e[t],a=r[t];if(a.length){var s=a[0];try{s.execute()}catch(o){n.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),s.onError(o),i&&i.updating||a.shift()}}},e.shiftAndExecuteNext=function(t){this.queues[t].shift(),this.executeNext(t)},e.current=function(t){return this.queues[t][0]},t}()},"./src/controller/cap-level-controller.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/events.ts");function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(t){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var e,r,a,s=t.prototype;return s.setStreamController=function(t){this.streamController=t},s.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},s.registerListeners=function(){var t=this.hls;t.on(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},s.unregisterListener=function(){var t=this.hls;t.off(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},s.onFpsDropLevelCapping=function(e,r){t.isLevelAllowed(r.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(r.droppedLevel)},s.onMediaAttaching=function(t,e){this.media=e.media instanceof HTMLVideoElement?e.media:null},s.onManifestParsed=function(t,e){var r=this.hls;this.restrictedLevels=[],this.firstLevel=e.firstLevel,r.config.capLevelToPlayerSize&&e.video&&this.startCapping()},s.onBufferCodecs=function(t,e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},s.onMediaDetaching=function(){this.stopCapping()},s.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var t=this.hls.levels;if(t.length){var e=this.hls;e.autoLevelCapping=this.getMaxLevel(t.length-1),e.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}},s.getMaxLevel=function(e){var r=this,n=this.hls.levels;if(!n.length)return-1;var i=n.filter((function(n,i){return t.isLevelAllowed(i,r.restrictedLevels)&&i<=e}));return this.clientRect=null,t.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},s.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},s.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},s.getDimensions=function(){if(this.clientRect)return this.clientRect;var t=this.media,e={width:0,height:0};if(t){var r=t.getBoundingClientRect();e.width=r.width,e.height=r.height,e.width||e.height||(e.width=r.right-r.left||t.width||0,e.height=r.bottom-r.top||t.height||0)}return this.clientRect=e,e},t.isLevelAllowed=function(t,e){return void 0===e&&(e=[]),-1===e.indexOf(t)},t.getMaxLevelByMediaSize=function(t,e,r){if(!t||!t.length)return-1;for(var n,i,a=t.length-1,s=0;s<t.length;s+=1){var o=t[s];if((o.width>=e||o.height>=r)&&(n=o,!(i=t[s+1])||n.width!==i.width||n.height!==i.height)){a=s;break}}return a},e=t,a=[{key:"contentScaleFactor",get:function(){var t=1;try{t=self.devicePixelRatio}catch(e){}return t}}],(r=[{key:"mediaWidth",get:function(){return this.getDimensions().width*t.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*t.contentScaleFactor}}])&&i(e.prototype,r),a&&i(e,a),t}();e.default=a},"./src/controller/eme-controller.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/events.ts"),i=r("./src/errors.ts"),a=r("./src/utils/logger.ts"),s=r("./src/utils/mediakeys-helper.ts");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function t(t){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=t,this._config=t.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var e,r,u,l=t.prototype;return l.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},l._registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},l._unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},l.getLicenseServerUrl=function(t){switch(t){case s.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+t+'"')},l._attemptKeySystemAccess=function(t,e,r){var n=this,i=function(t,e,r,n){switch(t){case s.KeySystems.WIDEVINE:return function(t,e,r){var n={audioCapabilities:[],videoCapabilities:[]};return t.forEach((function(t){n.audioCapabilities.push({contentType:'audio/mp4; codecs="'+t+'"',robustness:r.audioRobustness||""})})),e.forEach((function(t){n.videoCapabilities.push({contentType:'video/mp4; codecs="'+t+'"',robustness:r.videoRobustness||""})})),[n]}(e,r,n);default:throw new Error("Unknown key-system: "+t)}}(t,e,r,this._drmSystemOptions);a.logger.log("Requesting encrypted media key-system access");var o=this.requestMediaKeySystemAccess(t,i);this.mediaKeysPromise=o.then((function(e){return n._onMediaKeySystemAccessObtained(t,e)})),o.catch((function(e){a.logger.error('Failed to obtain key-system "'+t+'" access:',e)}))},l._onMediaKeySystemAccessObtained=function(t,e){var r=this;a.logger.log('Access for key-system "'+t+'" obtained');var n={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(n);var i=Promise.resolve().then((function(){return e.createMediaKeys()})).then((function(e){return n.mediaKeys=e,a.logger.log('Media-keys created for key-system "'+t+'"'),r._onMediaKeysCreated(),e}));return i.catch((function(t){a.logger.error("Failed to create media-keys:",t)})),i},l._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach((function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))}))},l._onNewMediaKeySession=function(t){var e=this;a.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",(function(r){e._onKeySessionMessage(t,r.message)}),!1)},l._onKeySessionMessage=function(t,e){a.logger.log("Got EME message event, creating license request"),this._requestLicense(e,(function(e){a.logger.log("Received license data (length: "+(e?e.byteLength:e)+"), updating key-session"),t.update(e)}))},l.onMediaEncrypted=function(t){var e=this;if(a.logger.log('Media is encrypted using "'+t.initDataType+'" init data type'),!this.mediaKeysPromise)return a.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var r=function(r){e._media&&(e._attemptSetMediaKeys(r),e._generateRequestWithPreferredKeySession(t.initDataType,t.initData))};this.mediaKeysPromise.then(r).catch(r)},l._attemptSetMediaKeys=function(t){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return a.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});a.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},l._generateRequestWithPreferredKeySession=function(t,e){var r=this,s=this._mediaKeysList[0];if(!s)return a.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(s.mediaKeysSessionInitialized)a.logger.warn("Key-Session already initialized but requested again");else{var o=s.mediaKeysSession;if(!o)return a.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!e)return a.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});a.logger.log('Generating key-session request for "'+t+'" init data type'),s.mediaKeysSessionInitialized=!0,o.generateRequest(t,e).then((function(){a.logger.debug("Key-session generation succeeded")})).catch((function(t){a.logger.error("Error generating key-session request:",t),r.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},l._createLicenseXhr=function(t,e,r){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,t,e,r);var i=this._licenseXhrSetup;if(i)try{i.call(this.hls,n,t),i=void 0}catch(s){a.logger.error(s)}try{n.readyState||n.open("POST",t,!0),i&&i.call(this.hls,n,t)}catch(s){throw new Error("issue setting up KeySystem license XHR "+s)}return n},l._onLicenseRequestReadyStageChange=function(t,e,r,s){switch(t.readyState){case 4:if(200===t.status){this._requestLicenseFailureCount=0,a.logger.log("License request succeeded");var o=t.response,u=this._licenseResponseCallback;if(u)try{o=u.call(this.hls,t,e)}catch(c){a.logger.error(c)}s(o)}else{if(a.logger.error("License Request XHR failed ("+e+"). Status: "+t.status+" ("+t.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var l=3-this._requestLicenseFailureCount+1;a.logger.warn("Retrying license request, "+l+" attempts left"),this._requestLicense(r,s)}}},l._generateLicenseRequestChallenge=function(t,e){switch(t.mediaKeySystemDomain){case s.KeySystems.WIDEVINE:return e}throw new Error("unsupported key-system: "+t.mediaKeySystemDomain)},l._requestLicense=function(t,e){a.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return a.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var s=this.getLicenseServerUrl(r.mediaKeySystemDomain),o=this._createLicenseXhr(s,t,e);a.logger.log("Sending license request to URL: "+s);var u=this._generateLicenseRequestChallenge(r,t);o.send(u)}catch(l){a.logger.error("Failure requesting DRM license: "+l),this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.KEY_SYSTEM_ERROR,details:i.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},l.onMediaAttached=function(t,e){if(this._emeEnabled){var r=e.media;this._media=r,r.addEventListener("encrypted",this._onMediaEncrypted)}},l.onMediaDetached=function(){var t=this._media,e=this._mediaKeysList;t&&(t.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(e.map((function(t){if(t.mediaKeysSession)return t.mediaKeysSession.close().catch((function(){}))}))).then((function(){return t.setMediaKeys(null)})).catch((function(){})))},l.onManifestParsed=function(t,e){if(this._emeEnabled){var r=e.levels.map((function(t){return t.audioCodec})).filter((function(t){return!!t})),n=e.levels.map((function(t){return t.videoCodec})).filter((function(t){return!!t}));this._attemptKeySystemAccess(s.KeySystems.WIDEVINE,r,n)}},e=t,(r=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&o(e.prototype,r),u&&o(e,u),t}();e.default=u},"./src/controller/fps-controller.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/events.ts"),i=r("./src/utils/logger.ts"),a=function(){function t(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}var e=t.prototype;return e.setStreamController=function(t){this.streamController=t},e.registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},e.unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching)},e.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},e.onMediaAttaching=function(t,e){var r=this.hls.config;if(r.capLevelOnFPSDrop){var n=e.media instanceof self.HTMLVideoElement?e.media:null;this.media=n,n&&"function"===typeof n.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setTimeout(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}},e.checkFPS=function(t,e,r){var a=performance.now();if(e){if(this.lastTime){var s=a-this.lastTime,o=r-this.lastDroppedFrames,u=e-this.lastDecodedFrames,l=1e3*o/s,c=this.hls;if(c.trigger(n.Events.FPS_DROP,{currentDropped:o,currentDecoded:u,totalDroppedFrames:r}),l>0&&o>c.config.fpsDroppedMonitoringThreshold*u){var d=c.currentLevel;i.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=d)&&(d-=1,c.trigger(n.Events.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:c.currentLevel}),c.autoLevelCapping=d,this.streamController.nextLevelSwitch())}}this.lastTime=a,this.lastDroppedFrames=r,this.lastDecodedFrames=e}},e.checkFPSInterval=function(){var t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},t}();e.default=a},"./src/controller/fragment-finders.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"findFragmentByPDT",(function(){return a})),r.d(e,"findFragmentByPTS",(function(){return s})),r.d(e,"fragmentWithinToleranceTest",(function(){return o})),r.d(e,"pdtWithinToleranceTest",(function(){return u})),r.d(e,"findFragWithCC",(function(){return l}));var n=r("./src/polyfills/number.ts"),i=r("./src/utils/binary-search.ts");function a(t,e,r){if(null===e||!Array.isArray(t)||!t.length||!Object(n.isFiniteNumber)(e))return null;if(e<(t[0].programDateTime||0))return null;if(e>=(t[t.length-1].endProgramDateTime||0))return null;r=r||0;for(var i=0;i<t.length;++i){var a=t[i];if(u(e,r,a))return a}return null}function s(t,e,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var a=null;if(t?a=e[t.sn-e[0].sn+1]:0===r&&0===e[0].start&&(a=e[0]),a&&0===o(r,n,a))return a;var s=i.default.search(e,o.bind(null,r,n));return s||a}function o(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0);var n=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=t?1:r.start-n>t&&r.start?-1:0}function u(t,e,r){var n=1e3*Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>t}function l(t,e){return i.default.search(t,(function(t){return t.cc<e?1:t.cc>e?-1:0}))}},"./src/controller/fragment-tracker.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"FragmentState",(function(){return n})),r.d(e,"FragmentTracker",(function(){return s}));var n,i=r("./src/events.ts"),a=r("./src/types/loader.ts");!function(t){t.NOT_LOADED="NOT_LOADED",t.BACKTRACKED="BACKTRACKED",t.APPENDING="APPENDING",t.PARTIAL="PARTIAL",t.OK="OK"}(n||(n={}));var s=function(){function t(t){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=t,this._registerListeners()}var e=t.prototype;return e._registerListeners=function(){var t=this.hls;t.on(i.Events.BUFFER_APPENDED,this.onBufferAppended,this),t.on(i.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.on(i.Events.FRAG_LOADED,this.onFragLoaded,this)},e._unregisterListeners=function(){var t=this.hls;t.off(i.Events.BUFFER_APPENDED,this.onBufferAppended,this),t.off(i.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.off(i.Events.FRAG_LOADED,this.onFragLoaded,this)},e.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},e.getAppendedFrag=function(t,e){if(e===a.PlaylistLevelType.MAIN){var r=this.activeFragment,n=this.activeParts;if(!r)return null;if(n)for(var i=n.length;i--;){var s=n[i],o=s?s.end:r.appendedPTS;if(s.start<=t&&void 0!==o&&t<=o)return i>9&&(this.activeParts=n.slice(i-9)),s}else if(r.start<=t&&void 0!==r.appendedPTS&&t<=r.appendedPTS)return r}return this.getBufferedFrag(t,e)},e.getBufferedFrag=function(t,e){for(var r=this.fragments,n=Object.keys(r),i=n.length;i--;){var a=r[n[i]];if((null===a||void 0===a?void 0:a.body.type)===e&&a.buffered){var s=a.body;if(s.start<=t&&t<=s.end)return s}}return null},e.detectEvictedFragments=function(t,e){var r=this;Object.keys(this.fragments).forEach((function(n){var i=r.fragments[n];if(i&&i.buffered){var a=i.range[t];a&&a.time.some((function(t){var n=!r.isTimeBuffered(t.startPTS,t.endPTS,e);return n&&r.removeFragment(i.body),n}))}}))},e.detectPartialFragments=function(t){var e=this,r=this.timeRanges,n=t.frag,i=t.part;if(r&&"initSegment"!==n.sn){var a=u(n),s=this.fragments[a];s&&(Object.keys(r).forEach((function(t){var a=n.elementaryStreams[t];if(a){var o=r[t],u=null!==i||!0===a.partial;s.range[t]=e.getBufferedTimes(n,i,u,o)}})),s.backtrack=s.loaded=null,Object.keys(s.range).length?s.buffered=!0:this.removeFragment(s.body))}},e.getBufferedTimes=function(t,e,r,n){for(var i={time:[],partial:r},a=e?e.start:t.start,s=e?e.end:t.end,o=t.minEndPTS||s,u=t.maxStartPTS||a,l=0;l<n.length;l++){var c=n.start(l)-this.bufferPadding,d=n.end(l)+this.bufferPadding;if(u>=c&&o<=d){i.time.push({startPTS:Math.max(a,n.start(l)),endPTS:Math.min(s,n.end(l))});break}if(a<d&&s>c)i.partial=!0,i.time.push({startPTS:Math.max(a,n.start(l)),endPTS:Math.min(s,n.end(l))});else if(s<=c)break}return i},e.getPartialFragment=function(t){var e,r,n,i=null,a=0,s=this.bufferPadding,u=this.fragments;return Object.keys(u).forEach((function(l){var c=u[l];c&&o(c)&&(r=c.body.start-s,n=c.body.end+s,t>=r&&t<=n&&(e=Math.min(t-r,n-t),a<=e&&(i=c.body,a=e)))})),i},e.getState=function(t){var e=u(t),r=this.fragments[e];return r?r.buffered?o(r)?n.PARTIAL:n.OK:r.backtrack?n.BACKTRACKED:n.APPENDING:n.NOT_LOADED},e.backtrack=function(t,e){var r=u(t),n=this.fragments[r];if(!n||n.backtrack)return null;var i=n.backtrack=e||n.loaded;return n.loaded=null,i},e.getBacktrackData=function(t){var e=u(t),r=this.fragments[e];if(r){var n,i=r.backtrack;if(null!==i&&void 0!==i&&null!==(n=i.payload)&&void 0!==n&&n.byteLength)return i;this.removeFragment(t)}return null},e.isTimeBuffered=function(t,e,r){for(var n,i,a=0;a<r.length;a++){if(n=r.start(a)-this.bufferPadding,i=r.end(a)+this.bufferPadding,t>=n&&e<=i)return!0;if(e<=n)return!1}return!1},e.onFragLoaded=function(t,e){var r=e.frag,n=e.part;if("initSegment"!==r.sn&&!r.bitrateTest&&!n){var i=u(r);this.fragments[i]={body:r,loaded:e,backtrack:null,buffered:!1,range:Object.create(null)}}},e.onBufferAppended=function(t,e){var r=this,n=e.frag,i=e.part,s=e.timeRanges;if(n.type===a.PlaylistLevelType.MAIN)if(this.activeFragment=n,i){var o=this.activeParts;o||(this.activeParts=o=[]),o.push(i)}else this.activeParts=null;this.timeRanges=s,Object.keys(s).forEach((function(t){var e=s[t];if(r.detectEvictedFragments(t,e),!i)for(var a=0;a<e.length;a++)n.appendedPTS=Math.max(e.end(a),n.appendedPTS||0)}))},e.onFragBuffered=function(t,e){this.detectPartialFragments(e)},e.hasFragment=function(t){var e=u(t);return!!this.fragments[e]},e.removeFragment=function(t){var e=u(t);t.stats.loaded=0,t.clearElementaryStreamInfo(),delete this.fragments[e]},e.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},t}();function o(t){var e,r;return t.buffered&&((null===(e=t.range.video)||void 0===e?void 0:e.partial)||(null===(r=t.range.audio)||void 0===r?void 0:r.partial))}function u(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn}},"./src/controller/gap-controller.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"STALL_MINIMUM_DURATION_MS",(function(){return o})),r.d(e,"MAX_START_GAP_JUMP",(function(){return u})),r.d(e,"SKIP_BUFFER_HOLE_STEP_SECONDS",(function(){return l})),r.d(e,"SKIP_BUFFER_RANGE_START",(function(){return c})),r.d(e,"default",(function(){return d}));var n=r("./src/utils/buffer-helper.ts"),i=r("./src/errors.ts"),a=r("./src/events.ts"),s=r("./src/utils/logger.ts"),o=250,u=2,l=.1,c=.05,d=function(){function t(t,e,r,n){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=e,this.fragmentTracker=r,this.hls=n}var e=t.prototype;return e.destroy=function(){this.hls=this.fragmentTracker=this.media=null},e.poll=function(t){var e=this.config,r=this.media,i=this.stalled,a=r.currentTime,l=r.seeking,c=this.seeking&&!l,d=!this.seeking&&l;if(this.seeking=l,a===t){if((d||c)&&(this.stalled=null),!r.paused&&!r.ended&&0!==r.playbackRate&&n.BufferHelper.getBuffered(r).length){var f=n.BufferHelper.bufferInfo(r,a,0),h=f.len>0,p=f.nextStart||0;if(h||p){if(l){var g=f.len>u,m=!p||p-a>u&&!this.fragmentTracker.getPartialFragment(a);if(g||m)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var v,y=Math.max(p,f.start||0)-a,b=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,E=(null===b||void 0===b||null===(v=b.details)||void 0===v?void 0:v.live)?2*b.details.targetduration:u;if(y>0&&y<=E)return void this._trySkipBufferHole(null)}var T=self.performance.now();if(null!==i){var S=T-i;!l&&S>=o&&this._reportStall(f.len);var w=n.BufferHelper.bufferInfo(r,a,e.maxBufferHole);this._tryFixBufferStall(w,S)}else this.stalled=T}}}else if(this.moved=!0,null!==i){if(this.stallReported){var _=self.performance.now()-i;s.logger.warn("playback not stuck anymore @"+a+", after "+Math.round(_)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},e._tryFixBufferStall=function(t,e){var r=this.config,n=this.fragmentTracker,i=this.media.currentTime,a=n.getPartialFragment(i);a&&this._trySkipBufferHole(a)||t.len>r.maxBufferHole&&e>1e3*r.highBufferWatchdogPeriod&&(s.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},e._reportStall=function(t){var e=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,s.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer (buffer="+t+")"),e.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:t}))},e._trySkipBufferHole=function(t){for(var e=this.config,r=this.hls,o=this.media,u=o.currentTime,d=0,f=n.BufferHelper.getBuffered(o),h=0;h<f.length;h++){var p=f.start(h);if(u+e.maxBufferHole>=d&&u<p){var g=Math.max(p+c,o.currentTime+l);return s.logger.warn("skipping hole, adjusting currentTime from "+u+" to "+g),this.moved=!0,this.stalled=null,o.currentTime=g,t&&r.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+u+" to "+g,frag:t}),g}d=f.end(h)}return 0},e._tryNudgeBuffer=function(){var t=this.config,e=this.hls,r=this.media,n=r.currentTime,o=(this.nudgeRetry||0)+1;if(this.nudgeRetry=o,o<t.nudgeMaxRetry){var u=n+o*t.nudgeOffset;s.logger.warn("Nudging 'currentTime' from "+n+" to "+u),r.currentTime=u,e.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else s.logger.error("Playhead still not moving while enough data buffered @"+n+" after "+t.nudgeMaxRetry+" nudges"),e.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},t}()},"./src/controller/id3-track-controller.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/events.ts"),i=r("./src/utils/texttrack-utils.ts"),a=r("./src/demux/id3.ts"),s=function(){function t(t){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=t,this._registerListeners()}var e=t.prototype;return e.destroy=function(){this._unregisterListeners()},e._registerListeners=function(){var t=this.hls;t.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},e._unregisterListeners=function(){var t=this.hls;t.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},e.onMediaAttached=function(t,e){this.media=e.media},e.onMediaDetaching=function(){this.id3Track&&(Object(i.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},e.getID3Track=function(t){if(this.media){for(var e=0;e<t.length;e++){var r=t[e];if("metadata"===r.kind&&"id3"===r.label)return Object(i.sendAddTrackEvent)(r,this.media),r}return this.media.addTextTrack("metadata","id3")}},e.onFragParsingMetadata=function(t,e){if(this.media){var r=e.frag,n=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,s=0;s<n.length;s++){var o=a.getID3Frames(n[s].data);if(o){var u=n[s].pts,l=s<n.length-1?n[s+1].pts:r.end;l-u<=0&&(l=u+.25);for(var c=0;c<o.length;c++){var d=o[c];if(!a.isTimeStampFrame(d)){var f=new i(u,l,"");f.value=d,this.id3Track.addCue(f)}}}}}},e.onBufferFlushing=function(t,e){var r=e.startOffset,n=e.endOffset,a=e.type;if(!a||"audio"===a){var s=this.id3Track;s&&Object(i.removeCuesInRange)(s,r,n)}},t}();e.default=s},"./src/controller/latency-controller.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return o}));var n=r("./src/errors.ts"),i=r("./src/events.ts"),a=r("./src/utils/logger.ts");function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function t(t){var e=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return e.timeupdate()},this.hls=t,this.config=t.config,this.registerListeners()}var e,r,o,u=t.prototype;return u.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},u.registerListeners=function(){this.hls.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(i.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(i.Events.ERROR,this.onError,this)},u.unregisterListeners=function(){this.hls.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(i.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(i.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(i.Events.ERROR,this.onError)},u.onMediaAttached=function(t,e){this.media=e.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},u.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},u.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},u.onLevelUpdated=function(t,e){var r=e.details;this.levelDetails=r,r.advanced&&this.timeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},u.onError=function(t,e){e.details===n.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,a.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},u.timeupdate=function(){var t=this.media,e=this.levelDetails;if(t&&e){this.currentTime=t.currentTime;var r=this.computeLatency();if(null!==r){this._latency=r;var n=this.config,i=n.lowLatencyMode,a=n.maxLiveSyncPlaybackRate;if(i&&1!==a){var s=this.targetLatency;if(null!==s){var o=r-s,u=o<Math.min(this.maxLatency,s+e.targetduration);if(e.live&&u&&o>.05&&this.forwardBufferLength>1){var l=Math.min(2,Math.max(1,a)),c=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;t.playbackRate=Math.min(l,Math.max(1,c))}else 1!==t.playbackRate&&0!==t.playbackRate&&(t.playbackRate=1)}}}}},u.estimateLiveEdge=function(){var t=this.levelDetails;return null===t?null:t.edge+t.age},u.computeLatency=function(){var t=this.estimateLiveEdge();return null===t?null:t-this.currentTime},e=t,(r=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var t=this.config,e=this.levelDetails;return void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:e?t.liveMaxLatencyDurationCount*e.targetduration:0}},{key:"targetLatency",get:function(){var t=this.levelDetails;if(null===t)return null;var e=t.holdBack,r=t.partHoldBack,n=t.targetduration,i=this.config,a=i.liveSyncDuration,s=i.liveSyncDurationCount,o=i.lowLatencyMode,u=this.hls.userConfig,l=o&&r||e;(u.liveSyncDuration||u.liveSyncDurationCount||0===l)&&(l=void 0!==a?a:s*n);var c=n;return l+Math.min(1*this.stallCount,c)}},{key:"liveSyncPosition",get:function(){var t=this.estimateLiveEdge(),e=this.targetLatency,r=this.levelDetails;if(null===t||null===e||null===r)return null;var n=r.edge,i=t-e-this.edgeStalled,a=n-r.totalduration,s=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(a,i),s)}},{key:"drift",get:function(){var t=this.levelDetails;return null===t?1:t.drift}},{key:"edgeStalled",get:function(){var t=this.levelDetails;if(null===t)return 0;var e=3*(this.config.lowLatencyMode&&t.partTarget||t.targetduration);return Math.max(t.age-e,0)}},{key:"forwardBufferLength",get:function(){var t=this.media,e=this.levelDetails;if(!t||!e)return 0;var r=t.buffered.length;return r?t.buffered.end(r-1):e.edge-this.currentTime}}])&&s(e.prototype,r),o&&s(e,o),t}()},"./src/controller/level-controller.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return p}));var n=r("./src/types/level.ts"),i=r("./src/events.ts"),a=r("./src/errors.ts"),s=r("./src/utils/codecs.ts"),o=r("./src/controller/level-helper.ts"),u=r("./src/controller/base-playlist-controller.ts"),l=r("./src/types/loader.ts");function c(){return(c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),p=function(t){var e,r;function u(e){var r;return(r=t.call(this,e,"[level-controller]")||this)._levels=[],r._firstLevel=-1,r._startLevel=void 0,r.currentLevelIndex=-1,r.manualLevelIndex=-1,r.onParsedComplete=void 0,r._registerListeners(),r}r=t,(e=u).prototype=Object.create(r.prototype),e.prototype.constructor=e,f(e,r);var p,g,m,v=u.prototype;return v._registerListeners=function(){var t=this.hls;t.on(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.on(i.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(i.Events.FRAG_LOADED,this.onFragLoaded,this),t.on(i.Events.ERROR,this.onError,this)},v._unregisterListeners=function(){var t=this.hls;t.off(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.off(i.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(i.Events.FRAG_LOADED,this.onFragLoaded,this),t.off(i.Events.ERROR,this.onError,this)},v.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,t.prototype.destroy.call(this)},v.startLoad=function(){this._levels.forEach((function(t){t.loadError=0})),t.prototype.startLoad.call(this)},v.onManifestLoaded=function(t,e){var r,u,l=[],c=[],d=[],f={},p=!1,g=!1,m=!1;if(e.levels.forEach((function(t){var e=t.attrs;p=p||!(!t.width||!t.height),g=g||!!t.videoCodec,m=m||!!t.audioCodec,h&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0),(u=f[t.bitrate])?u.url.push(t.url):(u=new n.Level(t),f[t.bitrate]=u,l.push(u)),e&&(e.AUDIO&&Object(o.addGroupId)(u,"audio",e.AUDIO),e.SUBTITLES&&Object(o.addGroupId)(u,"text",e.SUBTITLES))})),(p||g)&&m&&(l=l.filter((function(t){var e=t.videoCodec,r=t.width,n=t.height;return!!e||!(!r||!n)}))),l=l.filter((function(t){var e=t.audioCodec,r=t.videoCodec;return(!e||Object(s.isCodecSupportedInMp4)(e,"audio"))&&(!r||Object(s.isCodecSupportedInMp4)(r,"video"))})),e.audioTracks&&(c=e.audioTracks.filter((function(t){return!t.audioCodec||Object(s.isCodecSupportedInMp4)(t.audioCodec,"audio")})),Object(o.assignTrackIdsByGroup)(c)),e.subtitles&&(d=e.subtitles,Object(o.assignTrackIdsByGroup)(d)),l.length>0){r=l[0].bitrate,l.sort((function(t,e){return t.bitrate-e.bitrate})),this._levels=l;for(var v=0;v<l.length;v++)if(l[v].bitrate===r){this._firstLevel=v,this.log("manifest loaded, "+l.length+" level(s) found, first bitrate: "+r);break}var y=m&&!g,b={levels:l,audioTracks:c,subtitleTracks:d,firstLevel:this._firstLevel,stats:e.stats,audio:m,video:g,altAudio:!y&&c.some((function(t){return!!t.url}))};this.hls.trigger(i.Events.MANIFEST_PARSED,b),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(i.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:e.url,reason:"no level with compatible codecs found in manifest"})},v.onError=function(e,r){if(t.prototype.onError.call(this,e,r),!r.fatal){var n=r.context,i=this._levels[this.currentLevelIndex];if(n&&(n.type===l.PlaylistContextType.AUDIO_TRACK&&i.audioGroupIds&&n.groupId===i.audioGroupIds[i.urlId]||n.type===l.PlaylistContextType.SUBTITLE_TRACK&&i.textGroupIds&&n.groupId===i.textGroupIds[i.urlId]))this.redundantFailover(this.currentLevelIndex);else{var s,o=!1,u=!0;switch(r.details){case a.ErrorDetails.FRAG_LOAD_ERROR:case a.ErrorDetails.FRAG_LOAD_TIMEOUT:case a.ErrorDetails.KEY_LOAD_ERROR:case a.ErrorDetails.KEY_LOAD_TIMEOUT:if(r.frag){var c=this._levels[r.frag.level];c?(c.fragmentError++,c.fragmentError>this.hls.config.fragLoadingMaxRetry&&(s=r.frag.level)):s=r.frag.level}break;case a.ErrorDetails.LEVEL_LOAD_ERROR:case a.ErrorDetails.LEVEL_LOAD_TIMEOUT:n&&(n.deliveryDirectives&&(u=!1),s=n.level),o=!0;break;case a.ErrorDetails.REMUX_ALLOC_ERROR:s=r.level,o=!0}void 0!==s&&this.recoverLevel(r,s,o,u)}}},v.recoverLevel=function(t,e,r,n){var i=t.details,a=this._levels[e];if(a.loadError++,r){if(!this.retryLoadingOrFail(t))return void(this.currentLevelIndex=-1);t.levelRetry=!0}if(n){var s=a.url.length;if(s>1&&a.loadError<s)t.levelRetry=!0,this.redundantFailover(e);else if(-1===this.manualLevelIndex){var o=0===e?this._levels.length-1:e-1;this.currentLevelIndex!==o&&0===this._levels[o].loadError&&(this.warn(i+": switch to "+o),t.levelRetry=!0,this.hls.nextAutoLevel=o)}}},v.redundantFailover=function(t){var e=this._levels[t],r=e.url.length;if(r>1){var n=(e.urlId+1)%r;this.warn("Switching to redundant URL-id "+n),this._levels.forEach((function(t){t.urlId=n})),this.level=t}},v.onFragLoaded=function(t,e){var r=e.frag;if(void 0!==r&&r.type===l.PlaylistLevelType.MAIN){var n=this._levels[r.level];void 0!==n&&(n.fragmentError=0,n.loadError=0)}},v.onLevelLoaded=function(t,e){var r,n,i=e.level,a=e.details,s=this._levels[i];if(!s)return this.warn("Invalid level index "+i),void(null!==(n=e.deliveryDirectives)&&void 0!==n&&n.skip&&(a.deltaUpdateFailed=!0));i===this.currentLevelIndex?(0===s.fragmentError&&(s.loadError=0,this.retryCount=0),this.playlistLoaded(i,e,s.details)):null!==(r=e.deliveryDirectives)&&void 0!==r&&r.skip&&(a.deltaUpdateFailed=!0)},v.onAudioTrackSwitched=function(t,e){var r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var n=-1,i=this.hls.audioTracks[e.id].groupId,a=0;a<r.audioGroupIds.length;a++)if(r.audioGroupIds[a]===i){n=a;break}n!==r.urlId&&(r.urlId=n,this.startLoad())}},v.loadPlaylist=function(t){var e=this.currentLevelIndex,r=this._levels[e];if(this.canLoad&&r&&r.url.length>0){var n=r.urlId,a=r.url[n];if(t)try{a=t.addDirectives(a)}catch(s){this.warn("Could not construct new URL with HLS Delivery Directives: "+s)}this.log("Attempt loading level index "+e+(t?" at sn "+t.msn+" part "+t.part:"")+" with URL-id "+n+" "+a),this.clearTimer(),this.hls.trigger(i.Events.LEVEL_LOADING,{url:a,level:e,id:n,deliveryDirectives:t||null})}},v.removeLevel=function(t,e){var r=function(t,r){return r!==e},n=this._levels.filter((function(n,i){return i!==t||n.url.length>1&&void 0!==e&&(n.url=n.url.filter(r),n.audioGroupIds&&(n.audioGroupIds=n.audioGroupIds.filter(r)),n.textGroupIds&&(n.textGroupIds=n.textGroupIds.filter(r)),n.urlId=0,!0)})).map((function(t,e){var r=t.details;return null!==r&&void 0!==r&&r.fragments&&r.fragments.forEach((function(t){t.level=e})),t}));this._levels=n,this.hls.trigger(i.Events.LEVELS_UPDATED,{levels:n})},p=u,(g=[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(t){var e,r=this._levels;if(0!==r.length&&(this.currentLevelIndex!==t||null===(e=r[t])||void 0===e||!e.details)){if(t<0||t>=r.length){var n=t<0;if(this.hls.trigger(i.Events.ERROR,{type:a.ErrorTypes.OTHER_ERROR,details:a.ErrorDetails.LEVEL_SWITCH_ERROR,level:t,fatal:n,reason:"invalid level idx"}),n)return;t=Math.min(t,r.length-1)}this.clearTimer();var s=this.currentLevelIndex,o=r[s],u=r[t];this.log("switching to level "+t+" from "+s),this.currentLevelIndex=t;var l=c({},u,{level:t,maxBitrate:u.maxBitrate,uri:u.uri,urlId:u.urlId});delete l._urlId,this.hls.trigger(i.Events.LEVEL_SWITCHING,l);var d=u.details;if(!d||d.live){var f=this.switchParams(u.uri,null===o||void 0===o?void 0:o.details);this.loadPlaylist(f)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel}return this._startLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}}])&&d(p.prototype,g),m&&d(p,m),u}(u.default)},"./src/controller/level-helper.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"addGroupId",(function(){return a})),r.d(e,"assignTrackIdsByGroup",(function(){return s})),r.d(e,"updatePTS",(function(){return o})),r.d(e,"updateFragPTSDTS",(function(){return l})),r.d(e,"mergeDetails",(function(){return c})),r.d(e,"mapPartIntersection",(function(){return d})),r.d(e,"mapFragmentIntersection",(function(){return f})),r.d(e,"adjustSliding",(function(){return h})),r.d(e,"computeReloadInterval",(function(){return p})),r.d(e,"getFragmentWithSN",(function(){return g})),r.d(e,"getPartWith",(function(){return m}));var n=r("./src/polyfills/number.ts"),i=r("./src/utils/logger.ts");function a(t,e,r){switch(e){case"audio":t.audioGroupIds||(t.audioGroupIds=[]),t.audioGroupIds.push(r);break;case"text":t.textGroupIds||(t.textGroupIds=[]),t.textGroupIds.push(r)}}function s(t){var e={};t.forEach((function(t){var r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++}))}function o(t,e,r){u(t[e],t[r])}function u(t,e){var r=e.startPTS;if(Object(n.isFiniteNumber)(r)){var i,a=0;e.sn>t.sn?(a=r-t.start,i=t):(a=t.start-r,i=e),i.duration!==a&&(i.duration=a)}else e.sn>t.sn?t.cc===e.cc&&t.minEndPTS?e.start=t.start+(t.minEndPTS-t.start):e.start=t.start+t.duration:e.start=Math.max(t.start-e.duration,0)}function l(t,e,r,a,s,o){a-r<=0&&(i.logger.warn("Fragment should have a positive duration",e),a=r+e.duration,o=s+e.duration);var l=r,c=a,d=e.startPTS,f=e.endPTS;if(Object(n.isFiniteNumber)(d)){var h=Math.abs(d-r);Object(n.isFiniteNumber)(e.deltaPTS)?e.deltaPTS=Math.max(h,e.deltaPTS):e.deltaPTS=h,l=Math.max(r,d),r=Math.min(r,d),s=Math.min(s,e.startDTS),c=Math.min(a,f),a=Math.max(a,f),o=Math.max(o,e.endDTS)}e.duration=a-r;var p=r-e.start;e.appendedPTS=a,e.start=e.startPTS=r,e.maxStartPTS=l,e.startDTS=s,e.endPTS=a,e.minEndPTS=c,e.endDTS=o;var g,m=e.sn;if(!t||m<t.startSN||m>t.endSN)return 0;var v=m-t.startSN,y=t.fragments;for(y[v]=e,g=v;g>0;g--)u(y[g],y[g-1]);for(g=v;g<y.length-1;g++)u(y[g],y[g+1]);return t.fragmentHint&&u(y[y.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,p}function c(t,e){e.initSegment&&t.initSegment&&(e.initSegment=t.initSegment),t.fragmentHint&&delete t.fragmentHint.endPTS;var r,a=0;if(f(t,e,(function(t,i){t.relurl&&(a=t.cc-i.cc),Object(n.isFiniteNumber)(t.startPTS)&&Object(n.isFiniteNumber)(t.endPTS)&&(i.start=i.startPTS=t.startPTS,i.startDTS=t.startDTS,i.appendedPTS=t.appendedPTS,i.maxStartPTS=t.maxStartPTS,i.endPTS=t.endPTS,i.endDTS=t.endDTS,i.minEndPTS=t.minEndPTS,i.duration=t.endPTS-t.startPTS,i.duration&&(r=i),e.PTSKnown=e.alignedSliding=!0),i.elementaryStreams=t.elementaryStreams,i.loader=t.loader,i.stats=t.stats,i.urlId=t.urlId})),e.skippedSegments&&(e.deltaUpdateFailed=e.fragments.some((function(t){return!t})),e.deltaUpdateFailed)){i.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var s=e.skippedSegments;s--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}var o=e.fragments;if(a){i.logger.warn("discontinuity sliding from playlist, take drift into account");for(var u=0;u<o.length;u++)o[u].cc+=a}e.skippedSegments&&(e.initSegment||(e.initSegment=t.initSegment),e.startCC=e.fragments[0].cc),d(t.partList,e.partList,(function(t,e){e.elementaryStreams=t.elementaryStreams,e.stats=t.stats})),r?l(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):h(t,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=t.driftStartTime,e.driftStart=t.driftStart;var c=e.advancedDateTime;if(e.advanced&&c){var p=e.edge;e.driftStart||(e.driftStartTime=c,e.driftStart=p),e.driftEndTime=c,e.driftEnd=p}else e.driftEndTime=t.driftEndTime,e.driftEnd=t.driftEnd,e.advancedDateTime=t.advancedDateTime}function d(t,e,r){if(t&&e)for(var n=0,i=0,a=t.length;i<=a;i++){var s=t[i],o=e[i+n];s&&o&&s.index===o.index&&s.fragment.sn===o.fragment.sn?r(s,o):n--}}function f(t,e,r){for(var n=e.skippedSegments,i=Math.max(t.startSN,e.startSN)-e.startSN,a=(t.fragmentHint?1:0)+(n?e.endSN:Math.min(t.endSN,e.endSN))-e.startSN,s=e.startSN-t.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=i;l<=a;l++){var c=u[s+l],d=o[l];n&&!d&&l<n&&(d=e.fragments[l]=c),c&&d&&r(c,d)}}function h(t,e){var r=e.startSN+e.skippedSegments-t.startSN,n=t.fragments,i=e.fragments;if(!(r<0||r>=n.length)){var a=n[r].start;if(a){for(var s=e.skippedSegments;s<i.length;s++)i[s].start+=a;e.fragmentHint&&(e.fragmentHint.start+=a)}}}function p(t,e){var r,n=1e3*t.levelTargetDuration,i=n/2,a=t.age,s=a>0&&a<3*n,o=e.loading.end-e.loading.start,u=t.availabilityDelay;if(!1===t.updated)if(s){var l=333*t.misses;r=Math.max(Math.min(i,2*o),l),t.availabilityDelay=(t.availabilityDelay||0)+r}else r=i;else s?(u=Math.min(u||n/2,a),t.availabilityDelay=u,r=u+n-a):r=n-o;return Math.round(r)}function g(t,e){if(!t||!t.details)return null;var r=t.details,n=r.fragments[e-r.startSN];return n||((n=r.fragmentHint)&&n.sn===e?n:null)}function m(t,e,r){if(!t||!t.details)return null;var n=t.details.partList;if(n)for(var i=n.length;i--;){var a=n[i];if(a.index===r&&a.fragment.sn===e)return a}return null}},"./src/controller/stream-controller.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return y}));var n=r("./src/polyfills/number.ts"),i=r("./src/controller/base-stream-controller.ts"),a=r("./src/is-supported.ts"),s=r("./src/events.ts"),o=r("./src/utils/buffer-helper.ts"),u=r("./src/controller/fragment-tracker.ts"),l=r("./src/types/loader.ts"),c=r("./src/loader/fragment.ts"),d=r("./src/demux/transmuxer-interface.ts"),f=r("./src/types/transmuxer.ts"),h=r("./src/controller/gap-controller.ts"),p=r("./src/errors.ts"),g=r("./src/utils/logger.ts");function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=function(t){var e,r;function y(e,r){var n;return(n=t.call(this,e,r,"[stream-controller]")||this).audioCodecSwap=!1,n.gapController=null,n.level=-1,n._forceStartLoad=!1,n.altAudio=!1,n.audioOnly=!1,n.fragPlaying=null,n.onvplaying=null,n.onvseeked=null,n.fragLastKbps=0,n.stalled=!1,n.audioCodecSwitch=!1,n.videoBuffer=null,n._registerListeners(),n}r=t,(e=y).prototype=Object.create(r.prototype),e.prototype.constructor=e,v(e,r);var b,E,T,S=y.prototype;return S._registerListeners=function(){var t=this.hls;t.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(s.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.on(s.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(s.Events.ERROR,this.onError,this),t.on(s.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(s.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(s.Events.BUFFER_CREATED,this.onBufferCreated,this),t.on(s.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(s.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this)},S._unregisterListeners=function(){var t=this.hls;t.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),t.off(s.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(s.Events.ERROR,this.onError,this),t.off(s.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(s.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(s.Events.BUFFER_CREATED,this.onBufferCreated,this),t.off(s.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(s.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this)},S.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},S.startLoad=function(t){if(this.levels){var e=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(r.config.testBandwidth?(n=0,this.bitrateTest=!0):n=r.nextAutoLevel),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}e>0&&-1===t&&(this.log("Override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=i.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this._forceStartLoad=!0,this.state=i.State.STOPPED},S.stopLoad=function(){this._forceStartLoad=!1,t.prototype.stopLoad.call(this)},S.doTick=function(){switch(this.state){case i.State.IDLE:this.doTickIdle();break;case i.State.WAITING_LEVEL:var t,e=this.levels,r=this.level,n=null===e||void 0===e||null===(t=e[r])||void 0===t?void 0:t.details;if(n&&(!n.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(n))break;this.state=i.State.IDLE;break}break;case i.State.FRAG_LOADING_WAITING_RETRY:var a,s=self.performance.now(),o=this.retryDate;(!o||s>=o||null!==(a=this.media)&&void 0!==a&&a.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=i.State.IDLE)}this.onTickEnd()},S.onTickEnd=function(){t.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},S.doTickIdle=function(){var t,e,r=this.hls,a=this.levelLastLoaded,l=this.levels,c=this.media,d=r.config,f=r.nextLoadLevel;if(null!==a&&(c||!this.startFragRequested&&d.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&l&&l[f]){var p=l[f];this.level=r.nextLoadLevel=f;var g=p.details;if(!g||this.state===i.State.WAITING_LEVEL||g.live&&this.levelLastLoaded!==f)this.state=i.State.WAITING_LEVEL;else{var m=this.getLoadPosition();if(Object(n.isFiniteNumber)(m)){var v=g.initSegment,y=0;if(!v||v.data||this.bitrateTest){var b,E=p.maxBitrate;b=E?Math.max(8*d.maxBufferSize/E,d.maxBufferLength):d.maxBufferLength,b=Math.min(b,d.maxMaxBufferLength);var T=m<d.maxBufferHole?Math.max(h.MAX_START_GAP_JUMP,d.maxBufferHole):d.maxBufferHole,S=o.BufferHelper.bufferInfo(this.mediaBuffer?this.mediaBuffer:c,m,T);if(S.len>=b)return;if(this._streamEnded(S,g)){var w={};return this.altAudio&&(w.type="video"),this.hls.trigger(s.Events.BUFFER_EOS,w),void(this.state=i.State.ENDED)}if(y=S.end,(v=this.getNextFragment(y,g))&&this.fragmentTracker.getState(v)===u.FragmentState.OK&&this.nextLoadPosition>y&&(v=this.getNextFragment(this.nextLoadPosition,g)),!v)return}"identity"!==(null===(t=v.decryptdata)||void 0===t?void 0:t.keyFormat)||null!==(e=v.decryptdata)&&void 0!==e&&e.key?this.loadFragment(v,g,y):(this.log("Loading key for "+v.sn+" of ["+g.startSN+"-"+g.endSN+"], level "+f),this.loadKey(v))}}}},S.loadKey=function(t){this.state=i.State.KEY_LOADING,this.hls.trigger(s.Events.KEY_LOADING,{frag:t})},S.loadFragment=function(e,r,n){var i,a=this.fragmentTracker.getState(e);if(this.fragCurrent=e,a===u.FragmentState.BACKTRACKED){var s=this.fragmentTracker.getBacktrackData(e);if(s)return this._handleFragmentLoadProgress(s),void this._handleFragmentLoadComplete(s);a=u.FragmentState.NOT_LOADED}a===u.FragmentState.NOT_LOADED||a===u.FragmentState.PARTIAL?"initSegment"===e.sn?this._loadInitSegment(e):this.bitrateTest?(e.bitrateTest=!0,this.log("Fragment "+e.sn+" of level "+e.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(e)):(this.startFragRequested=!0,t.prototype.loadFragment.call(this,e,r,n)):a===u.FragmentState.APPENDING?this.reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e):0===(null===(i=this.media)||void 0===i?void 0:i.buffered.length)&&this.fragmentTracker.removeAllFragments()},S.getAppendedFrag=function(t){var e=this.fragmentTracker.getAppendedFrag(t,l.PlaylistLevelType.MAIN);return e&&"fragment"in e?e.fragment:e},S.getBufferedFrag=function(t){return this.fragmentTracker.getBufferedFrag(t,l.PlaylistLevelType.MAIN)},S.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.end+.5):null},S.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},S.nextLevelSwitch=function(){var t=this.levels,e=this.media;if(null!==e&&void 0!==e&&e.readyState){var r,n=this.getAppendedFrag(e.currentTime);if(n&&n.start>1&&this.flushMainBuffer(0,n.start-1),!e.paused&&t){var i=t[this.hls.nextLoadLevel],a=this.fragLastKbps;r=a&&this.fragCurrent?this.fragCurrent.duration*i.maxBitrate/(1e3*a)+1:0}else r=0;var s=this.getBufferedFrag(e.currentTime+r);if(s){var o=this.followingBufferedFrag(s);if(o){this.abortCurrentFrag();var u=o.maxStartPTS?o.maxStartPTS:o.start,l=o.duration,c=Math.max(s.end,u+Math.min(Math.max(l-this.config.maxFragLookUpTolerance,.5*l),.75*l));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}},S.abortCurrentFrag=function(){var t=this.fragCurrent;this.fragCurrent=null,null!==t&&void 0!==t&&t.loader&&t.loader.abort(),this.nextLoadPosition=this.getLoadPosition()},S.flushMainBuffer=function(e,r){t.prototype.flushMainBuffer.call(this,e,r,this.altAudio?"video":null)},S.onMediaAttached=function(e,r){t.prototype.onMediaAttached.call(this,e,r);var n=r.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new h.default(this.config,n,this.fragmentTracker,this.hls)},S.onMediaDetaching=function(){var e=this.media;e&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),t.prototype.onMediaDetaching.call(this)},S.onMediaPlaying=function(){this.tick()},S.onMediaSeeked=function(){var t=this.media,e=t?t.currentTime:null;Object(n.isFiniteNumber)(e)&&this.log("Media seeked to "+e.toFixed(3)),this.tick()},S.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(s.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},S.onManifestParsed=function(t,e){var r,n=!1,i=!1;e.levels.forEach((function(t){(r=t.audioCodec)&&(-1!==r.indexOf("mp4a.40.2")&&(n=!0),-1!==r.indexOf("mp4a.40.5")&&(i=!0))})),this.audioCodecSwitch=n&&i&&!Object(a.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startFragRequested=!1},S.onLevelLoading=function(t,e){var r=this.levels;if(r&&this.state===i.State.IDLE){var n=r[e.level];(!n.details||n.details.live&&this.levelLastLoaded!==e.level||this.waitForCdnTuneIn(n.details))&&(this.state=i.State.WAITING_LEVEL)}},S.onLevelLoaded=function(t,e){var r,n=this.levels,a=e.level,o=e.details,u=o.totalduration;if(n){this.log("Level "+a+" loaded ["+o.startSN+","+o.endSN+"], cc ["+o.startCC+", "+o.endCC+"] duration:"+u);var l=this.fragCurrent;!l||this.state!==i.State.FRAG_LOADING&&this.state!==i.State.FRAG_LOADING_WAITING_RETRY||l.level!==e.level&&l.loader&&(this.state=i.State.IDLE,l.loader.abort());var c=n[a],d=0;if(o.live||null!==(r=c.details)&&void 0!==r&&r.live){if(o.fragments[0]||(o.deltaUpdateFailed=!0),o.deltaUpdateFailed)return;d=this.alignPlaylists(o,c.details)}if(c.details=o,this.levelLastLoaded=a,this.hls.trigger(s.Events.LEVEL_UPDATED,{details:o,level:a}),this.state===i.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=i.State.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,d),this.tick()}else this.warn("Levels were reset while loading level "+a)},S._handleFragmentLoadProgress=function(t){var e,r=t.frag,n=t.part,i=t.payload,a=this.levels;if(a){var s=a[r.level],o=s.details;if(o){var u=s.videoCodec,c=o.PTSKnown||!o.live,h=null===(e=o.initSegment)||void 0===e?void 0:e.data,p=this._getAudioCodec(s),g=this.transmuxer=this.transmuxer||new d.default(this.hls,l.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=n?n.index:-1,v=-1!==m,y=new f.ChunkMetadata(r.level,r.sn,r.stats.chunkCount,i.byteLength,m,v),b=this.initPTS[r.cc];g.push(i,h,p,u,r,n,o.totalduration,c,y,b)}else this.warn("Dropping fragment "+r.sn+" of level "+r.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},S.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},S.onAudioTrackSwitching=function(t,e){var r=this.altAudio,n=!!e.url,a=e.id;if(!n){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var o=this.fragCurrent;null!==o&&void 0!==o&&o.loader&&(this.log("Switching to main audio track, cancel main fragment load"),o.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.resetTransmuxer(),this.state=i.State.IDLE}else this.audioOnly&&this.resetTransmuxer();var u=this.hls;r&&u.trigger(s.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u.trigger(s.Events.AUDIO_TRACK_SWITCHED,{id:a})}},S.onAudioTrackSwitched=function(t,e){var r=e.id,n=!!this.hls.audioTracks[r].url;if(n){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=n,this.tick()},S.onBufferCreated=function(t,e){var r,n,i=e.tracks,a=!1;for(var s in i){var o=i[s];if("main"===o.id){if(n=s,r=o,"video"===s){var u=i[s];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&r?(this.log("Alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},S.onFragBuffered=function(t,e){var r=e.frag,n=e.part;if(!r||r.type===l.PlaylistLevelType.MAIN){if(this.fragContextChanged(r))return this.warn("Fragment "+r.sn+(n?" p: "+n.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===i.State.PARSED&&(this.state=i.State.IDLE));var a=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),"initSegment"!==r.sn&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}},S.onError=function(t,e){switch(e.details){case p.ErrorDetails.FRAG_LOAD_ERROR:case p.ErrorDetails.FRAG_LOAD_TIMEOUT:case p.ErrorDetails.KEY_LOAD_ERROR:case p.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(l.PlaylistLevelType.MAIN,e);break;case p.ErrorDetails.LEVEL_LOAD_ERROR:case p.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==i.State.ERROR&&(e.fatal?(this.warn(""+e.details),this.state=i.State.ERROR):e.levelRetry||this.state!==i.State.WAITING_LEVEL||(this.state=i.State.IDLE));break;case p.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==i.State.PARSING&&this.state!==i.State.PARSED||(this.media&&o.BufferHelper.isBuffered(this.media,this.media.currentTime)&&o.BufferHelper.isBuffered(this.media,this.media.currentTime+.5)?(this.reduceMaxBufferLength(),this.state=i.State.IDLE):(this.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.immediateLevelSwitch()))}},S.checkBuffer=function(){var t=this.media,e=this.gapController;if(t&&e&&t.readyState){var r=o.BufferHelper.getBuffered(t);!this.loadedmetadata&&r.length?(this.loadedmetadata=!0,this._seekToStartPos()):e.poll(this.lastCurrentTime),this.lastCurrentTime=t.currentTime}},S.onFragLoadEmergencyAborted=function(){this.state=i.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},S.onBufferFlushed=function(t,e){var r=e.type;if(r!==c.ElementaryStreamTypes.AUDIO){var n=(r===c.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,r)}},S.onLevelsUpdated=function(t,e){this.levels=e.levels},S.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},S._seekToStartPos=function(){var t=this.media,e=t.currentTime,r=this.startPosition;if(r>=0&&e<r){if(t.seeking)return void g.logger.log("could not seek to "+r+", already seeking at "+e);var n=o.BufferHelper.getBuffered(t),i=(n.length?n.start(0):0)-r;i>0&&i<this.config.maxBufferHole&&(g.logger.log("adjusting start position by "+i+" to match buffer start"),r+=i,this.startPosition=r),this.log("seek to target start position "+r+" from current time "+e),t.currentTime=r}},S._getAudioCodec=function(t){var e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&e&&(this.log("Swapping audio codec"),e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),e},S._loadBitrateTestFrag=function(t){var e=this;this._doFragLoad(t).then((function(r){var n=e.hls;if(r&&!n.nextLoadLevel&&!e.fragContextChanged(t)){e.fragLoadError=0,e.state=i.State.IDLE,e.startFragRequested=!1,e.bitrateTest=!1;var a=t.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),n.trigger(s.Events.FRAG_LOADED,r)}}))},S._handleTransmuxComplete=function(t){var e,r="main",a=this.hls,o=t.remuxResult,u=t.chunkMeta,l=this.getCurrentContext(u);if(!l)return this.warn("The loading context changed while buffering fragment "+u.sn+" of level "+u.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(u.level);var d=l.frag,f=l.part,h=l.level,p=o.video,g=o.text,m=o.id3,v=o.initSegment,y=this.altAudio?void 0:o.audio;if(!this.fragContextChanged(d)){if(this.state=i.State.PARSING,v){v.tracks&&(this._bufferInitSegment(h,v.tracks,d,u),a.trigger(s.Events.FRAG_PARSING_INIT_SEGMENT,{frag:d,id:r,tracks:v.tracks}));var b=v.initPTS,E=v.timescale;Object(n.isFiniteNumber)(b)&&(this.initPTS[d.cc]=b,a.trigger(s.Events.INIT_PTS_FOUND,{frag:d,id:r,initPTS:b,timescale:E}))}if(p&&!1!==o.independent){if(h.details){var T=p.startPTS,S=p.endPTS,w=p.startDTS,_=p.endDTS;if(f)f.elementaryStreams[p.type]={startPTS:T,endPTS:S,startDTS:w,endDTS:_};else if(p.dropped&&p.independent){if(this.getLoadPosition()+this.config.maxBufferHole<T)return void this.backtrack(d);d.setElementaryStreamInfo(p.type,d.start,S,d.start,_,!0)}d.setElementaryStreamInfo(p.type,T,S,w,_),this.bufferFragmentData(p,d,f,u)}}else if(!1===o.independent)return void this.backtrack(d);if(y){var k=y.startPTS,A=y.endPTS,L=y.startDTS,D=y.endDTS;f&&(f.elementaryStreams[c.ElementaryStreamTypes.AUDIO]={startPTS:k,endPTS:A,startDTS:L,endDTS:D}),d.setElementaryStreamInfo(c.ElementaryStreamTypes.AUDIO,k,A,L,D),this.bufferFragmentData(y,d,f,u)}if(null!==m&&void 0!==m&&null!==(e=m.samples)&&void 0!==e&&e.length){var R={frag:d,id:r,samples:m.samples};a.trigger(s.Events.FRAG_PARSING_METADATA,R)}if(g){var C={frag:d,id:r,samples:g.samples};a.trigger(s.Events.FRAG_PARSING_USERDATA,C)}}},S._bufferInitSegment=function(t,e,r,n){var a=this;if(this.state===i.State.PARSING){this.audioOnly=!!e.audio&&!e.video,this.altAudio&&!this.audioOnly&&delete e.audio;var o=e.audio,u=e.video,l=e.audiovideo;if(o){var c=t.audioCodec,d=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(c&&(c=-1!==c.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==o.metadata.channelCount&&-1===d.indexOf("firefox")&&(c="mp4a.40.5")),-1!==d.indexOf("android")&&"audio/mpeg"!==o.container&&(c="mp4a.40.2",this.log("Android: force audio codec to "+c)),t.audioCodec&&t.audioCodec!==c&&this.log('Swapping manifest audio codec "'+t.audioCodec+'" for "'+c+'"'),o.levelCodec=c,o.id="main",this.log("Init audio buffer, container:"+o.container+", codecs[selected/level/parsed]=["+(c||"")+"/"+(t.audioCodec||"")+"/"+o.codec+"]")}u&&(u.levelCodec=t.videoCodec,u.id="main",this.log("Init video buffer, container:"+u.container+", codecs[level/parsed]=["+(t.videoCodec||"")+"/"+u.codec+"]")),l&&this.log("Init audiovideo buffer, container:"+l.container+", codecs[level/parsed]=["+(t.attrs.CODECS||"")+"/"+l.codec+"]"),this.hls.trigger(s.Events.BUFFER_CODECS,e),Object.keys(e).forEach((function(t){var i=e[t].initSegment;null!==i&&void 0!==i&&i.byteLength&&a.hls.trigger(s.Events.BUFFER_APPENDING,{type:t,data:i,frag:r,part:null,chunkMeta:n,parent:r.type})})),this.tick()}},S.backtrack=function(t){this.resetTransmuxer(),this.flushBufferGap(t);var e=this.fragmentTracker.backtrack(t);this.fragPrevious=null,this.nextLoadPosition=t.start,e?this.resetFragmentLoading(t):this.state=i.State.BACKTRACKING},S.checkFragmentChanged=function(){var t=this.media,e=null;if(t&&t.readyState>1&&!1===t.seeking){var r=t.currentTime;if(o.BufferHelper.isBuffered(t,r)?e=this.getAppendedFrag(r):o.BufferHelper.isBuffered(t,r+.1)&&(e=this.getAppendedFrag(r+.1)),e){var n=this.fragPlaying,i=e.level;n&&e.sn===n.sn&&n.level===i&&e.urlId===n.urlId||(this.hls.trigger(s.Events.FRAG_CHANGED,{frag:e}),n&&n.level===i||this.hls.trigger(s.Events.LEVEL_SWITCHED,{level:i}),this.fragPlaying=e)}}},b=y,(E=[{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"currentLevel",get:function(){var t=this.media;if(t){var e=this.getAppendedFrag(t.currentTime);if(e)return e.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;if(t){var e=this.getAppendedFrag(t.currentTime);return this.followingBufferedFrag(e)}return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&m(b.prototype,E),T&&m(b,T),y}(i.default)},"./src/controller/subtitle-stream-controller.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"SubtitleStreamController",(function(){return h}));var n=r("./src/events.ts"),i=r("./src/utils/logger.ts"),a=r("./src/utils/buffer-helper.ts"),s=r("./src/controller/fragment-finders.ts"),o=r("./src/controller/fragment-tracker.ts"),u=r("./src/controller/base-stream-controller.ts"),l=r("./src/types/loader.ts"),c=r("./src/types/level.ts");function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=function(t){var e,r;function h(e,r){var n;return(n=t.call(this,e,r,"[subtitle-stream-controller]")||this).levels=[],n.currentTrackId=-1,n.tracksBuffered=void 0,n.config=e.config,n.fragCurrent=null,n.fragPrevious=null,n.media=null,n.mediaBuffer=null,n.state=u.State.STOPPED,n.tracksBuffered=[],n._registerListeners(),n}r=t,(e=h).prototype=Object.create(r.prototype),e.prototype.constructor=e,f(e,r);var p,g,m,v=h.prototype;return v._registerListeners=function(){var t=this.hls;t.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(n.Events.ERROR,this.onError,this),t.on(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this)},v._unregisterListeners=function(){var t=this.hls;t.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(n.Events.ERROR,this.onError,this),t.off(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this)},v.startLoad=function(){this.stopLoad(),this.state=u.State.IDLE;var t=this.levels[this.currentTrackId];null!==t&&void 0!==t&&t.details&&(this.setInterval(500),this.tick())},v.onHandlerDestroyed=function(){this.state=u.State.STOPPED,this._unregisterListeners(),t.prototype.onHandlerDestroyed.call(this)},v.onSubtitleFragProcessed=function(t,e){var r=e.frag,n=e.success;if(this.fragPrevious=r,this.state=u.State.IDLE,n){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var a,s=r.start,o=0;o<i.length;o++)if(s>=i[o].start&&s<=i[o].end){a=i[o];break}var l=r.start+r.duration;a?a.end=l:(a={start:s,end:l},i.push(a))}}},v.onMediaAttached=function(t,e){var r=e.media;this.media=r,this.state=u.State.IDLE},v.onMediaDetaching=function(){var t=this;this.media&&(this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.currentTrackId=-1,this.levels.forEach((function(e){t.tracksBuffered[e.id]=[]})),this.media=null,this.mediaBuffer=null,this.state=u.State.STOPPED)},v.onError=function(t,e){var r,n=e.frag;n&&n.type===l.PlaylistLevelType.SUBTITLE&&(null!==(r=this.fragCurrent)&&void 0!==r&&r.loader&&this.fragCurrent.loader.abort(),this.state=u.State.IDLE)},v.onSubtitleTracksUpdated=function(t,e){var r=this,n=e.subtitleTracks;this.tracksBuffered=[],this.levels=n.map((function(t){return new c.Level(t)})),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach((function(t){r.tracksBuffered[t.id]=[]})),this.mediaBuffer=null},v.onSubtitleTrackSwitch=function(t,e){if(this.currentTrackId=e.id,this.levels.length&&-1!==this.currentTrackId){var r=this.levels[this.currentTrackId];null!==r&&void 0!==r&&r.details?(this.mediaBuffer=this.mediaBufferTimeRanges,this.setInterval(500)):this.mediaBuffer=null}else this.clearInterval()},v.onSubtitleTrackLoaded=function(t,e){var r,n=e.id,i=e.details,a=this.currentTrackId,s=this.levels;if(s.length&&i){var o=s[a];if(!(n>=s.length||n!==a)&&o){if(this.mediaBuffer=this.mediaBufferTimeRanges,i.live||null!==(r=o.details)&&void 0!==r&&r.live){if(i.deltaUpdateFailed)return;this.alignPlaylists(i,o.details)}o.details=i,this.levelLastLoaded=n,this.setInterval(500)}}},v._handleFragmentLoadComplete=function(t){var e=t.frag,r=t.payload,i=e.decryptdata,a=this.hls;if(!this.fragContextChanged(e)&&r&&r.byteLength>0&&i&&i.key&&i.iv&&"AES-128"===i.method){var s=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(r),i.key.buffer,i.iv.buffer).then((function(t){var r=performance.now();a.trigger(n.Events.FRAG_DECRYPTED,{frag:e,payload:t,stats:{tstart:s,tdecrypt:r}})}))}},v.doTick=function(){if(this.media){if(this.state===u.State.IDLE){var t,e=this.config,r=this.currentTrackId,l=this.fragmentTracker,c=this.media,d=this.levels;if(!d.length||!d[r]||!d[r].details)return;var f=e.maxBufferHole,h=e.maxFragLookUpTolerance,p=Math.min(e.maxBufferLength,e.maxMaxBufferLength),g=a.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,c.currentTime,f),m=g.end;if(g.len>p)return;var v=d[r].details;console.assert(v,"Subtitle track details are defined on idle subtitle stream controller tick");var y,b=v.fragments,E=b.length,T=b[E-1].start+b[E-1].duration,S=this.fragPrevious;m<T?(S&&v.hasProgramDateTime&&(y=Object(s.findFragmentByPDT)(b,S.endProgramDateTime,h)),y||(y=Object(s.findFragmentByPTS)(S,b,m,h))):y=b[E-1],null!==(t=y)&&void 0!==t&&t.encrypted?(i.logger.log("Loading key for "+y.sn),this.state=u.State.KEY_LOADING,this.hls.trigger(n.Events.KEY_LOADING,{frag:y})):y&&l.getState(y)===o.FragmentState.NOT_LOADED&&this.loadFragment(y,v,m)}}else this.state=u.State.IDLE},v.loadFragment=function(e,r,n){this.fragCurrent=e,t.prototype.loadFragment.call(this,e,r,n)},v.stopLoad=function(){this.fragPrevious=null,t.prototype.stopLoad.call(this)},p=h,(g=[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}])&&d(p.prototype,g),m&&d(p,m),h}(u.default)},"./src/controller/subtitle-track-controller.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/events.ts"),i=r("./src/utils/texttrack-utils.ts"),a=r("./src/controller/base-playlist-controller.ts"),s=r("./src/types/loader.ts");function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=function(t){var e,r;function a(e){var r;return(r=t.call(this,e,"[subtitle-track-controller]")||this).media=null,r.tracks=[],r.groupId=null,r.tracksInGroup=[],r.trackId=-1,r.selectDefaultTrack=!0,r.queuedDefaultTrack=-1,r.trackChangeListener=function(){return r.onTextTracksChanged()},r.useTextTrackPolling=!1,r.subtitlePollingInterval=-1,r.subtitleDisplay=!0,r.registerListeners(),r}r=t,(e=a).prototype=Object.create(r.prototype),e.prototype.constructor=e,u(e,r);var l,d,f,h=a.prototype;return h.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=null,t.prototype.destroy.call(this)},h.registerListeners=function(){var t=this.hls;t.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(n.Events.ERROR,this.onError,this)},h.unregisterListeners=function(){var t=this.hls;t.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(n.Events.ERROR,this.onError,this)},h.onMediaAttached=function(t,e){var r=this;this.media=e.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?(self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval((function(){r.trackChangeListener()}),500)):this.media.textTracks.addEventListener("change",this.trackChangeListener))},h.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?self.clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),c(this.media.textTracks).forEach((function(t){Object(i.clearCurrentCues)(t)})),this.subtitleTrack=-1,this.media=null)},h.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},h.onManifestParsed=function(t,e){this.tracks=e.subtitleTracks},h.onSubtitleTrackLoaded=function(t,e){var r=e.id,n=e.details,i=this.trackId,a=this.tracksInGroup[i];if(a){var s=a.details;a.details=e.details,this.log("subtitle track "+r+" loaded ["+n.startSN+"-"+n.endSN+"]"),r===this.trackId&&(this.retryCount=0,this.playlistLoaded(r,e,s))}else this.warn("Invalid subtitle track id "+r)},h.onLevelLoading=function(t,e){this.switchLevel(e.level)},h.onLevelSwitching=function(t,e){this.switchLevel(e.level)},h.switchLevel=function(t){var e=this.hls.levels[t];if(null!==e&&void 0!==e&&e.textGroupIds){var r=e.textGroupIds[e.urlId];if(this.groupId!==r){var i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,a=this.findTrackId(null===i||void 0===i?void 0:i.name)||this.findTrackId(),s=this.tracks.filter((function(t){return!r||t.groupId===r}));this.groupId=r,this.tracksInGroup=s;var o={subtitleTracks:s};this.log("Updating subtitle tracks, "+s.length+' track(s) found in "'+r+'" group-id'),this.hls.trigger(n.Events.SUBTITLE_TRACKS_UPDATED,o),-1!==a&&this.setSubtitleTrack(a,i)}}},h.findTrackId=function(t){for(var e=this.tracksInGroup,r=0;r<e.length;r++){var n=e[r];if((!this.selectDefaultTrack||n.default)&&(!t||t===n.name))return n.id}return-1},h.onError=function(e,r){t.prototype.onError.call(this,e,r),!r.fatal&&r.context&&r.context.type===s.PlaylistContextType.SUBTITLE_TRACK&&r.context.id===this.trackId&&r.context.groupId===this.groupId&&this.retryLoadingOrFail(r)},h.loadPlaylist=function(t){var e=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(e)){var r=e.id,i=e.groupId,a=e.url;if(t)try{a=t.addDirectives(a)}catch(s){this.warn("Could not construct new URL with HLS Delivery Directives: "+s)}this.log("Loading subtitle playlist for id "+r),this.hls.trigger(n.Events.SUBTITLE_TRACK_LOADING,{url:a,id:r,groupId:i,deliveryDirectives:t||null})}},h.toggleTrackModes=function(t){var e=this,r=this.media,n=this.subtitleDisplay,i=this.trackId;if(r){var a=c(r.textTracks),s=a.filter((function(t){return t.groupId===e.groupId}));if(-1===t)[].slice.call(a).forEach((function(t){t.mode="disabled"}));else{var o=s[i];o&&(o.mode="disabled")}var u=s[t];u&&(u.mode=n?"showing":"hidden")}},h.setSubtitleTrack=function(t,e){var r,i=this.tracksInGroup;if(this.media){if(this.trackId!==t&&this.toggleTrackModes(t),!(this.trackId===t&&(-1===t||null!==(r=i[t])&&void 0!==r&&r.details)||t<-1||t>=i.length)){this.clearTimer();var a=i[t];if(this.log("Switching to subtitle track "+t),this.trackId=t,a){var s=a.url,o=a.type,u=a.id;this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:u,type:o,url:s});var l=this.switchParams(a.url,null===e||void 0===e?void 0:e.details);this.loadPlaylist(l)}else this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:t})}}else this.queuedDefaultTrack=t},h.onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var t=-1,e=c(this.media.textTracks),r=0;r<e.length;r++)if("hidden"===e[r].mode)t=r;else if("showing"===e[r].mode){t=r;break}this.subtitleTrack=t}},l=a,(d=[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.selectDefaultTrack=!1;var e=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(t,e)}}])&&o(l.prototype,d),f&&o(l,f),a}(a.default);function c(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];"subtitles"===n.kind&&n.label&&e.push(t[r])}return e}e.default=l},"./src/controller/timeline-controller.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"TimelineController",(function(){return f}));var n=r("./src/polyfills/number.ts"),i=r("./src/events.ts"),a=r("./src/utils/cea-608-parser.ts"),s=r("./src/utils/output-filter.ts"),o=r("./src/utils/webvtt-parser.ts"),u=r("./src/utils/texttrack-utils.ts"),l=r("./src/utils/imsc1-ttml-parser.ts"),c=r("./src/types/loader.ts"),d=r("./src/utils/logger.ts"),f=function(){function t(t){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var e=new s.default(this,"textTrack1"),r=new s.default(this,"textTrack2"),n=new s.default(this,"textTrack3"),o=new s.default(this,"textTrack4");this.cea608Parser1=new a.default(1,e,r),this.cea608Parser2=new a.default(3,n,o)}t.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(i.Events.FRAG_LOADING,this.onFragLoading,this),t.on(i.Events.FRAG_LOADED,this.onFragLoaded,this),t.on(i.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(i.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(i.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(i.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var e=t.prototype;return e.destroy=function(){var t=this.hls;t.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(i.Events.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(i.Events.FRAG_LOADING,this.onFragLoading,this),t.off(i.Events.FRAG_LOADED,this.onFragLoaded,this),t.off(i.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(i.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(i.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(i.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},e.addCues=function(t,e,r,n,a){for(var s,o,u,l,c=!1,d=a.length;d--;){var f=a[d],h=(s=f[0],o=f[1],u=e,l=r,Math.min(o,l)-Math.max(s,u));if(h>=0&&(f[0]=Math.min(f[0],e),f[1]=Math.max(f[1],r),c=!0,h/(r-e)>.5))return}if(c||a.push([e,r]),this.config.renderTextTracksNatively){var p=this.captionsTracks[t];this.Cues.newCue(p,e,r,n)}else{var g=this.Cues.newCue(null,e,r,n);this.hls.trigger(i.Events.CUES_PARSED,{type:"captions",cues:g,track:t})}},e.onInitPtsFound=function(t,e){var r=this,n=e.frag,a=e.id,s=e.initPTS,o=e.timescale,u=this.unparsedVttFrags;"main"===a&&(this.initPTS[n.cc]=s,this.timescale[n.cc]=o),u.length&&(this.unparsedVttFrags=[],u.forEach((function(t){r.onFragLoaded(i.Events.FRAG_LOADED,t)})))},e.getExistingTrack=function(t){var e=this.media;if(e)for(var r=0;r<e.textTracks.length;r++){var n=e.textTracks[r];if(n[t])return n}return null},e.createCaptionsTrack=function(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)},e.createNativeTrack=function(t){if(!this.captionsTracks[t]){var e=this.captionsProperties,r=this.captionsTracks,n=this.media,i=e[t],a=i.label,s=i.languageCode,o=this.getExistingTrack(t);if(o)r[t]=o,Object(u.clearCurrentCues)(r[t]),Object(u.sendAddTrackEvent)(r[t],n);else{var l=this.createTextTrack("captions",a,s);l&&(l[t]=!0,r[t]=l)}}},e.createNonNativeTrack=function(t){if(!this.nonNativeCaptionsTracks[t]){var e=this.captionsProperties[t];if(e){var r={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=r,this.hls.trigger(i.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},e.createTextTrack=function(t,e,r){var n=this.media;if(n)return n.addTextTrack(t,e,r)},e.onMediaAttaching=function(t,e){this.media=e.media,this._cleanTracks()},e.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach((function(e){Object(u.clearCurrentCues)(t[e]),delete t[e]})),this.nonNativeCaptionsTracks={}},e.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},e._cleanTracks=function(){var t=this.media;if(t){var e=t.textTracks;if(e)for(var r=0;r<e.length;r++)Object(u.clearCurrentCues)(e[r])}},e.onSubtitleTracksUpdated=function(t,e){var r=this;this.textTracks=[];var n=e.subtitleTracks||[],a=n.some((function(t){return t.textCodec===l.IMSC1_CODEC}));if(this.config.enableWebVTT||a&&this.config.enableIMSC1){var s=this.tracks&&n&&this.tracks.length===n.length;if(this.tracks=n||[],this.config.renderTextTracksNatively){var o=this.media?this.media.textTracks:[];this.tracks.forEach((function(t,e){var n;if(e<o.length){for(var i=null,a=0;a<o.length;a++)if(h(o[a],t)){i=o[a];break}i&&(n=i)}n?Object(u.clearCurrentCues)(n):(n=r.createTextTrack("subtitles",t.name,t.lang))&&(n.mode="disabled"),n&&(n.groupId=t.groupId,r.textTracks.push(n))}))}else if(!s&&this.tracks&&this.tracks.length){var c=this.tracks.map((function(t){return{label:t.name,kind:t.type.toLowerCase(),default:t.default,subtitleTrack:t}}));this.hls.trigger(i.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:c})}}},e.onManifestLoaded=function(t,e){var r=this;this.config.enableCEA708Captions&&e.captions&&e.captions.forEach((function(t){var e=/(?:CC|SERVICE)([1-4])/.exec(t.instreamId);if(e){var n="textTrack"+e[1],i=r.captionsProperties[n];i&&(i.label=t.name,t.lang&&(i.languageCode=t.lang),i.media=t)}}))},e.onFragLoading=function(t,e){var r=this.cea608Parser1,n=this.cea608Parser2,i=this.lastSn;if(this.enabled&&r&&n&&e.frag.type===c.PlaylistLevelType.MAIN){var a=e.frag.sn;a!==i+1&&(r.reset(),n.reset()),this.lastSn=a}},e.onFragLoaded=function(t,e){var r=e.frag,a=e.payload,s=this.initPTS,o=this.unparsedVttFrags;if(r.type===c.PlaylistLevelType.SUBTITLE)if(a.byteLength){if(!Object(n.isFiniteNumber)(s[r.cc]))return o.push(e),void(s.length&&this.hls.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Missing initial subtitle PTS")}));var u=r.decryptdata;if(null==u||null==u.key||"AES-128"!==u.method){var d=this.tracks[r.level],f=this.vttCCs;f[r.cc]||(f[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),d&&d.textCodec===l.IMSC1_CODEC?this._parseIMSC1(r,a):this._parseVTTs(r,a,f)}}else this.hls.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})},e._parseIMSC1=function(t,e){var r=this,n=this.hls;Object(l.parseIMSC1)(e,this.initPTS[t.cc],this.timescale[t.cc],(function(e){r._appendCues(e,t.level),n.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})}),(function(e){d.logger.log("Failed to parse IMSC1: "+e),n.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:e})}))},e._parseVTTs=function(t,e,r){var n=this,a=this.hls;Object(o.parseWebVTT)(e,this.initPTS[t.cc],this.timescale[t.cc],r,t.cc,t.start,(function(e){n._appendCues(e,t.level),a.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})}),(function(r){n._fallbackToIMSC1(t,e),d.logger.log("Failed to parse VTT cue: "+r),a.trigger(i.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:r})}))},e._fallbackToIMSC1=function(t,e){var r=this,n=this.tracks[t.level];n.textCodec||Object(l.parseIMSC1)(e,this.initPTS[t.cc],this.timescale[t.cc],(function(){n.textCodec=l.IMSC1_CODEC,r._parseIMSC1(t,e)}),(function(){n.textCodec="wvtt"}))},e._appendCues=function(t,e){var r=this.hls;if(this.config.renderTextTracksNatively){var n=this.textTracks[e];if("disabled"===n.mode)return;t.forEach((function(t){return Object(u.addCueToTrack)(n,t)}))}else{var a=this.tracks[e].default?"default":"subtitles"+e;r.trigger(i.Events.CUES_PARSED,{type:"subtitles",cues:t,track:a})}},e.onFragDecrypted=function(t,e){var r=e.frag;if(r.type===c.PlaylistLevelType.SUBTITLE){if(!Object(n.isFiniteNumber)(this.initPTS[r.cc]))return void this.unparsedVttFrags.push(e);this.onFragLoaded(i.Events.FRAG_LOADED,e)}},e.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},e.onFragParsingUserdata=function(t,e){var r=this.cea608Parser1,n=this.cea608Parser2;if(this.enabled&&r&&n)for(var i=0;i<e.samples.length;i++){var a=e.samples[i].bytes;if(a){var s=this.extractCea608Data(a);r.addData(e.samples[i].pts,s[0]),n.addData(e.samples[i].pts,s[1])}}},e.onBufferFlushing=function(t,e){var r=e.startOffset,n=e.endOffset,i=e.type;if(!i||"video"===i){var a=this.media;if(!a||a.currentTime<n)return;var s=this.captionsTracks;Object.keys(s).forEach((function(t){return Object(u.removeCuesInRange)(s[t],r,n)}))}},e.extractCea608Data=function(t){for(var e=31&t[0],r=2,n=[[],[]],i=0;i<e;i++){var a=t[r++],s=127&t[r++],o=127&t[r++],u=3&a;0===s&&0===o||0!==(4&a)&&(0!==u&&1!==u||(n[u].push(s),n[u].push(o)))}return n},t}();function h(t,e){return t&&t.label===e.name&&!(t.textTrack1||t.textTrack2)}},"./src/crypt/aes-crypto.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return n}));var n=function(){function t(t,e){this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=e}return t.prototype.decrypt=function(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)},t}()},"./src/crypt/aes-decryptor.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"removePadding",(function(){return i})),r.d(e,"default",(function(){return a}));var n=r("./src/utils/typed-array.ts");function i(t){var e=t.byteLength,r=e&&new DataView(t.buffer).getUint8(e-1);return r?Object(n.sliceUint8)(t,0,e-r):t}var a=function(){function t(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var e=t.prototype;return e.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),r=new Uint32Array(4),n=0;n<4;n++)r[n]=e.getUint32(4*n);return r},e.initTable=function(){var t=this.sBox,e=this.invSBox,r=this.subMix,n=r[0],i=r[1],a=r[2],s=r[3],o=this.invSubMix,u=o[0],l=o[1],c=o[2],d=o[3],f=new Uint32Array(256),h=0,p=0,g=0;for(g=0;g<256;g++)f[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var m=p^p<<1^p<<2^p<<3^p<<4;m=m>>>8^255&m^99,t[h]=m,e[m]=h;var v=f[h],y=f[v],b=f[y],E=257*f[m]^16843008*m;n[h]=E<<24|E>>>8,i[h]=E<<16|E>>>16,a[h]=E<<8|E>>>24,s[h]=E,E=16843009*b^65537*y^257*v^16843008*h,u[m]=E<<24|E>>>8,l[m]=E<<16|E>>>16,c[m]=E<<8|E>>>24,d[m]=E,h?(h=v^f[f[f[b^v]]],p^=f[f[p]]):h=p=1}},e.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),r=!0,n=0;n<e.length&&r;)r=e[n]===this.key[n],n++;if(!r){this.key=e;var i=this.keySize=e.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a,s,o,u,l=this.ksRows=4*(i+6+1),c=this.keySchedule=new Uint32Array(l),d=this.invKeySchedule=new Uint32Array(l),f=this.sBox,h=this.rcon,p=this.invSubMix,g=p[0],m=p[1],v=p[2],y=p[3];for(a=0;a<l;a++)a<i?o=c[a]=e[a]:(u=o,a%i===0?(u=f[(u=u<<8|u>>>24)>>>24]<<24|f[u>>>16&255]<<16|f[u>>>8&255]<<8|f[255&u],u^=h[a/i|0]<<24):i>6&&a%i===4&&(u=f[u>>>24]<<24|f[u>>>16&255]<<16|f[u>>>8&255]<<8|f[255&u]),c[a]=o=(c[a-i]^u)>>>0);for(s=0;s<l;s++)a=l-s,u=3&s?c[a]:c[a-4],d[s]=s<4||a<=4?u:g[f[u>>>24]]^m[f[u>>>16&255]]^v[f[u>>>8&255]]^y[f[255&u]],d[s]=d[s]>>>0}},e.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},e.decrypt=function(t,e,r){for(var n,i,a,s,o,u,l,c,d,f,h,p,g,m,v=this.keySize+6,y=this.invKeySchedule,b=this.invSBox,E=this.invSubMix,T=E[0],S=E[1],w=E[2],_=E[3],k=this.uint8ArrayToUint32Array_(r),A=k[0],L=k[1],D=k[2],R=k[3],C=new Int32Array(t),I=new Int32Array(C.length),x=this.networkToHostOrderSwap;e<C.length;){for(d=x(C[e]),f=x(C[e+1]),h=x(C[e+2]),p=x(C[e+3]),o=d^y[0],u=p^y[1],l=h^y[2],c=f^y[3],g=4,m=1;m<v;m++)n=T[o>>>24]^S[u>>16&255]^w[l>>8&255]^_[255&c]^y[g],i=T[u>>>24]^S[l>>16&255]^w[c>>8&255]^_[255&o]^y[g+1],a=T[l>>>24]^S[c>>16&255]^w[o>>8&255]^_[255&u]^y[g+2],s=T[c>>>24]^S[o>>16&255]^w[u>>8&255]^_[255&l]^y[g+3],o=n,u=i,l=a,c=s,g+=4;n=b[o>>>24]<<24^b[u>>16&255]<<16^b[l>>8&255]<<8^b[255&c]^y[g],i=b[u>>>24]<<24^b[l>>16&255]<<16^b[c>>8&255]<<8^b[255&o]^y[g+1],a=b[l>>>24]<<24^b[c>>16&255]<<16^b[o>>8&255]<<8^b[255&u]^y[g+2],s=b[c>>>24]<<24^b[o>>16&255]<<16^b[u>>8&255]<<8^b[255&l]^y[g+3],I[e]=x(n^A),I[e+1]=x(s^L),I[e+2]=x(a^D),I[e+3]=x(i^R),A=d,L=f,D=h,R=p,e+=4}return I.buffer},t}()},"./src/crypt/decrypter.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return l}));var n=r("./src/crypt/aes-crypto.ts"),i=r("./src/crypt/fast-aes-key.ts"),a=r("./src/crypt/aes-decryptor.ts"),s=r("./src/utils/logger.ts"),o=r("./src/utils/mp4-tools.ts"),u=r("./src/utils/typed-array.ts"),l=function(){function t(t,e,r){var n=(void 0===r?{}:r).removePKCS7Padding,i=void 0===n||n;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=t,this.config=e,this.removePKCS7Padding=i,i)try{var a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(s){}null===this.subtle&&(this.config.enableSoftwareAES=!0)}var e=t.prototype;return e.destroy=function(){this.observer=null},e.isSync=function(){return this.config.enableSoftwareAES},e.flush=function(){var t=this.currentResult;if(t){var e=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?Object(a.removePadding)(e):e}this.reset()},e.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},e.decrypt=function(t,e,r,n){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(t),e,r);var i=this.flush();i&&n(i.buffer)}else this.webCryptoDecrypt(new Uint8Array(t),e,r).then(n)},e.softwareDecrypt=function(t,e,r){var n=this.currentIV,i=this.currentResult,s=this.remainderData;this.logOnce("JS AES decrypt"),s&&(t=Object(o.appendUint8Array)(s,t),this.remainderData=null);var l=this.getValidChunk(t);if(!l.length)return null;n&&(r=n);var c=this.softwareDecrypter;c||(c=this.softwareDecrypter=new a.default),c.expandKey(e);var d=i;return this.currentResult=c.decrypt(l.buffer,0,r),this.currentIV=Object(u.sliceUint8)(l,-16).buffer,d||null},e.webCryptoDecrypt=function(t,e,r){var a=this,s=this.subtle;return this.key===e&&this.fastAesKey||(this.key=e,this.fastAesKey=new i.default(s,e)),this.fastAesKey.expandKey().then((function(e){return s?new n.default(s,r).decrypt(t.buffer,e):Promise.reject(new Error("web crypto not initialized"))})).catch((function(n){return a.onWebCryptoError(n,t,e,r)}))},e.onWebCryptoError=function(t,e,r,n){return s.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",t),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(e,r,n)},e.getValidChunk=function(t){var e=t,r=t.length-t.length%16;return r!==t.length&&(e=Object(u.sliceUint8)(t,0,r),this.remainderData=Object(u.sliceUint8)(t,r)),e},e.logOnce=function(t){this.logEnabled&&(s.logger.log("[decrypter.ts]: "+t),this.logEnabled=!1)},t}()},"./src/crypt/fast-aes-key.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return n}));var n=function(){function t(t,e){this.subtle=void 0,this.key=void 0,this.subtle=t,this.key=e}return t.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},t}()},"./src/demux/aacdemuxer.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/demux/base-audio-demuxer.ts"),i=r("./src/demux/adts.ts"),a=r("./src/utils/logger.ts"),s=r("./src/demux/id3.ts");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u=function(t){var e,r;function n(e,r){var n;return(n=t.call(this)||this).observer=void 0,n.config=void 0,n.observer=e,n.config=r,n}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,o(e,r);var u=n.prototype;return u.resetInitSegment=function(e,r,n){t.prototype.resetInitSegment.call(this,e,r,n),this._audioTrack={container:"audio/adts",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}},n.probe=function(t){if(!t)return!1;for(var e=(s.getID3Data(t,0)||[]).length,r=t.length;e<r;e++)if(i.probe(t,e))return a.logger.log("ADTS sync word found !"),!0;return!1},u.canParse=function(t,e){return i.canParse(t,e)},u.appendFrame=function(t,e,r){return i.initTrackConfig(t,this.observer,e,r,t.manifestCodec),i.appendFrame(t,e,r,this.initPTS,this.frameIndex)},n}(n.default);u.minProbeByteLength=9,e.default=u},"./src/demux/adts.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"getAudioConfig",(function(){return s})),r.d(e,"isHeaderPattern",(function(){return o})),r.d(e,"getHeaderLength",(function(){return u})),r.d(e,"getFullFrameLength",(function(){return l})),r.d(e,"canGetFrameLength",(function(){return c})),r.d(e,"isHeader",(function(){return d})),r.d(e,"canParse",(function(){return f})),r.d(e,"probe",(function(){return h})),r.d(e,"initTrackConfig",(function(){return p})),r.d(e,"getFrameDuration",(function(){return g})),r.d(e,"parseFrameHeader",(function(){return m})),r.d(e,"appendFrame",(function(){return v}));var n=r("./src/utils/logger.ts"),i=r("./src/errors.ts"),a=r("./src/events.ts");function s(t,e,r,s){var o,u,l,c,d=navigator.userAgent.toLowerCase(),f=s,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];o=1+((192&e[r+2])>>>6);var p=(60&e[r+2])>>>2;if(!(p>h.length-1))return l=(1&e[r+2])<<2,l|=(192&e[r+3])>>>6,n.logger.log("manifest codec:"+s+", ADTS type:"+o+", samplingIndex:"+p),/firefox/i.test(d)?p>=6?(o=5,c=new Array(4),u=p-3):(o=2,c=new Array(2),u=p):-1!==d.indexOf("android")?(o=2,c=new Array(2),u=p):(o=5,c=new Array(4),s&&(-1!==s.indexOf("mp4a.40.29")||-1!==s.indexOf("mp4a.40.5"))||!s&&p>=6?u=p-3:((s&&-1!==s.indexOf("mp4a.40.2")&&(p>=6&&1===l||/vivaldi/i.test(d))||!s&&1===l)&&(o=2,c=new Array(2)),u=p)),c[0]=o<<3,c[0]|=(14&p)>>1,c[1]|=(1&p)<<7,c[1]|=l<<3,5===o&&(c[1]|=(14&u)>>1,c[2]=(1&u)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:h[p],channelCount:l,codec:"mp4a.40."+o,manifestCodec:f};t.trigger(a.Events.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+p})}function o(t,e){return 255===t[e]&&240===(246&t[e+1])}function u(t,e){return 1&t[e+1]?7:9}function l(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function c(t,e){return e+5<t.length}function d(t,e){return e+1<t.length&&o(t,e)}function f(t,e){return c(t,e)&&o(t,e)&&l(t,e)<=t.length-e}function h(t,e){if(d(t,e)){var r=u(t,e);if(e+r>=t.length)return!1;var n=l(t,e);if(n<=r)return!1;var i=e+n;return i===t.length||d(t,i)}return!1}function p(t,e,r,i,a){if(!t.samplerate){var o=s(e,r,i,a);if(!o)return;t.config=o.config,t.samplerate=o.samplerate,t.channelCount=o.channelCount,t.codec=o.codec,t.manifestCodec=o.manifestCodec,n.logger.log("parsed codec:"+t.codec+", rate:"+o.samplerate+", channels:"+o.channelCount)}}function g(t){return 9216e4/t}function m(t,e,r,n,i){var a=t.length,s=u(t,e),o=l(t,e);if((o-=s)>0&&e+s+o<=a)return{headerLength:s,frameLength:o,stamp:r+n*i}}function v(t,e,r,n,i){var a=m(e,r,n,i,g(t.samplerate));if(a){var s=a.stamp,o=a.headerLength,u=a.frameLength,l={unit:e.subarray(r+o,r+o+u),pts:s,dts:s};return t.samples.push(l),{sample:l,length:u+o}}}},"./src/demux/base-audio-demuxer.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"initPTSFn",(function(){return l}));var n=r("./src/polyfills/number.ts"),i=r("./src/demux/id3.ts"),a=r("./src/demux/dummy-demuxed-track.ts"),s=r("./src/utils/mp4-tools.ts"),o=r("./src/utils/typed-array.ts"),u=function(){function t(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var e=t.prototype;return e.resetInitSegment=function(t,e,r){this._id3Track={type:"id3",id:0,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},e.resetTimeStamp=function(){},e.resetContiguity=function(){},e.canParse=function(t,e){return!1},e.appendFrame=function(t,e,r){},e.demux=function(t,e){this.cachedData&&(t=Object(s.appendUint8Array)(this.cachedData,t),this.cachedData=null);var r,n,u=i.getID3Data(t,0),c=u?u.length:0,d=this._audioTrack,f=this._id3Track,h=u?i.getTimeStamp(u):void 0,p=t.length;for(0!==this.frameIndex&&null!==this.initPTS||(this.initPTS=l(h,e)),u&&u.length>0&&f.samples.push({pts:this.initPTS,dts:this.initPTS,data:u}),n=this.initPTS;c<p;){if(this.canParse(t,c)){var g=this.appendFrame(d,t,c);g?(this.frameIndex++,n=g.sample.pts,r=c+=g.length):c=p}else i.canParse(t,c)?(u=i.getID3Data(t,c),f.samples.push({pts:n,dts:n,data:u}),r=c+=u.length):c++;if(c===p&&r!==p){var m=Object(o.sliceUint8)(t,r);this.cachedData?this.cachedData=Object(s.appendUint8Array)(this.cachedData,m):this.cachedData=m}}return{audioTrack:d,avcTrack:Object(a.dummyTrack)(),id3Track:f,textTrack:Object(a.dummyTrack)()}},e.demuxSampleAes=function(t,e,r){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},e.flush=function(t){var e=this.cachedData;return e&&(this.cachedData=null,this.demux(e,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(a.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(a.dummyTrack)()}},e.destroy=function(){},t}(),l=function(t,e){return Object(n.isFiniteNumber)(t)?90*t:9e4*e};e.default=u},"./src/demux/chunk-cache.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return n}));var n=function(){function t(){this.chunks=[],this.dataLength=0}var e=t.prototype;return e.push=function(t){this.chunks.push(t),this.dataLength+=t.length},e.flush=function(){var t,e=this.chunks,r=this.dataLength;return e.length?(t=1===e.length?e[0]:function(t,e){for(var r=new Uint8Array(e),n=0,i=0;i<t.length;i++){var a=t[i];r.set(a,n),n+=a.length}return r}(e,r),this.reset(),t):new Uint8Array(0)},e.reset=function(){this.chunks.length=0,this.dataLength=0},t}()},"./src/demux/dummy-demuxed-track.ts":function(t,e,r){"use strict";function n(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}r.r(e),r.d(e,"dummyTrack",(function(){return n}))},"./src/demux/exp-golomb.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/utils/logger.ts"),i=function(){function t(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}var e=t.prototype;return e.loadWord=function(){var t=this.data,e=this.bytesAvailable,r=t.byteLength-e,n=new Uint8Array(4),i=Math.min(4,e);if(0===i)throw new Error("no bytes available");n.set(t.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},e.skipBits=function(t){var e;this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,t-=(e=t>>3)>>3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)},e.readBits=function(t){var e=Math.min(this.bitsAvailable,t),r=this.word>>>32-e;return t>32&&n.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0?this.word<<=e:this.bytesAvailable>0&&this.loadWord(),(e=t-e)>0&&this.bitsAvailable?r<<e|this.readBits(e):r},e.skipLZ=function(){var t;for(t=0;t<this.bitsAvailable;++t)if(0!==(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()},e.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.skipEG=function(){this.skipBits(1+this.skipLZ())},e.readUEG=function(){var t=this.skipLZ();return this.readBits(t+1)-1},e.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)},e.readBoolean=function(){return 1===this.readBits(1)},e.readUByte=function(){return this.readBits(8)},e.readUShort=function(){return this.readBits(16)},e.readUInt=function(){return this.readBits(32)},e.skipScalingList=function(t){for(var e=8,r=8,n=0;n<t;n++)0!==r&&(r=(e+this.readEG()+256)%256),e=0===r?e:r},e.readSPS=function(){var t,e,r,n=0,i=0,a=0,s=0,o=this.readUByte.bind(this),u=this.readBits.bind(this),l=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),f=this.skipEG.bind(this),h=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);o();var g=o();if(u(5),d(3),o(),h(),100===g||110===g||122===g||244===g||44===g||83===g||86===g||118===g||128===g){var m=l();if(3===m&&d(1),h(),h(),d(1),c())for(e=3!==m?8:12,r=0;r<e;r++)c()&&p(r<6?16:64)}h();var v=l();if(0===v)l();else if(1===v)for(d(1),f(),f(),t=l(),r=0;r<t;r++)f();h(),d(1);var y=l(),b=l(),E=u(1);0===E&&d(1),d(1),c()&&(n=l(),i=l(),a=l(),s=l());var T=[1,1];if(c()&&c())switch(o()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[o()<<8|o(),o()<<8|o()]}return{width:Math.ceil(16*(y+1)-2*n-2*i),height:(2-E)*(b+1)*16-(E?2:4)*(a+s),pixelRatio:T}},e.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}();e.default=i},"./src/demux/id3.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"isHeader",(function(){return i})),r.d(e,"isFooter",(function(){return a})),r.d(e,"getID3Data",(function(){return s})),r.d(e,"canParse",(function(){return u})),r.d(e,"getTimeStamp",(function(){return l})),r.d(e,"isTimeStampFrame",(function(){return c})),r.d(e,"getID3Frames",(function(){return f})),r.d(e,"decodeFrame",(function(){return h})),r.d(e,"utf8ArrayToStr",(function(){return y})),r.d(e,"testables",(function(){return b}));var n,i=function(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},a=function(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},s=function(t,e){for(var r=e,n=0;i(t,e);)n+=10,n+=o(t,e+6),a(t,e+10)&&(n+=10),e+=n;if(n>0)return t.subarray(r,r+n)},o=function(t,e){var r=0;return r=(127&t[e])<<21,r|=(127&t[e+1])<<14,r|=(127&t[e+2])<<7,r|=127&t[e+3]},u=function(t,e){return i(t,e)&&o(t,e+6)+10<=t.length-e},l=function(t){for(var e=f(t),r=0;r<e.length;r++){var n=e[r];if(c(n))return v(n)}},c=function(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info},d=function(t){var e=String.fromCharCode(t[0],t[1],t[2],t[3]),r=o(t,4);return{type:e,size:r,data:t.subarray(10,10+r)}},f=function(t){for(var e=0,r=[];i(t,e);){for(var n=o(t,e+6),s=(e+=10)+n;e+8<s;){var u=d(t.subarray(e)),l=h(u);l&&r.push(l),e+=u.size+10}a(t,e)&&(e+=10)}return r},h=function(t){return"PRIV"===t.type?p(t):"W"===t.type[0]?m(t):g(t)},p=function(t){if(!(t.size<2)){var e=y(t.data,!0),r=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:r.buffer}}},g=function(t){if(!(t.size<2)){if("TXXX"===t.type){var e=1,r=y(t.data.subarray(e),!0);e+=r.length+1;var n=y(t.data.subarray(e));return{key:t.type,info:r,data:n}}var i=y(t.data.subarray(1));return{key:t.type,data:i}}},m=function(t){if("WXXX"===t.type){if(t.size<2)return;var e=1,r=y(t.data.subarray(e),!0);e+=r.length+1;var n=y(t.data.subarray(e));return{key:t.type,info:r,data:n}}var i=y(t.data);return{key:t.type,data:i}},v=function(t){if(8===t.data.byteLength){var e=new Uint8Array(t.data),r=1&e[3],n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}},y=function(t,e){void 0===e&&(e=!1);var r=E();if(r){var n=r.decode(t);if(e){var i=n.indexOf("\0");return-1!==i?n.substring(0,i):n}return n.replace(/\0/g,"")}for(var a,s,o,u=t.length,l="",c=0;c<u;){if(0===(a=t[c++])&&e)return l;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(a);break;case 12:case 13:s=t[c++],l+=String.fromCharCode((31&a)<<6|63&s);break;case 14:s=t[c++],o=t[c++],l+=String.fromCharCode((15&a)<<12|(63&s)<<6|(63&o)<<0)}}return l},b={decodeTextFrame:g};function E(){return n||"undefined"===typeof self.TextDecoder||(n=new self.TextDecoder("utf-8")),n}},"./src/demux/mp3demuxer.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/demux/base-audio-demuxer.ts"),i=r("./src/demux/id3.ts"),a=r("./src/utils/logger.ts"),s=r("./src/demux/mpegaudio.ts");function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u=function(t){var e,r;function n(){return t.apply(this,arguments)||this}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,o(e,r);var u=n.prototype;return u.resetInitSegment=function(e,r,n){t.prototype.resetInitSegment.call(this,e,r,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:e,duration:n,inputTimeScale:9e4,dropped:0}},n.probe=function(t){if(!t)return!1;for(var e=(i.getID3Data(t,0)||[]).length,r=t.length;e<r;e++)if(s.probe(t,e))return a.logger.log("MPEG Audio sync word found !"),!0;return!1},u.canParse=function(t,e){return s.canParse(t,e)},u.appendFrame=function(t,e,r){if(null!==this.initPTS)return s.appendFrame(t,e,r,this.initPTS,this.frameIndex)},n}(n.default);u.minProbeByteLength=4,e.default=u},"./src/demux/mp4demuxer.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/utils/mp4-tools.ts"),i=r("./src/demux/dummy-demuxed-track.ts"),a=function(){function t(t,e){this.remainderData=null,this.config=void 0,this.config=e}var e=t.prototype;return e.resetTimeStamp=function(){},e.resetInitSegment=function(){},e.resetContiguity=function(){},t.probe=function(t){return Object(n.findBox)({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.demux=function(t){var e=t,r=Object(i.dummyTrack)();if(this.config.progressive){this.remainderData&&(e=Object(n.appendUint8Array)(this.remainderData,t));var a=Object(n.segmentValidRange)(e);this.remainderData=a.remainder,r.samples=a.valid||new Uint8Array}else r.samples=e;return{audioTrack:Object(i.dummyTrack)(),avcTrack:r,id3Track:Object(i.dummyTrack)(),textTrack:Object(i.dummyTrack)()}},e.flush=function(){var t=Object(i.dummyTrack)();return t.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(i.dummyTrack)(),avcTrack:t,id3Track:Object(i.dummyTrack)(),textTrack:Object(i.dummyTrack)()}},e.demuxSampleAes=function(t,e,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},e.destroy=function(){},t}();a.minProbeByteLength=1024,e.default=a},"./src/demux/mpegaudio.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"appendFrame",(function(){return u})),r.d(e,"parseHeader",(function(){return l})),r.d(e,"isHeaderPattern",(function(){return c})),r.d(e,"isHeader",(function(){return d})),r.d(e,"canParse",(function(){return f})),r.d(e,"probe",(function(){return h}));var n=null,i=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],a=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],s=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],o=[0,1,1,4];function u(t,e,r,n,i){if(!(r+24>e.length)){var a=l(e,r);if(a&&r+a.frameLength<=e.length){var s=n+i*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:e.subarray(r,r+a.frameLength),pts:s,dts:s};return t.config=[],t.channelCount=a.channelCount,t.samplerate=a.sampleRate,t.samples.push(o),{sample:o,length:a.frameLength}}}}function l(t,e){var r=t[e+1]>>3&3,u=t[e+1]>>1&3,l=t[e+2]>>4&15,c=t[e+2]>>2&3;if(1!==r&&0!==l&&15!==l&&3!==c){var d=t[e+2]>>1&1,f=t[e+3]>>6,h=1e3*i[14*(3===r?3-u:3===u?3:4)+l-1],p=a[3*(3===r?0:2===r?1:2)+c],g=3===f?1:2,m=s[r][u],v=o[u],y=8*m*v,b=Math.floor(m*h/p+d)*v;if(null===n){var E=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);n=E?parseInt(E[1]):0}return!!n&&n<=87&&2===u&&h>=224e3&&0===f&&(t[e+3]=128|t[e+3]),{sampleRate:p,channelCount:g,frameLength:b,samplesPerFrame:y}}}function c(t,e){return 255===t[e]&&224===(224&t[e+1])&&0!==(6&t[e+1])}function d(t,e){return e+1<t.length&&c(t,e)}function f(t,e){return c(t,e)&&4<=t.length-e}function h(t,e){if(e+1<t.length&&c(t,e)){var r=l(t,e),n=4;null!==r&&void 0!==r&&r.frameLength&&(n=r.frameLength);var i=e+n;return i===t.length||d(t,i)}return!1}},"./src/demux/sample-aes.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/crypt/decrypter.ts"),i=r("./src/demux/tsdemuxer.ts"),a=function(){function t(t,e,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new n.default(t,e,{removePKCS7Padding:!1})}var e=t.prototype;return e.decryptBuffer=function(t,e){this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer,e)},e.decryptAacSample=function(t,e,r,n){var i=t[e].unit,a=i.subarray(16,i.length-i.length%16),s=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),o=this;this.decryptBuffer(s,(function(a){var s=new Uint8Array(a);i.set(s,16),n||o.decryptAacSamples(t,e+1,r)}))},e.decryptAacSamples=function(t,e,r){for(;;e++){if(e>=t.length)return void r();if(!(t[e].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(t,e,r,n),!n)return}}},e.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,r=new Int8Array(e),n=0,i=32;i<=t.length-16;i+=160,n+=16)r.set(t.subarray(i,i+16),n);return r},e.getAvcDecryptedUnit=function(t,e){for(var r=new Uint8Array(e),n=0,i=32;i<=t.length-16;i+=160,n+=16)t.set(r.subarray(n,n+16),i);return t},e.decryptAvcSample=function(t,e,r,n,a,s){var o=Object(i.discardEPB)(a.data),u=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(u.buffer,(function(i){a.data=l.getAvcDecryptedUnit(o,i),s||l.decryptAvcSamples(t,e,r+1,n)}))},e.decryptAvcSamples=function(t,e,r,n){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;e++,r=0){if(e>=t.length)return void n();for(var i=t[e].units;!(r>=i.length);r++){var a=i[r];if(!(a.data.length<=48||1!==a.type&&5!==a.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(t,e,r,n,a,s),!s)return}}}},t}();e.default=a},"./src/demux/transmuxer-interface.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return d}));var n=r("./node_modules/webworkify-webpack/index.js"),i=r("./src/events.ts"),a=r("./src/demux/transmuxer.ts"),s=r("./src/utils/logger.ts"),o=r("./src/errors.ts"),u=r("./src/utils/mediasource-helper.ts"),l=r("./node_modules/eventemitter3/index.js"),c=Object(u.getMediaSource)()||{isTypeSupported:function(){return!1}},d=function(){function t(t,e,r,u){var d=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=t,this.id=e,this.onTransmuxComplete=r,this.onFlush=u;var f=t.config,h=function(e,r){(r=r||{}).frag=d.frag,r.id=d.id,t.trigger(e,r)};this.observer=new l.EventEmitter,this.observer.on(i.Events.FRAG_DECRYPTED,h),this.observer.on(i.Events.ERROR,h);var p={mp4:c.isTypeSupported("video/mp4"),mpeg:c.isTypeSupported("audio/mpeg"),mp3:c.isTypeSupported('audio/mp4; codecs="mp3"')},g=navigator.vendor;if(f.enableWorker&&"undefined"!==typeof Worker){var m;s.logger.log("demuxing in webworker");try{m=this.worker=n("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),m.addEventListener("message",this.onwmsg),m.onerror=function(e){t.trigger(i.Events.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(e.message+"  ("+e.filename+":"+e.lineno+")")})},m.postMessage({cmd:"init",typeSupported:p,vendor:g,id:e,config:JSON.stringify(f)})}catch(v){s.logger.warn("Error in worker:",v),s.logger.error("Error while initializing DemuxerWorker, fallback to inline"),m&&self.URL.revokeObjectURL(m.objectURL),this.transmuxer=new a.default(this.observer,p,f,g),this.worker=null}}else this.transmuxer=new a.default(this.observer,p,f,g)}var e=t.prototype;return e.destroy=function(){var t=this.worker;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.worker=null;else{var e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}var r=this.observer;r&&r.removeAllListeners(),this.observer=null},e.push=function(t,e,r,n,i,o,u,l,c,d){var f=this;c.transmuxing.start=self.performance.now();var h=this.transmuxer,p=this.worker,g=o?o.start:i.start,m=i.decryptdata,v=this.frag,y=!(v&&i.cc===v.cc),b=!(v&&c.level===v.level),E=v?c.sn-v.sn:-1,T=this.part?c.part-this.part.index:1,S=!b&&(1===E||0===E&&1===T),w=self.performance.now();(b||E||0===i.stats.parsing.start)&&(i.stats.parsing.start=w),!o||!T&&S||(o.stats.parsing.start=w);var _=new a.TransmuxState(y,S,l,b,g);if(!S||y){s.logger.log("[transmuxer-interface, "+i.type+"]: Starting new transmux session for sn: "+c.sn+" p: "+c.part+" level: "+c.level+" id: "+c.id+"\n        discontinuity: "+y+"\n        trackSwitch: "+b+"\n        contiguous: "+S+"\n        accurateTimeOffset: "+l+"\n        timeOffset: "+g);var k=new a.TransmuxConfig(r,n,e,u,d);this.configureTransmuxer(k)}if(this.frag=i,this.part=o,p)p.postMessage({cmd:"demux",data:t,decryptdata:m,chunkMeta:c,state:_},t instanceof ArrayBuffer?[t]:[]);else if(h){var A=h.push(t,m,c,_);Object(a.isPromise)(A)?A.then((function(t){f.handleTransmuxComplete(t)})):this.handleTransmuxComplete(A)}},e.flush=function(t){var e=this;t.transmuxing.start=self.performance.now();var r=this.transmuxer,n=this.worker;if(n)n.postMessage({cmd:"flush",chunkMeta:t});else if(r){var i=r.flush(t);Object(a.isPromise)(i)?i.then((function(r){e.handleFlushResult(r,t)})):this.handleFlushResult(i,t)}},e.handleFlushResult=function(t,e){var r=this;t.forEach((function(t){r.handleTransmuxComplete(t)})),this.onFlush(e)},e.onWorkerMessage=function(t){var e=t.data,r=this.hls;switch(e.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(e.data);break;case"flush":this.onFlush(e.data);break;default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,r.trigger(e.event,e.data)}},e.configureTransmuxer=function(t){var e=this.worker,r=this.transmuxer;e?e.postMessage({cmd:"configure",config:t}):r&&r.configure(t)},e.handleTransmuxComplete=function(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)},t}()},"./src/demux/transmuxer-worker.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return o}));var n=r("./src/demux/transmuxer.ts"),i=r("./src/events.ts"),a=r("./src/utils/logger.ts"),s=r("./node_modules/eventemitter3/index.js");function o(t){var e=new s.EventEmitter,r=function(e,r){t.postMessage({event:e,data:r})};e.on(i.Events.FRAG_DECRYPTED,r),e.on(i.Events.ERROR,r),t.addEventListener("message",(function(i){var s=i.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);t.transmuxer=new n.default(e,s.typeSupported,o,s.vendor),Object(a.enableLogs)(o.debug),r("init",null);break;case"configure":t.transmuxer.configure(s.config);break;case"demux":var l=t.transmuxer.push(s.data,s.decryptdata,s.chunkMeta,s.state);Object(n.isPromise)(l)?l.then((function(e){u(t,e)})):u(t,l);break;case"flush":var d=s.chunkMeta,f=t.transmuxer.flush(d);Object(n.isPromise)(f)?f.then((function(e){c(t,e,d)})):c(t,f,d)}}))}function u(t,e){if((r=e.remuxResult).audio||r.video||r.text||r.id3||r.initSegment){var r,n=[],i=e.remuxResult,a=i.audio,s=i.video;a&&l(n,a),s&&l(n,s),t.postMessage({event:"transmuxComplete",data:e},n)}}function l(t,e){e.data1&&t.push(e.data1.buffer),e.data2&&t.push(e.data2.buffer)}function c(t,e,r){e.forEach((function(e){u(t,e)})),t.postMessage({event:"flush",data:r})}},"./src/demux/transmuxer.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return y})),r.d(e,"isPromise",(function(){return E})),r.d(e,"TransmuxConfig",(function(){return T})),r.d(e,"TransmuxState",(function(){return S}));var n,i=r("./src/events.ts"),a=r("./src/errors.ts"),s=r("./src/crypt/decrypter.ts"),o=r("./src/demux/aacdemuxer.ts"),u=r("./src/demux/mp4demuxer.ts"),l=r("./src/demux/tsdemuxer.ts"),c=r("./src/demux/mp3demuxer.ts"),d=r("./src/remux/mp4-remuxer.ts"),f=r("./src/remux/passthrough-remuxer.ts"),h=r("./src/demux/chunk-cache.ts"),p=r("./src/utils/mp4-tools.ts"),g=r("./src/utils/logger.ts");try{n=self.performance.now.bind(self.performance)}catch(w){g.logger.debug("Unable to use Performance API on this environment"),n=self.Date.now}var m=[{demux:l.default,remux:d.default},{demux:u.default,remux:f.default},{demux:o.default,remux:d.default},{demux:c.default,remux:d.default}],v=1024;m.forEach((function(t){var e=t.demux;v=Math.max(v,e.minProbeByteLength)}));var y=function(){function t(t,e,r,n){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new h.default,this.observer=t,this.typeSupported=e,this.config=r,this.vendor=n}var e=t.prototype;return e.configure=function(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()},e.push=function(t,e,r,i){var a=this,s=r.transmuxing;s.executeStart=n();var o=new Uint8Array(t),u=this.cache,l=this.config,c=this.currentTransmuxState,d=this.transmuxConfig;i&&(this.currentTransmuxState=i);var f=function(t,e){var r=null;return t.byteLength>0&&null!=e&&null!=e.key&&null!==e.iv&&null!=e.method&&(r=e),r}(o,e);if(f&&"AES-128"===f.method){var h=this.getDecrypter();if(!l.enableSoftwareAES)return this.decryptionPromise=h.webCryptoDecrypt(o,f.key.buffer,f.iv.buffer).then((function(t){var e=a.push(t,null,r);return a.decryptionPromise=null,e})),this.decryptionPromise;var g=h.softwareDecrypt(o,f.key.buffer,f.iv.buffer);if(!g)return s.executeEnd=n(),b(r);o=new Uint8Array(g)}var m=i||c,v=m.contiguous,y=m.discontinuity,E=m.trackSwitch,T=m.accurateTimeOffset,S=m.timeOffset,w=d.audioCodec,_=d.videoCodec,k=d.defaultInitPts,A=d.duration,L=d.initSegmentData;if((y||E)&&this.resetInitSegment(L,w,_,A),y&&this.resetInitialTimestamp(k),v||this.resetContiguity(),this.needsProbing(o,y,E)){if(u.dataLength){var D=u.flush();o=Object(p.appendUint8Array)(D,o)}this.configureTransmuxer(o,d)}var R=this.transmux(o,f,S,T,r),C=this.currentTransmuxState;return C.contiguous=!0,C.discontinuity=!1,C.trackSwitch=!1,s.executeEnd=n(),R},e.flush=function(t){var e=this,r=t.transmuxing;r.executeStart=n();var s=this.decrypter,o=this.cache,u=this.currentTransmuxState,l=this.decryptionPromise;if(l)return l.then((function(){return e.flush(t)}));var c=[],d=u.timeOffset;if(s){var f=s.flush();f&&c.push(this.push(f,null,t))}var h=o.dataLength;o.reset();var p=this.demuxer,g=this.remuxer;if(!p||!g)return h>=v&&this.observer.emit(i.Events.ERROR,i.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),r.executeEnd=n(),[b(t)];var m=p.flush(d);return E(m)?m.then((function(r){return e.flushRemux(c,r,t),c})):(this.flushRemux(c,m,t),c)},e.flushRemux=function(t,e,r){var i=e.audioTrack,a=e.avcTrack,s=e.id3Track,o=e.textTrack,u=this.currentTransmuxState,l=u.accurateTimeOffset,c=u.timeOffset;g.logger.log("[transmuxer.ts]: Flushed fragment "+r.sn+(r.part>-1?" p: "+r.part:"")+" of level "+r.level);var d=this.remuxer.remux(i,a,s,o,c,l,!0);t.push({remuxResult:d,chunkMeta:r}),r.transmuxing.executeEnd=n()},e.resetInitialTimestamp=function(t){var e=this.demuxer,r=this.remuxer;e&&r&&(e.resetTimeStamp(t),r.resetTimeStamp(t))},e.resetContiguity=function(){var t=this.demuxer,e=this.remuxer;t&&e&&(t.resetContiguity(),e.resetNextTimestamp())},e.resetInitSegment=function(t,e,r,n){var i=this.demuxer,a=this.remuxer;i&&a&&(i.resetInitSegment(e,r,n),a.resetInitSegment(t,e,r))},e.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},e.transmux=function(t,e,r,n,i){return e&&"SAMPLE-AES"===e.method?this.transmuxSampleAes(t,e,r,n,i):this.transmuxUnencrypted(t,r,n,i)},e.transmuxUnencrypted=function(t,e,r,n){var i=this.demuxer.demux(t,e,!1),a=i.audioTrack,s=i.avcTrack,o=i.id3Track,u=i.textTrack;return{remuxResult:this.remuxer.remux(a,s,o,u,e,r,!1),chunkMeta:n}},e.transmuxSampleAes=function(t,e,r,n,i){var a=this;return this.demuxer.demuxSampleAes(t,e,r).then((function(t){return{remuxResult:a.remuxer.remux(t.audioTrack,t.avcTrack,t.id3Track,t.textTrack,r,n,!1),chunkMeta:i}}))},e.configureTransmuxer=function(t,e){for(var r,n=this.config,i=this.observer,a=this.typeSupported,s=this.vendor,o=e.audioCodec,l=e.defaultInitPts,c=e.duration,d=e.initSegmentData,h=e.videoCodec,p=0,v=m.length;p<v;p++)if(m[p].demux.probe(t)){r=m[p];break}r||(g.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),r={demux:u.default,remux:f.default});var y=this.demuxer,b=this.remuxer,E=r.remux,T=r.demux;b&&b instanceof E||(this.remuxer=new E(i,n,a,s)),y&&y instanceof T||(this.demuxer=new T(i,n,a),this.probe=T.probe),this.resetInitSegment(d,o,h,c),this.resetInitialTimestamp(l)},e.needsProbing=function(t,e,r){return!this.demuxer||!this.remuxer||e||r},e.getDecrypter=function(){var t=this.decrypter;return t||(t=this.decrypter=new s.default(this.observer,this.config)),t},t}(),b=function(t){return{remuxResult:{},chunkMeta:t}};function E(t){return"then"in t&&t.then instanceof Function}var T=function(t,e,r,n,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=e,this.initSegmentData=r,this.duration=n,this.defaultInitPts=i},S=function(t,e,r,n,i){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.discontinuity=t,this.contiguous=e,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=i}},"./src/demux/tsdemuxer.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"discardEPB",(function(){return E}));var n=r("./src/demux/adts.ts"),i=r("./src/demux/mpegaudio.ts"),a=r("./src/demux/exp-golomb.ts"),s=r("./src/demux/id3.ts"),o=r("./src/demux/sample-aes.ts"),u=r("./src/events.ts"),l=r("./src/utils/mp4-tools.ts"),c=r("./src/utils/logger.ts"),d=r("./src/errors.ts"),f={video:1,audio:2,id3:3,text:4},h=function(){function t(t,e,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=t,this.config=e,this.typeSupported=r}t.probe=function(e){var r=t.syncOffset(e);return!(r<0)&&(r&&c.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),!0)},t.syncOffset=function(t){for(var e=Math.min(1e3,t.length-564),r=0;r<e;){if(71===t[r]&&71===t[r+188]&&71===t[r+376])return r;r++}return-1},t.createTrack=function(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:f[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===t?e:void 0}};var e=t.prototype;return e.resetInitSegment=function(e,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=t.createTrack("video",n),this._audioTrack=t.createTrack("audio",n),this._id3Track=t.createTrack("id3",n),this._txtTrack=t.createTrack("text",n),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=e,this.videoCodec=r,this._duration=n},e.resetTimeStamp=function(){},e.resetContiguity=function(){var t=this._audioTrack,e=this._avcTrack,r=this._id3Track;t&&(t.pesData=null),e&&(e.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},e.demux=function(e,r,n,i){var a;void 0===n&&(n=!1),void 0===i&&(i=!1),n||(this.sampleAes=null);var s=this._avcTrack,o=this._audioTrack,f=this._id3Track,h=s.pid,p=s.pesData,y=o.pid,b=f.pid,E=o.pesData,T=f.pesData,S=!1,w=this.pmtParsed,_=this._pmtId,k=e.length;if(this.remainderData&&(k=(e=Object(l.appendUint8Array)(this.remainderData,e)).length,this.remainderData=null),k<188&&!i)return this.remainderData=e,{audioTrack:o,avcTrack:s,id3Track:f,textTrack:this._txtTrack};var A=Math.max(0,t.syncOffset(e));(k-=(k+A)%188)<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,k,e.buffer.byteLength-k));for(var L=A;L<k;L+=188)if(71===e[L]){var D=!!(64&e[L+1]),R=((31&e[L+1])<<8)+e[L+2],C=void 0;if((48&e[L+3])>>4>1){if((C=L+5+e[L+4])===L+188)continue}else C=L+4;switch(R){case h:D&&(p&&(a=v(p))&&this.parseAVCPES(a,!1),p={data:[],size:0}),p&&(p.data.push(e.subarray(C,L+188)),p.size+=L+188-C);break;case y:D&&(E&&(a=v(E))&&(o.isAAC?this.parseAACPES(a):this.parseMPEGPES(a)),E={data:[],size:0}),E&&(E.data.push(e.subarray(C,L+188)),E.size+=L+188-C);break;case b:D&&(T&&(a=v(T))&&this.parseID3PES(a),T={data:[],size:0}),T&&(T.data.push(e.subarray(C,L+188)),T.size+=L+188-C);break;case 0:D&&(C+=e[C]+1),_=this._pmtId=g(e,C);break;case _:D&&(C+=e[C]+1);var I=m(e,C,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,n);(h=I.avc)>0&&(s.pid=h),(y=I.audio)>0&&(o.pid=y,o.isAAC=I.isAAC),(b=I.id3)>0&&(f.pid=b),S&&!w&&(c.logger.log("reparse from beginning"),S=!1,L=A-188),w=this.pmtParsed=!0;break;case 17:case 8191:break;default:S=!0}}else this.observer.emit(u.Events.ERROR,u.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});s.pesData=p,o.pesData=E,f.pesData=T;var x={audioTrack:o,avcTrack:s,id3Track:f,textTrack:this._txtTrack};return this.extractRemainingSamples(x),x},e.flush=function(){var t,e=this.remainderData;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t},e.extractRemainingSamples=function(t){var e,r=t.audioTrack,n=t.avcTrack,i=t.id3Track,a=n.pesData,s=r.pesData,o=i.pesData;a&&(e=v(a))?(this.parseAVCPES(e,!0),n.pesData=null):n.pesData=a,s&&(e=v(s))?(r.isAAC?this.parseAACPES(e):this.parseMPEGPES(e),r.pesData=null):(null!==s&&void 0!==s&&s.size&&c.logger.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=s),o&&(e=v(o))?(this.parseID3PES(e),i.pesData=null):i.pesData=o},e.demuxSampleAes=function(t,e,r){var n=this.demux(t,r,!0),i=this.sampleAes=new o.default(this.observer,this.config,e);return this.decrypt(n,i)},e.decrypt=function(t,e){return new Promise((function(r){var n=t.audioTrack,i=t.avcTrack;n.samples&&n.isAAC?e.decryptAacSamples(n.samples,0,(function(){i.samples?e.decryptAvcSamples(i.samples,0,0,(function(){r(t)})):r(t)})):i.samples&&e.decryptAvcSamples(i.samples,0,0,(function(){r(t)}))}))},e.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},e.parseAVCPES=function(t,e){var r,n=this,i=this._avcTrack,o=this.parseAVCNALu(t.data),u=this.avcSample,l=!1;t.data=null,u&&o.length&&!i.audFound&&(y(u,i),u=this.avcSample=p(!1,t.pts,t.dts,"")),o.forEach((function(e){switch(e.type){case 1:r=!0,u||(u=n.avcSample=p(!0,t.pts,t.dts,"")),u.frame=!0;var o=e.data;if(l&&o.length>4){var c=new a.default(o).readSliceType();2!==c&&4!==c&&7!==c&&9!==c||(u.key=!0)}break;case 5:r=!0,u||(u=n.avcSample=p(!0,t.pts,t.dts,"")),u.key=!0,u.frame=!0;break;case 6:r=!0;var d=new a.default(E(e.data));d.readUByte();for(var f=0,h=0,g=!1,m=0;!g&&d.bytesAvailable>1;){f=0;do{f+=m=d.readUByte()}while(255===m);h=0;do{h+=m=d.readUByte()}while(255===m);if(4===f&&0!==d.bytesAvailable){if(g=!0,181===d.readUByte()&&49===d.readUShort()&&1195456820===d.readUInt()&&3===d.readUByte()){for(var v=d.readUByte(),T=31&v,S=[v,d.readUByte()],w=0;w<T;w++)S.push(d.readUByte()),S.push(d.readUByte()),S.push(d.readUByte());b(n._txtTrack.samples,{type:3,pts:t.pts,bytes:S})}}else if(5===f&&0!==d.bytesAvailable){if(g=!0,h>16){for(var _=[],k=0;k<16;k++)_.push(d.readUByte().toString(16)),3!==k&&5!==k&&7!==k&&9!==k||_.push("-");for(var A=h-16,L=new Uint8Array(A),D=0;D<A;D++)L[D]=d.readUByte();b(n._txtTrack.samples,{pts:t.pts,payloadType:f,uuid:_.join(""),userData:Object(s.utf8ArrayToStr)(L),userDataBytes:L})}}else if(h<d.bytesAvailable)for(var R=0;R<h;R++)d.readUByte()}break;case 7:if(r=!0,l=!0,!i.sps){var C=new a.default(e.data).readSPS();i.width=C.width,i.height=C.height,i.pixelRatio=C.pixelRatio,i.sps=[e.data],i.duration=n._duration;for(var I=e.data.subarray(1,4),x="avc1.",O=0;O<3;O++){var P=I[O].toString(16);P.length<2&&(P="0"+P),x+=P}i.codec=x}break;case 8:r=!0,i.pps||(i.pps=[e.data]);break;case 9:r=!1,i.audFound=!0,u&&y(u,i),u=n.avcSample=p(!1,t.pts,t.dts,"");break;case 12:r=!1;break;default:r=!1,u&&(u.debug+="unknown NAL "+e.type+" ")}u&&r&&u.units.push(e)})),e&&u&&(y(u,i),this.avcSample=null)},e.getLastNalUnit=function(){var t,e,r=this.avcSample;if(!r||0===r.units.length){var n=this._avcTrack.samples;r=n[n.length-1]}if(null!==(t=r)&&void 0!==t&&t.units){var i=r.units;e=i[i.length-1]}return e},e.parseAVCNALu=function(t){var e,r,n=t.byteLength,i=this._avcTrack,a=i.naluState||0,s=a,o=[],u=0,l=-1,c=0;for(-1===a&&(l=0,c=31&t[0],a=0,u=1);u<n;)if(e=t[u++],a)if(1!==a)if(e)if(1===e){if(l>=0){var d={data:t.subarray(l,u-a-1),type:c};o.push(d)}else{var f=this.getLastNalUnit();if(f&&(s&&u<=4-s&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-s)),(r=u-a-1)>0)){var h=new Uint8Array(f.data.byteLength+r);h.set(f.data,0),h.set(t.subarray(0,r),f.data.byteLength),f.data=h}}u<n?(l=u,c=31&t[u],a=0):a=-1}else a=0;else a=3;else a=e?0:2;else a=e?0:1;if(l>=0&&a>=0){var p={data:t.subarray(l,n),type:c,state:a};o.push(p)}if(0===o.length){var g=this.getLastNalUnit();if(g){var m=new Uint8Array(g.data.byteLength+t.byteLength);m.set(g.data,0),m.set(t,g.data.byteLength),g.data=m}}return i.naluState=a,o},e.parseAACPES=function(t){var e,r,i,a,s=this._audioTrack,o=this.aacLastPTS,l=this.aacOverFlow,f=t.data;if(l){var h=new Uint8Array(l.byteLength+f.byteLength);h.set(l,0),h.set(f,l.byteLength),f=h}for(e=0,r=f.length;e<r-1&&!n.isHeader(f,e);e++);if(!e||(e<r-1?(i="AAC PES did not start with ADTS header,offset:"+e,a=!1):(i="no ADTS header found in AAC PES",a=!0),c.logger.warn("parsing error:"+i),this.observer.emit(u.Events.ERROR,u.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:a,reason:i}),!a)){n.initTrackConfig(s,this.observer,f,e,this.audioCodec);var p,g=0,m=n.getFrameDuration(s.samplerate);if(void 0!==t.pts)p=t.pts;else{if(null===o)return void c.logger.warn("[tsdemuxer]: AAC PES unknown PTS");p=o}if(l&&null!==o){var v=o+m;Math.abs(v-p)>1&&(c.logger.log("[tsdemuxer]: AAC: align PTS for overlapping frames by "+Math.round((v-p)/90)),p=v)}for(var y=null;e<r;){if(n.isHeader(f,e)){if(e+5<r){var b=n.appendFrame(s,f,e,p,g);if(b){e+=b.length,y=b.sample.pts,g++;continue}}break}e++}this.aacOverFlow=e<r?f.subarray(e,r):null,this.aacLastPTS=y}},e.parseMPEGPES=function(t){var e=t.data,r=e.length,n=0,a=0,s=t.pts;if(void 0!==s)for(;a<r;)if(i.isHeader(e,a)){var o=i.appendFrame(this._audioTrack,e,a,s,n);if(!o)break;a+=o.length,n++}else a++;else c.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},e.parseID3PES=function(t){void 0!==t.pts?this._id3Track.samples.push(t):c.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},t}();function p(t,e,r,n){return{key:t,frame:!1,pts:e,dts:r,units:[],debug:n,length:0}}function g(t,e){return(31&t[e+10])<<8|t[e+11]}function m(t,e,r,n){var i={audio:-1,avc:-1,id3:-1,isAAC:!0},a=e+3+((15&t[e+1])<<8|t[e+2])-4;for(e+=12+((15&t[e+10])<<8|t[e+11]);e<a;){var s=(31&t[e+1])<<8|t[e+2];switch(t[e]){case 207:if(!n){c.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===i.audio&&(i.audio=s);break;case 21:-1===i.id3&&(i.id3=s);break;case 219:if(!n){c.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===i.avc&&(i.avc=s);break;case 3:case 4:r?-1===i.audio&&(i.audio=s,i.isAAC=!1):c.logger.log("MPEG audio found, not supported in this browser");break;case 36:c.logger.warn("Unsupported HEVC stream type found")}e+=5+((15&t[e+3])<<8|t[e+4])}return i}function v(t){var e,r,n,i,a,s=0,o=t.data;if(!t||0===t.size)return null;for(;o[0].length<19&&o.length>1;){var u=new Uint8Array(o[0].length+o[1].length);u.set(o[0]),u.set(o[1],o[0].length),o[0]=u,o.splice(1,1)}if(1===((e=o[0])[0]<<16)+(e[1]<<8)+e[2]){if((r=(e[4]<<8)+e[5])&&r>t.size-6)return null;var l=e[7];192&l&&(i=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2,64&l?i-(a=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)>54e5&&(c.logger.warn(Math.round((i-a)/9e4)+"s delta between PTS and DTS, align them"),i=a):a=i);var d=(n=e[8])+9;if(t.size<=d)return null;t.size-=d;for(var f=new Uint8Array(t.size),h=0,p=o.length;h<p;h++){var g=(e=o[h]).byteLength;if(d){if(d>g){d-=g;continue}e=e.subarray(d),g-=d,d=0}f.set(e,s),s+=g}return r&&(r-=n+3),{data:f,pts:i,dts:a,len:r}}return null}function y(t,e){if(t.units.length&&t.frame){if(void 0===t.pts){var r=e.samples,n=r.length;if(!n)return void e.dropped++;var i=r[n-1];t.pts=i.pts,t.dts=i.dts}e.samples.push(t)}t.debug.length&&c.logger.log(t.pts+"/"+t.dts+":"+t.debug)}function b(t,e){var r=t.length;if(r>0){if(e.pts>=t[r-1].pts)t.push(e);else for(var n=r-1;n>=0;n--)if(e.pts<t[n].pts){t.splice(n,0,e);break}}else t.push(e)}function E(t){for(var e=t.byteLength,r=[],n=1;n<e-2;)0===t[n]&&0===t[n+1]&&3===t[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return t;var i=e-r.length,a=new Uint8Array(i),s=0;for(n=0;n<i;s++,n++)s===r[0]&&(s++,r.shift()),a[n]=t[s];return a}h.minProbeByteLength=188,e.default=h},"./src/errors.ts":function(t,e,r){"use strict";var n,i;r.r(e),r.d(e,"ErrorTypes",(function(){return n})),r.d(e,"ErrorDetails",(function(){return i})),function(t){t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError"}(n||(n={})),function(t){t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.UNKNOWN="unknown"}(i||(i={}))},"./src/events.ts":function(t,e,r){"use strict";var n;r.r(e),r.d(e,"Events",(function(){return n})),function(t){t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached"}(n||(n={}))},"./src/hls.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return y}));var n=r("./node_modules/url-toolkit/src/url-toolkit.js"),i=r("./src/errors.ts"),a=r("./src/loader/playlist-loader.ts"),s=r("./src/loader/key-loader.ts"),o=r("./src/controller/fragment-tracker.ts"),u=r("./src/controller/stream-controller.ts"),l=r("./src/controller/level-controller.ts"),c=r("./src/is-supported.ts"),d=r("./src/utils/logger.ts"),f=r("./src/config.ts"),h=r("./src/events.ts"),p=r("./node_modules/eventemitter3/index.js"),g=r("./src/controller/id3-track-controller.ts"),m=r("./src/controller/latency-controller.ts");function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var y=function(){function t(e){void 0===e&&(e={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new p.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this._media=null,this.url=null;var r=this.config=Object(f.mergeConfig)(t.DefaultConfig,e);this.userConfig=e,Object(d.enableLogs)(r.debug),this._autoLevelCapping=-1,r.progressive&&Object(f.enableStreamingMode)(r);var n=this.abrController=new r.abrController(this),i=new r.bufferController(this),c=this.capLevelController=new r.capLevelController(this),h=new r.fpsController(this),v=new a.default(this),y=new s.default(this),b=new g.default(this),E=this.levelController=new l.default(this),T=new o.FragmentTracker(this),S=this.streamController=new u.default(this,T);c.setStreamController(S),h.setStreamController(S);var w=[E,S];this.networkControllers=w;var _=[v,y,n,i,c,h,b,T];this.audioTrackController=this.createController(r.audioTrackController,null,w),this.createController(r.audioStreamController,T,w),this.subtitleTrackController=this.createController(r.subtitleTrackController,null,w),this.createController(r.subtitleStreamController,T,w),this.createController(r.timelineController,null,_),this.emeController=this.createController(r.emeController,null,_),this.latencyController=this.createController(m.default,null,_),this.coreComponents=_}t.isSupported=function(){return Object(c.isSupported)()};var e,r,y,b=t.prototype;return b.createController=function(t,e,r){if(t){var n=e?new t(this,e):new t(this);return r&&r.push(n),n}return null},b.on=function(t,e,r){void 0===r&&(r=this),this._emitter.on(t,e,r)},b.once=function(t,e,r){void 0===r&&(r=this),this._emitter.once(t,e,r)},b.removeAllListeners=function(t){this._emitter.removeAllListeners(t)},b.off=function(t,e,r,n){void 0===r&&(r=this),this._emitter.off(t,e,r,n)},b.listeners=function(t){return this._emitter.listeners(t)},b.emit=function(t,e,r){return this._emitter.emit(t,e,r)},b.trigger=function(t,e){if(this.config.debug)return this.emit(t,t,e);try{return this.emit(t,t,e)}catch(r){d.logger.error("An internal error happened while handling event "+t+'. Error message: "'+r.message+'". Here is a stacktrace:',r),this.trigger(h.Events.ERROR,{type:i.ErrorTypes.OTHER_ERROR,details:i.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:t,error:r})}return!1},b.listenerCount=function(t){return this._emitter.listenerCount(t)},b.destroy=function(){d.logger.log("destroy"),this.trigger(h.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers&&(this.networkControllers.forEach((function(t){return t.destroy()})),this.networkControllers=null),this.coreComponents&&(this.coreComponents.forEach((function(t){return t.destroy()})),this.coreComponents=null)},b.attachMedia=function(t){d.logger.log("attachMedia"),this._media=t,this.trigger(h.Events.MEDIA_ATTACHING,{media:t})},b.detachMedia=function(){d.logger.log("detachMedia"),this.trigger(h.Events.MEDIA_DETACHING,void 0),this._media=null},b.loadSource=function(t){this.stopLoad();var e=this.media;e&&this.url&&(this.detachMedia(),this.attachMedia(e)),t=n.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0}),d.logger.log("loadSource:"+t),this.url=t,this.trigger(h.Events.MANIFEST_LOADING,{url:t})},b.startLoad=function(t){void 0===t&&(t=-1),d.logger.log("startLoad("+t+")"),this.networkControllers.forEach((function(e){e.startLoad(t)}))},b.stopLoad=function(){d.logger.log("stopLoad"),this.networkControllers.forEach((function(t){t.stopLoad()}))},b.swapAudioCodec=function(){d.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},b.recoverMediaError=function(){d.logger.log("recoverMediaError");var t=this._media;this.detachMedia(),t&&this.attachMedia(t)},b.removeLevel=function(t,e){void 0===e&&(e=0),this.levelController.removeLevel(t,e)},e=t,y=[{key:"version",get:function(){return"1.0.0"}},{key:"Events",get:function(){return h.Events}},{key:"ErrorTypes",get:function(){return i.ErrorTypes}},{key:"ErrorDetails",get:function(){return i.ErrorDetails}},{key:"DefaultConfig",get:function(){return t.defaultConfig?t.defaultConfig:f.hlsDefaultConfig},set:function(e){t.defaultConfig=e}}],(r=[{key:"levels",get:function(){var t=this.levelController.levels;return t||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){d.logger.log("set currentLevel:"+t),this.loadLevel=t,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){d.logger.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){d.logger.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){d.logger.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){d.logger.log("set startLevel:"+t),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(t){var e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){this._autoLevelCapping!==t&&(d.logger.log("set autoLevelCapping:"+t),this._autoLevelCapping=t)}},{key:"bandwidthEstimate",get:function(){var t=this.abrController.bwEstimator;return t?t.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var t=this.levels,e=this.config.minAutoBitrate;if(!t)return 0;for(var r=t.length,n=0;n<r;n++)if(t[n].maxBitrate>e)return n;return 0}},{key:"maxAutoLevel",get:function(){var t=this.levels,e=this.autoLevelCapping;return-1===e&&t&&t.length?t.length-1:e}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(t){this.config.lowLatencyMode=t}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&v(e.prototype,r),y&&v(e,y),t}();y.defaultConfig=void 0},"./src/is-supported.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"isSupported",(function(){return a})),r.d(e,"changeTypeSupported",(function(){return s}));var n=r("./src/utils/mediasource-helper.ts");function i(){return self.SourceBuffer||self.WebKitSourceBuffer}function a(){var t=Object(n.getMediaSource)();if(!t)return!1;var e=i(),r=t&&"function"===typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!e||e.prototype&&"function"===typeof e.prototype.appendBuffer&&"function"===typeof e.prototype.remove;return!!r&&!!a}function s(){var t,e=i();return"function"===typeof(null===e||void 0===e||null===(t=e.prototype)||void 0===t?void 0:t.changeType)}},"./src/loader/fragment-loader.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return d})),r.d(e,"LoadError",(function(){return h}));var n=r("./src/polyfills/number.ts"),i=r("./src/errors.ts");function a(t){var e="function"===typeof Map?new Map:void 0;return(a=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return s(t,arguments,l(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,t)})(t)}function s(t,e,r){return(s=o()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&u(i,r.prototype),i}).apply(null,arguments)}function o(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=Math.pow(2,17),d=function(){function t(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}var e=t.prototype;return e.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},e.abort=function(){this.loader&&this.loader.abort()},e.load=function(t,e){var r=this,n=t.url;if(!n)return Promise.reject(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t,networkDetails:null},"Fragment does not have a "+(n?"part list":"url")));this.abort();var a=this.config,s=a.fLoader,o=a.loader;return new Promise((function(n,u){r.loader&&r.loader.destroy();var l=r.loader=t.loader=s?new s(a):new o(a),d=f(t),p={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout,highWaterMark:c};t.stats=l.stats,l.load(d,p,{onSuccess:function(e,i,a,s){r.resetLoader(t,l),n({frag:t,part:null,payload:e.data,networkDetails:s})},onError:function(e,n,a){r.resetLoader(t,l),u(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:e,networkDetails:a}))},onAbort:function(e,n,a){r.resetLoader(t,l),u(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:t,networkDetails:a}))},onTimeout:function(e,n,a){r.resetLoader(t,l),u(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,networkDetails:a}))},onProgress:function(r,n,i,a){e&&e({frag:t,part:null,payload:i,networkDetails:a})}})}))},e.loadPart=function(t,e,r){var n=this;this.abort();var a=this.config,s=a.fLoader,o=a.loader;return new Promise((function(u,l){n.loader&&n.loader.destroy();var d=n.loader=t.loader=s?new s(a):new o(a),p=f(t,e),g={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout,highWaterMark:c};e.stats=d.stats,d.load(p,g,{onSuccess:function(i,a,s,o){n.resetLoader(t,d),n.updateStatsFromPart(t,e);var l={frag:t,part:e,payload:i.data,networkDetails:o};r(l),u(l)},onError:function(r,a,s){n.resetLoader(t,d),l(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:e,response:r,networkDetails:s}))},onAbort:function(r,a,s){t.stats.aborted=e.stats.aborted,n.resetLoader(t,d),l(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:t,part:e,networkDetails:s}))},onTimeout:function(r,a,s){n.resetLoader(t,d),l(new h({type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:e,networkDetails:s}))}})}))},e.updateStatsFromPart=function(t,e){var r=t.stats,n=e.stats,i=n.total;if(r.loaded+=n.loaded,i){var a=Math.round(t.duration/e.duration),s=Math.min(Math.round(r.loaded/i),a),o=(a-s)*Math.round(r.loaded/s);r.total=r.loaded+o}else r.total=Math.max(r.loaded,r.total);var u=r.loading,l=n.loading;u.start?u.first+=l.first-l.start:(u.start=l.start,u.first=l.first),u.end=l.end},e.resetLoader=function(t,e){t.loader=null,this.loader===e&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),e.destroy()},t}();function f(t,e){void 0===e&&(e=null);var r=e||t,i={frag:t,part:e,responseType:"arraybuffer",url:r.url,rangeStart:0,rangeEnd:0},a=r.byteRangeStartOffset,s=r.byteRangeEndOffset;return Object(n.isFiniteNumber)(a)&&Object(n.isFiniteNumber)(s)&&(i.rangeStart=a,i.rangeEnd=s),i}var h=function(t){var e,r;function n(e){for(var r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return(r=t.call.apply(t,[this].concat(i))||this).data=void 0,r.data=e,r}return r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,u(e,r),n}(a(Error))},"./src/loader/fragment.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"ElementaryStreamTypes",(function(){return n})),r.d(e,"BaseSegment",(function(){return h})),r.d(e,"Fragment",(function(){return p})),r.d(e,"Part",(function(){return g}));var n,i=r("./src/polyfills/number.ts"),a=r("./node_modules/url-toolkit/src/url-toolkit.js"),s=r("./src/utils/logger.ts"),o=r("./src/loader/level-key.ts"),u=r("./src/loader/load-stats.ts");function l(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return e&&d(t.prototype,e),r&&d(t,r),t}!function(t){t.AUDIO="audio",t.VIDEO="video",t.AUDIOVIDEO="audiovideo"}(n||(n={}));var h=function(){function t(t){var e;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((e={})[n.AUDIO]=null,e[n.VIDEO]=null,e[n.AUDIOVIDEO]=null,e),this.baseurl=t}return t.prototype.setByteRange=function(t,e){var r=t.split("@",2),n=[];1===r.length?n[0]=e?e.byteRangeEndOffset:0:n[0]=parseInt(r[1]),n[1]=parseInt(r[0])+n[0],this._byteRange=n},f(t,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(t){this._url=t}}]),t}(),p=function(t){function e(e,r){var n;return(n=t.call(this,r)||this)._decryptdata=null,n.rawProgramDateTime=null,n.programDateTime=null,n.tagList=[],n.duration=0,n.sn=0,n.levelkey=void 0,n.type=void 0,n.loader=null,n.level=-1,n.cc=0,n.startPTS=void 0,n.endPTS=void 0,n.appendedPTS=void 0,n.startDTS=void 0,n.endDTS=void 0,n.start=0,n.deltaPTS=void 0,n.maxStartPTS=void 0,n.minEndPTS=void 0,n.stats=new u.LoadStats,n.urlId=0,n.data=void 0,n.bitrateTest=!1,n.title=null,n.type=e,n}l(e,t);var r=e.prototype;return r.createInitializationVector=function(t){for(var e=new Uint8Array(16),r=12;r<16;r++)e[r]=t>>8*(15-r)&255;return e},r.setDecryptDataFromLevelKey=function(t,e){var r=t;return"AES-128"===(null===t||void 0===t?void 0:t.method)&&t.uri&&!t.iv&&((r=o.LevelKey.fromURI(t.uri)).method=t.method,r.iv=this.createInitializationVector(e),r.keyFormat="identity"),r},r.setElementaryStreamInfo=function(t,e,r,n,i,a){void 0===a&&(a=!1);var s=this.elementaryStreams,o=s[t];o?(o.startPTS=Math.min(o.startPTS,e),o.endPTS=Math.max(o.endPTS,r),o.startDTS=Math.min(o.startDTS,n),o.endDTS=Math.max(o.endDTS,i)):s[t]={startPTS:e,endPTS:r,startDTS:n,endDTS:i,partial:a}},r.clearElementaryStreamInfo=function(){var t=this.elementaryStreams;t[n.AUDIO]=null,t[n.VIDEO]=null,t[n.AUDIOVIDEO]=null},f(e,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var t=this.sn;"number"!==typeof t&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&s.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),t=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,t)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(i.isFiniteNumber)(this.programDateTime))return null;var t=Object(i.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*t}},{key:"encrypted",get:function(){var t;return!(null===(t=this.decryptdata)||void 0===t||!t.keyFormat||!this.decryptdata.uri)}}]),e}(h),g=function(t){function e(e,r,n,i,a){var s;(s=t.call(this,n)||this).fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.stats=new u.LoadStats,s.duration=e.decimalFloatingPoint("DURATION"),s.gap=e.bool("GAP"),s.independent=e.bool("INDEPENDENT"),s.relurl=e.enumeratedString("URI"),s.fragment=r,s.index=i;var o=e.enumeratedString("BYTERANGE");return o&&s.setByteRange(o,a),a&&(s.fragOffset=a.fragOffset+a.duration),s}return l(e,t),f(e,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var t=this.elementaryStreams;return!!(t.audio||t.video||t.audiovideo)}}]),e}(h)},"./src/loader/key-loader.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return s}));var n=r("./src/events.ts"),i=r("./src/errors.ts"),a=r("./src/utils/logger.ts"),s=function(){function t(t){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=t,this._registerListeners()}var e=t.prototype;return e._registerListeners=function(){this.hls.on(n.Events.KEY_LOADING,this.onKeyLoading,this)},e._unregisterListeners=function(){this.hls.off(n.Events.KEY_LOADING,this.onKeyLoading)},e.destroy=function(){for(var t in this._unregisterListeners(),this.loaders){var e=this.loaders[t];e&&e.destroy()}this.loaders={}},e.onKeyLoading=function(t,e){var r=e.frag,i=r.type,s=this.loaders[i];if(r.decryptdata){var o=r.decryptdata.uri;if(o!==this.decrypturl||null===this.decryptkey){var u=this.hls.config;if(s&&(a.logger.warn("abort previous key loader for type:"+i),s.abort()),!o)return void a.logger.warn("key uri is falsy");var l=u.loader,c=r.loader=this.loaders[i]=new l(u);this.decrypturl=o,this.decryptkey=null;var d={url:o,frag:r,responseType:"arraybuffer"},f={timeout:u.fragLoadingTimeOut,maxRetry:0,retryDelay:u.fragLoadingRetryDelay,maxRetryDelay:u.fragLoadingMaxRetryTimeout,highWaterMark:0},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};c.load(d,f,h)}else this.decryptkey&&(r.decryptdata.key=this.decryptkey,this.hls.trigger(n.Events.KEY_LOADED,{frag:r}))}else a.logger.warn("Missing decryption data on fragment in onKeyLoading")},e.loadsuccess=function(t,e,r){var i=r.frag;i.decryptdata?(this.decryptkey=i.decryptdata.key=new Uint8Array(t.data),i.loader=null,delete this.loaders[i.type],this.hls.trigger(n.Events.KEY_LOADED,{frag:i})):a.logger.error("after key load, decryptdata unset")},e.loaderror=function(t,e){var r=e.frag,a=r.loader;a&&a.abort(),delete this.loaders[r.type],this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:t})},e.loadtimeout=function(t,e){var r=e.frag,a=r.loader;a&&a.abort(),delete this.loaders[r.type],this.hls.trigger(n.Events.ERROR,{type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},t}()},"./src/loader/level-details.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"LevelDetails",(function(){return a}));var n=r("./src/polyfills/number.ts");function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.initSegment=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=t}var e,r,a;return t.prototype.reloaded=function(t){if(!t)return this.advanced=!0,void(this.updated=!0);var e=this.lastPartSn-t.lastPartSn,r=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!r||!!e,this.advanced=this.endSN>t.endSN||e>0||0===e&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*t.misses):this.misses=t.misses+1,this.availabilityDelay=t.availabilityDelay},e=t,(r=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Object(n.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var t=this.driftEndTime-this.driftStartTime;return t>0?1e3*(this.driftEnd-this.driftStart)/t:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var t;return null!==(t=this.partList)&&void 0!==t&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var t;return null!==(t=this.fragments)&&void 0!==t&&t.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var t;return null!==(t=this.partList)&&void 0!==t&&t.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var t;return null!==(t=this.partList)&&void 0!==t&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&i(e.prototype,r),a&&i(e,a),t}()},"./src/loader/level-key.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"LevelKey",(function(){return a}));var n=r("./node_modules/url-toolkit/src/url-toolkit.js");function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(t,e){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=e?Object(n.buildAbsoluteURL)(t,e,{alwaysNormalize:!0}):t}var e,r,a;return t.fromURL=function(e,r){return new t(e,r)},t.fromURI=function(e){return new t(e)},e=t,(r=[{key:"uri",get:function(){return this._uri}}])&&i(e.prototype,r),a&&i(e,a),t}()},"./src/loader/load-stats.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"LoadStats",(function(){return n}));var n=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return m}));var n=r("./src/polyfills/number.ts"),i=r("./node_modules/url-toolkit/src/url-toolkit.js"),a=r("./src/loader/fragment.ts"),s=r("./src/loader/level-details.ts"),o=r("./src/loader/level-key.ts"),u=r("./src/utils/attr-list.ts"),l=r("./src/utils/logger.ts"),c=r("./src/utils/codecs.ts"),d=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,f=/#EXT-X-MEDIA:(.*)/g,h=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),p=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),g=/\.(mp4|m4s|m4v|m4a)$/i,m=function(){function t(){}return t.findGroup=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(n.id===e)return n}},t.convertAVC1ToAVCOTI=function(t){var e=t.split(".");if(e.length>2){var r=e.shift()+".";return r+=parseInt(e.shift()).toString(16),r+=("000"+parseInt(e.shift()).toString(16)).substr(-4)}return t},t.resolve=function(t,e){return i.buildAbsoluteURL(e,t,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(e,r){var n,i=[],a={},s=!1;for(d.lastIndex=0;null!=(n=d.exec(e));)if(n[1]){var o=new u.AttrList(n[1]),l={attrs:o,bitrate:o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),name:o.NAME,url:t.resolve(n[2],r)},c=o.decimalResolution("RESOLUTION");c&&(l.width=c.width,l.height=c.height),v((o.CODECS||"").split(/[ ,]+/).filter((function(t){return t})),l),l.videoCodec&&-1!==l.videoCodec.indexOf("avc1")&&(l.videoCodec=t.convertAVC1ToAVCOTI(l.videoCodec)),i.push(l)}else if(n[3]){var f=new u.AttrList(n[3]);f["DATA-ID"]&&(s=!0,a[f["DATA-ID"]]=f)}return{levels:i,sessionData:s?a:null}},t.parseMasterPlaylistMedia=function(e,r,n,i){var a;void 0===i&&(i=[]);var s=[],o=0;for(f.lastIndex=0;null!==(a=f.exec(e));){var l=new u.AttrList(a[1]);if(l.TYPE===n){var c={attrs:l,bitrate:0,id:o++,groupId:l["GROUP-ID"],instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE||"",type:n,default:l.bool("DEFAULT"),autoselect:l.bool("AUTOSELECT"),forced:l.bool("FORCED"),lang:l.LANGUAGE,url:l.URI?t.resolve(l.URI,r):""};if(i.length){var d=t.findGroup(i,c.groupId)||i[0];y(c,d,"audioCodec"),y(c,d,"textCodec")}s.push(c)}}return s},t.parseLevelPlaylist=function(t,e,r,i,c){var d,f,m,v=new s.LevelDetails(e),y=v.fragments,E=0,T=0,S=0,w=0,_=null,k=new a.Fragment(i,e),A=-1;for(h.lastIndex=0,v.m3u8=t;null!==(d=h.exec(t));){var L=d[1];if(L){k.duration=parseFloat(L);var D=(" "+d[2]).slice(1);k.title=D||null,k.tagList.push(D?["INF",L,D]:["INF",L])}else if(d[3])Object(n.isFiniteNumber)(k.duration)&&(k.start=S,m&&(k.levelkey=m),k.sn=E,k.level=r,k.cc=w,k.urlId=c,y.push(k),k.relurl=(" "+d[3]).slice(1),b(k,_),_=k,S+=k.duration,E++,T=0,(k=new a.Fragment(i,e)).start=S,k.sn=E,k.cc=w,k.level=r);else if(d[4]){var R=(" "+d[4]).slice(1);_?k.setByteRange(R,_):k.setByteRange(R)}else if(d[5])k.rawProgramDateTime=(" "+d[5]).slice(1),k.tagList.push(["PROGRAM-DATE-TIME",k.rawProgramDateTime]),-1===A&&(A=y.length);else{if(!(d=d[0].match(p))){l.logger.warn("No matches on slow regex match for level playlist!");continue}for(f=1;f<d.length&&"undefined"===typeof d[f];f++);var C=(" "+d[f]).slice(1),I=(" "+d[f+1]).slice(1),x=d[f+2]?(" "+d[f+2]).slice(1):"";switch(C){case"PLAYLIST-TYPE":v.type=I.toUpperCase();break;case"MEDIA-SEQUENCE":E=v.startSN=parseInt(I);break;case"SKIP":var O=new u.AttrList(I),P=O.decimalInteger("SKIPPED-SEGMENTS");if(Object(n.isFiniteNumber)(P)){v.skippedSegments=P;for(var M=P;M--;)y.unshift(null);E+=P}var F=O.enumeratedString("RECENTLY-REMOVED-DATERANGES");F&&(v.recentlyRemovedDateranges=F.split("\t"));break;case"TARGETDURATION":v.targetduration=parseFloat(I);break;case"VERSION":v.version=parseInt(I);break;case"EXTM3U":break;case"ENDLIST":v.live=!1;break;case"#":(I||x)&&k.tagList.push(x?[I,x]:[I]);break;case"DIS":w++;case"GAP":k.tagList.push([C]);break;case"BITRATE":k.tagList.push([C,I]);break;case"DISCONTINUITY-SEQ":w=parseInt(I);break;case"KEY":var U,N=new u.AttrList(I),B=N.enumeratedString("METHOD"),G=N.URI,j=N.hexadecimalInteger("IV"),H=N.enumeratedString("KEYFORMATVERSIONS"),V=N.enumeratedString("KEYID"),K=null!=(U=N.enumeratedString("KEYFORMAT"))?U:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(K)>-1){l.logger.warn("Keyformat "+K+" is not supported from the manifest");continue}if("identity"!==K)continue;B&&(m=o.LevelKey.fromURL(e,G),G&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(B)>=0&&(m.method=B,m.keyFormat=K,V&&(m.keyID=V),H&&(m.keyFormatVersions=H),m.iv=j));break;case"START":var z=new u.AttrList(I).decimalFloatingPoint("TIME-OFFSET");Object(n.isFiniteNumber)(z)&&(v.startTimeOffset=z);break;case"MAP":var W=new u.AttrList(I);k.relurl=W.URI,W.BYTERANGE&&k.setByteRange(W.BYTERANGE),k.level=r,k.sn="initSegment",m&&(k.levelkey=m),v.initSegment=k,(k=new a.Fragment(i,e)).rawProgramDateTime=v.initSegment.rawProgramDateTime;break;case"SERVER-CONTROL":var Y=new u.AttrList(I);v.canBlockReload=Y.bool("CAN-BLOCK-RELOAD"),v.canSkipUntil=Y.optionalFloat("CAN-SKIP-UNTIL",0),v.canSkipDateRanges=v.canSkipUntil>0&&Y.bool("CAN-SKIP-DATERANGES"),v.partHoldBack=Y.optionalFloat("PART-HOLD-BACK",0),v.holdBack=Y.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var q=new u.AttrList(I);v.partTarget=q.decimalFloatingPoint("PART-TARGET");break;case"PART":var X=v.partList;X||(X=v.partList=[]);var $=T>0?X[X.length-1]:void 0,Q=T++,J=new a.Part(new u.AttrList(I),k,e,Q,$);X.push(J),k.duration+=J.duration;break;case"PRELOAD-HINT":var Z=new u.AttrList(I);v.preloadHint=Z;break;case"RENDITION-REPORT":var tt=new u.AttrList(I);v.renditionReports=v.renditionReports||[],v.renditionReports.push(tt);break;default:l.logger.warn("line parsed but not handled: "+d)}}}_&&!_.relurl?(y.pop(),S-=_.duration,v.partList&&(v.fragmentHint=_)):v.partList&&(b(k,_),k.cc=w,v.fragmentHint=k);var et=y.length,rt=y[0],nt=y[et-1];if((S+=v.skippedSegments*v.targetduration)>0&&et&&nt){v.averagetargetduration=S/et;var it=nt.sn;v.endSN="initSegment"!==it?it:0,rt&&(v.startCC=rt.cc,v.initSegment||v.fragments.every((function(t){return g.test(t.relurl)}))&&(l.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(k=new a.Fragment(i,e)).relurl=nt.relurl,k.level=r,k.sn="initSegment",v.initSegment=k,v.needSidxRanges=!0))}else v.endSN=0,v.startCC=0;return v.fragmentHint&&(S+=v.fragmentHint.duration),v.totalduration=S,v.endCC=w,A>0&&function(t,e){for(var r=t[e],n=e;n--;){var i=t[n];if(!i)return;i.programDateTime=r.programDateTime-1e3*i.duration,r=i}}(y,A),v},t}();function v(t,e){["video","audio","text"].forEach((function(r){var n=t.filter((function(t){return Object(c.isCodecType)(t,r)}));if(n.length){var i=n.filter((function(t){return 0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)}));e[r+"Codec"]=i.length>0?i[0]:n[0],t=t.filter((function(t){return-1===n.indexOf(t)}))}})),e.unknownCodecs=t}function y(t,e,r){var n=e[r];n&&(t[r]=n)}function b(t,e){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):null!==e&&void 0!==e&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime),Object(n.isFiniteNumber)(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/polyfills/number.ts"),i=r("./src/events.ts"),a=r("./src/errors.ts"),s=r("./src/utils/logger.ts"),o=r("./src/utils/mp4-tools.ts"),u=r("./src/loader/m3u8-parser.ts"),l=r("./src/types/loader.ts"),c=r("./src/utils/attr-list.ts");function d(t,e){var r=t.url;return void 0!==r&&0!==r.indexOf("data:")||(r=e.url),r}var f=function(){function t(t){this.hls=void 0,this.loaders=Object.create(null),this.hls=t,this.registerListeners()}var e=t.prototype;return e.registerListeners=function(){var t=this.hls;t.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(i.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(i.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(i.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},e.unregisterListeners=function(){var t=this.hls;t.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(i.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(i.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(i.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},e.createInternalLoader=function(t){var e=this.hls.config,r=e.pLoader,n=e.loader,i=new(r||n)(e);return t.loader=i,this.loaders[t.type]=i,i},e.getInternalLoader=function(t){return this.loaders[t.type]},e.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},e.destroyInternalLoaders=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}},e.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},e.onManifestLoading=function(t,e){var r=e.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:l.PlaylistContextType.MANIFEST,url:r,deliveryDirectives:null})},e.onLevelLoading=function(t,e){var r=e.id,n=e.level,i=e.url,a=e.deliveryDirectives;this.load({id:r,groupId:null,level:n,responseType:"text",type:l.PlaylistContextType.LEVEL,url:i,deliveryDirectives:a})},e.onAudioTrackLoading=function(t,e){var r=e.id,n=e.groupId,i=e.url,a=e.deliveryDirectives;this.load({id:r,groupId:n,level:null,responseType:"text",type:l.PlaylistContextType.AUDIO_TRACK,url:i,deliveryDirectives:a})},e.onSubtitleTrackLoading=function(t,e){var r=e.id,n=e.groupId,i=e.url,a=e.deliveryDirectives;this.load({id:r,groupId:n,level:null,responseType:"text",type:l.PlaylistContextType.SUBTITLE_TRACK,url:i,deliveryDirectives:a})},e.load=function(t){var e,r,n,i,a,o,u=this.hls.config,c=this.getInternalLoader(t);if(c){var d=c.context;if(d&&d.url===t.url)return void s.logger.trace("[playlist-loader]: playlist request ongoing");s.logger.log("[playlist-loader]: aborting previous loader for type: "+t.type),c.abort()}switch(t.type){case l.PlaylistContextType.MANIFEST:r=u.manifestLoadingMaxRetry,n=u.manifestLoadingTimeOut,i=u.manifestLoadingRetryDelay,a=u.manifestLoadingMaxRetryTimeout;break;case l.PlaylistContextType.LEVEL:case l.PlaylistContextType.AUDIO_TRACK:case l.PlaylistContextType.SUBTITLE_TRACK:r=0,n=u.levelLoadingTimeOut;break;default:r=u.levelLoadingMaxRetry,n=u.levelLoadingTimeOut,i=u.levelLoadingRetryDelay,a=u.levelLoadingMaxRetryTimeout}if(c=this.createInternalLoader(t),null!==(e=t.deliveryDirectives)&&void 0!==e&&e.part&&(t.type===l.PlaylistContextType.LEVEL&&null!==t.level?o=this.hls.levels[t.level].details:t.type===l.PlaylistContextType.AUDIO_TRACK&&null!==t.id?o=this.hls.audioTracks[t.id].details:t.type===l.PlaylistContextType.SUBTITLE_TRACK&&null!==t.id&&(o=this.hls.subtitleTracks[t.id].details),o)){var f=o.partTarget,h=o.targetduration;f&&h&&(n=Math.min(1e3*Math.max(3*f,.8*h),n))}var p={timeout:n,maxRetry:r,retryDelay:i,maxRetryDelay:a,highWaterMark:0},g={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};c.load(t,p,g)},e.loadsuccess=function(t,e,r,n){if(void 0===n&&(n=null),r.isSidxRequest)return this.handleSidxRequest(t,r),void this.handlePlaylistLoaded(t,e,r,n);this.resetInternalLoader(r.type);var i=t.data;0===i.indexOf("#EXTM3U")?(e.parsing.start=performance.now(),i.indexOf("#EXTINF:")>0||i.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(t,e,r,n):this.handleMasterPlaylist(t,e,r,n)):this.handleManifestParsingError(t,r,"no EXTM3U delimiter",n)},e.loaderror=function(t,e,r){void 0===r&&(r=null),this.handleNetworkError(e,r,!1,t)},e.loadtimeout=function(t,e,r){void 0===r&&(r=null),this.handleNetworkError(e,r,!0)},e.handleMasterPlaylist=function(t,e,r,n){var a=this.hls,o=t.data,l=d(t,r),f=u.default.parseMasterPlaylist(o,l),h=f.levels,p=f.sessionData;if(h.length){var g=h.map((function(t){return{id:t.attrs.AUDIO,audioCodec:t.audioCodec}})),m=h.map((function(t){return{id:t.attrs.SUBTITLES,textCodec:t.textCodec}})),v=u.default.parseMasterPlaylistMedia(o,l,"AUDIO",g),y=u.default.parseMasterPlaylistMedia(o,l,"SUBTITLES",m),b=u.default.parseMasterPlaylistMedia(o,l,"CLOSED-CAPTIONS");v.length&&(v.some((function(t){return!t.url}))||!h[0].audioCodec||h[0].attrs.AUDIO||(s.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),v.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new c.AttrList({}),bitrate:0,url:""}))),a.trigger(i.Events.MANIFEST_LOADED,{levels:h,audioTracks:v,subtitles:y,captions:b,url:l,stats:e,networkDetails:n,sessionData:p})}else this.handleManifestParsingError(t,r,"no level found in manifest",n)},e.handleTrackOrLevelPlaylist=function(t,e,r,s){var o=this.hls,f=r.id,h=r.level,p=r.type,g=d(t,r),m=Object(n.isFiniteNumber)(f)?f:0,v=Object(n.isFiniteNumber)(h)?h:m,y=function(t){switch(t.type){case l.PlaylistContextType.AUDIO_TRACK:return l.PlaylistLevelType.AUDIO;case l.PlaylistContextType.SUBTITLE_TRACK:return l.PlaylistLevelType.SUBTITLE;default:return l.PlaylistLevelType.MAIN}}(r),b=u.default.parseLevelPlaylist(t.data,g,v,y,m);if(b.fragments.length){if(p===l.PlaylistContextType.MANIFEST){var E={attrs:new c.AttrList({}),bitrate:0,details:b,name:"",url:g};o.trigger(i.Events.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:g,stats:e,networkDetails:s,sessionData:null})}if(e.parsing.end=performance.now(),b.needSidxRanges){var T=b.initSegment.url;this.load({url:T,isSidxRequest:!0,type:p,level:h,levelDetails:b,id:f,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else r.levelDetails=b,this.handlePlaylistLoaded(t,e,r,s)}else o.trigger(i.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:g,reason:"no fragments found in level",level:"number"===typeof r.level?r.level:void 0})},e.handleSidxRequest=function(t,e){var r=Object(o.parseSegmentIndex)(new Uint8Array(t.data));if(r){var n=r.references,i=e.levelDetails;n.forEach((function(t,e){var r=t.info,n=i.fragments[e];0===n.byteRange.length&&n.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))})),i.initSegment.setByteRange(String(r.moovEndOffset)+"@0")}},e.handleManifestParsingError=function(t,e,r,n){this.hls.trigger(i.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:e.type===l.PlaylistContextType.MANIFEST,url:t.url,reason:r,response:t,context:e,networkDetails:n})},e.handleNetworkError=function(t,e,r,n){void 0===r&&(r=!1),s.logger.warn("[playlist-loader]: A network "+(r?"timeout":"error")+" occurred while loading "+t.type+" level: "+t.level+" id: "+t.id+' group-id: "'+t.groupId+'"');var o=a.ErrorDetails.UNKNOWN,u=!1,c=this.getInternalLoader(t);switch(t.type){case l.PlaylistContextType.MANIFEST:o=r?a.ErrorDetails.MANIFEST_LOAD_TIMEOUT:a.ErrorDetails.MANIFEST_LOAD_ERROR,u=!0;break;case l.PlaylistContextType.LEVEL:o=r?a.ErrorDetails.LEVEL_LOAD_TIMEOUT:a.ErrorDetails.LEVEL_LOAD_ERROR,u=!1;break;case l.PlaylistContextType.AUDIO_TRACK:o=r?a.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case l.PlaylistContextType.SUBTITLE_TRACK:o=r?a.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:a.ErrorDetails.SUBTITLE_LOAD_ERROR,u=!1}c&&this.resetInternalLoader(t.type);var d={type:a.ErrorTypes.NETWORK_ERROR,details:o,fatal:u,url:t.url,loader:c,context:t,networkDetails:e};n&&(d.response=n),this.hls.trigger(i.Events.ERROR,d)},e.handlePlaylistLoaded=function(t,e,r,n){var a=r.type,s=r.level,o=r.id,u=r.groupId,c=r.loader,d=r.levelDetails,f=r.deliveryDirectives;if(null!==d&&void 0!==d&&d.targetduration){if(c){if(d.live){var h=c.getResponseHeader("age");d.ageHeader=h?parseFloat(h):0}switch(a){case l.PlaylistContextType.MANIFEST:case l.PlaylistContextType.LEVEL:this.hls.trigger(i.Events.LEVEL_LOADED,{details:d,level:s||0,id:o||0,stats:e,networkDetails:n,deliveryDirectives:f});break;case l.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(i.Events.AUDIO_TRACK_LOADED,{details:d,id:o||0,groupId:u||"",stats:e,networkDetails:n,deliveryDirectives:f});break;case l.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(i.Events.SUBTITLE_TRACK_LOADED,{details:d,id:o||0,groupId:u||"",stats:e,networkDetails:n,deliveryDirectives:f})}}}else this.handleManifestParsingError(t,r,"invalid target duration",n)},t}();e.default=f},"./src/polyfills/number.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"isFiniteNumber",(function(){return n})),r.d(e,"MAX_SAFE_INTEGER",(function(){return i}));var n=Number.isFinite||function(t){return"number"===typeof t&&isFinite(t)},i=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(t,e,r){"use strict";r.r(e);var n=function(){function t(){}return t.getSilentFrame=function(t,e){switch(t){case"mp4a.40.2":if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},t}();e.default=n},"./src/remux/mp4-generator.ts":function(t,e,r){"use strict";r.r(e);var n=Math.pow(2,32)-1,i=function(){function t(){}return t.init=function(){var e;for(e in t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=a,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,s,u,s,o),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,i))},t.box=function(t){for(var e=8,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var a=n.length,s=a;a--;)e+=n[a].byteLength;var o=new Uint8Array(e);for(o[0]=e>>24&255,o[1]=e>>16&255,o[2]=e>>8&255,o[3]=255&e,o.set(t,4),a=0,e=8;a<s;a++)o.set(n[a],e),e+=n[a].byteLength;return o},t.hdlr=function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])},t.mdat=function(e){return t.box(t.types.mdat,e)},t.mdhd=function(e,r){r*=e;var i=Math.floor(r/(n+1)),a=Math.floor(r%(n+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},t.mdia=function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))},t.mfhd=function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},t.minf=function(e){return"audio"===e.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(e)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))},t.moof=function(e,r,n){return t.box(t.types.moof,t.mfhd(e),t.traf(n,r))},t.moov=function(e){for(var r=e.length,n=[];r--;)n[r]=t.trak(e[r]);return t.box.apply(null,[t.types.moov,t.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(t.mvex(e)))},t.mvex=function(e){for(var r=e.length,n=[];r--;)n[r]=t.trex(e[r]);return t.box.apply(null,[t.types.mvex].concat(n))},t.mvhd=function(e,r){r*=e;var i=Math.floor(r/(n+1)),a=Math.floor(r%(n+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,s)},t.sdtp=function(e){var r,n,i=e.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return t.box(t.types.sdtp,a)},t.stbl=function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))},t.avc1=function(e){var r,n,i,a=[],s=[];for(r=0;r<e.sps.length;r++)i=(n=e.sps[r]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));for(r=0;r<e.pps.length;r++)i=(n=e.pps[r]).byteLength,s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n));var o=t.box(t.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|e.sps.length].concat(a).concat([e.pps.length]).concat(s))),u=e.width,l=e.height,c=e.pixelRatio[0],d=e.pixelRatio[1];return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),t.box(t.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))},t.esds=function(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))},t.mp4a=function(e){var r=e.samplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),t.box(t.types.esds,t.esds(e)))},t.mp3=function(e){var r=e.samplerate;return t.box(t.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},t.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?t.box(t.types.stsd,t.STSD,t.mp4a(e)):t.box(t.types.stsd,t.STSD,t.mp3(e)):t.box(t.types.stsd,t.STSD,t.avc1(e))},t.tkhd=function(e){var r=e.id,i=e.duration*e.timescale,a=e.width,s=e.height,o=Math.floor(i/(n+1)),u=Math.floor(i%(n+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,u>>24,u>>16&255,u>>8&255,255&u,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,s>>8&255,255&s,0,0]))},t.traf=function(e,r){var i=t.sdtp(e),a=e.id,s=Math.floor(r/(n+1)),o=Math.floor(r%(n+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o])),t.trun(e,i.length+16+20+8+16+8+8),i)},t.trak=function(e){return e.duration=e.duration||4294967295,t.box(t.types.trak,t.tkhd(e),t.mdia(e))},t.trex=function(e){var r=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},t.trun=function(e,r){var n,i,a,s,o,u,l=e.samples||[],c=l.length,d=12+16*c,f=new Uint8Array(d);for(r+=8+d,f.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)a=(i=l[n]).duration,s=i.size,o=i.flags,u=i.cts,f.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*n);return t.box(t.types.trun,f)},t.initSegment=function(e){t.types||t.init();var r=t.moov(e),n=new Uint8Array(t.FTYP.byteLength+r.byteLength);return n.set(t.FTYP),n.set(r,t.FTYP.byteLength),n},t}();i.types=void 0,i.HDLR_TYPES=void 0,i.STTS=void 0,i.STSC=void 0,i.STCO=void 0,i.STSZ=void 0,i.VMHD=void 0,i.SMHD=void 0,i.STSD=void 0,i.FTYP=void 0,i.DINF=void 0,e.default=i},"./src/remux/mp4-remuxer.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return g})),r.d(e,"normalizePts",(function(){return m}));var n=r("./src/polyfills/number.ts"),i=r("./src/remux/aac-helper.ts"),a=r("./src/remux/mp4-generator.ts"),s=r("./src/events.ts"),o=r("./src/errors.ts"),u=r("./src/utils/logger.ts"),l=r("./src/utils/timescale-conversion.ts");function c(){return(c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var d=1024,f=null,h=null,p=!1,g=function(){function t(t,e,r,n){if(void 0===n&&(n=""),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=t,this.config=e,this.typeSupported=r,this.ISGenerated=!1,null===f){var i=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);f=i?parseInt(i[1]):0}if(null===h){var a=navigator.userAgent.match(/Safari\/(\d+)/i);h=a?parseInt(a[1]):0}p=!!f&&f<75||!!h&&h<600}var e=t.prototype;return e.destroy=function(){},e.resetTimeStamp=function(t){u.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t},e.resetNextTimestamp=function(){u.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},e.resetInitSegment=function(){u.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},e.getVideoStartPts=function(t){var e=!1,r=t.reduce((function(t,r){var n=r.pts-t;return n<-4294967296?(e=!0,m(t,r.pts)):n>0?t:r.pts}),t[0].pts);return e&&u.logger.debug("PTS rollover detected"),r},e.remux=function(t,e,r,n,i,a,s){var o,l,c,d,f,h,p=i,g=i,v=t.pid>-1,y=e.pid>-1,b=t.samples.length>0,E=e.samples.length>1;if((!v||b)&&(!y||E)||this.ISGenerated||s){this.ISGenerated||(c=this.generateIS(t,e,i));var T=this.isVideoContiguous;if(E&&!T&&this.config.forceKeyFrameOnDiscontinuity){var S=e.samples.length,w=function(t){for(var e=0;e<t.length;e++)if(t[e].key)return e;return-1}(e.samples);if(h=!0,w>0){u.logger.warn("[mp4-remuxer]: Dropped "+w+" out of "+S+" video samples due to a missing keyframe");var _=this.getVideoStartPts(e.samples);e.samples=e.samples.slice(w),e.dropped+=w,g+=(e.samples[0].pts-_)/(e.timescale||9e4)}else-1===w&&(u.logger.warn("[mp4-remuxer]: No keyframe found out of "+S+" video samples"),h=!1)}if(this.ISGenerated){if(b&&E){var k=this.getVideoStartPts(e.samples),A=(m(t.samples[0].pts,k)-k)/e.inputTimeScale;p+=Math.max(0,A),g+=Math.max(0,-A)}if(b){if(t.samplerate||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),delete(c=this.generateIS(t,e,i)).video),l=this.remuxAudio(t,p,this.isAudioContiguous,a,E?g:void 0),E){var L=l?l.endPTS-l.startPTS:0;e.inputTimeScale||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(t,e,i)),o=this.remuxVideo(e,g,T,L)}}else E&&(o=this.remuxVideo(e,g,T,0));o&&void 0!==h&&(o.independent=h)}}return this.ISGenerated&&(r.samples.length&&(f=this.remuxID3(r,i)),n.samples.length&&(d=this.remuxText(n,i))),{audio:l,video:o,initSegment:c,independent:h,text:d,id3:f}},e.generateIS=function(t,e,r){var i,s,o,u=t.samples,l=e.samples,c=this.typeSupported,d={},f=!Object(n.isFiniteNumber)(this._initPTS),h="audio/mp4";if(f&&(i=s=1/0),t.config&&u.length&&(t.timescale=t.samplerate,t.isAAC||(c.mpeg?(h="audio/mpeg",t.codec=""):c.mp3&&(t.codec="mp3")),d.audio={id:"audio",container:h,codec:t.codec,initSegment:!t.isAAC&&c.mpeg?new Uint8Array(0):a.default.initSegment([t]),metadata:{channelCount:t.channelCount}},f&&(o=t.inputTimeScale,i=s=u[0].pts-Math.round(o*r))),e.sps&&e.pps&&l.length&&(e.timescale=e.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:e.codec,initSegment:a.default.initSegment([e]),metadata:{width:e.width,height:e.height}},f)){o=e.inputTimeScale;var p=this.getVideoStartPts(l),g=Math.round(o*r);s=Math.min(s,m(l[0].dts,p)-g),i=Math.min(i,p-g)}if(Object.keys(d).length)return this.ISGenerated=!0,f&&(this._initPTS=i,this._initDTS=s),{tracks:d,initPTS:i,timescale:o}},e.remuxVideo=function(t,e,r,n){var i,d,h,g=t.inputTimeScale,y=t.samples,b=[],E=y.length,T=this._initPTS,S=this.nextAvcDts,w=8,_=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,A=0,L=!1;r&&null!==S||(S=e*g-(y[0].pts-m(y[0].dts,y[0].pts)));for(var D=0;D<E;D++){var R=y[D];R.pts=m(R.pts-T,S),R.dts=m(R.dts-T,S),R.dts>R.pts&&(A=Math.max(Math.min(A,R.pts-R.dts),-18e3)),R.dts<y[D>0?D-1:D].dts&&(L=!0)}L&&y.sort((function(t,e){var r=t.dts-e.dts,n=t.pts-e.pts;return r||n})),d=y[0].dts,h=y[y.length-1].dts;var C=Math.round((h-d)/(E-1));if(A<0){if(A<-2*C){u.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(l.toMsFromMpegTsClock)(-C,!0)+" ms");for(var I=A,x=0;x<E;x++)y[x].dts=I=Math.max(I,y[x].pts-C),y[x].pts=Math.max(I,y[x].pts)}else{u.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(l.toMsFromMpegTsClock)(A,!0)+" ms to overcome this issue");for(var O=0;O<E;O++)y[O].dts=y[O].dts+A}d=y[0].dts}if(r){var P=d-S,M=P>C;if(M||P<-1){M?u.logger.warn("AVC: "+Object(l.toMsFromMpegTsClock)(P,!0)+" ms ("+P+"dts) hole between fragments detected, filling it"):u.logger.warn("AVC: "+Object(l.toMsFromMpegTsClock)(-P,!0)+" ms ("+P+"dts) overlapping between fragments detected"),d=S;var F=y[0].pts-P;y[0].dts=d,y[0].pts=F,u.logger.log("Video: First PTS/DTS adjusted: "+Object(l.toMsFromMpegTsClock)(F,!0)+"/"+Object(l.toMsFromMpegTsClock)(d,!0)+", delta: "+Object(l.toMsFromMpegTsClock)(P,!0)+" ms")}}p&&(d=Math.max(0,d));for(var U=0,N=0,B=0;B<E;B++){for(var G=y[B],j=G.units,H=j.length,V=0,K=0;K<H;K++)V+=j[K].data.length;N+=V,U+=H,G.length=V,G.dts=Math.max(G.dts,d),G.pts=Math.max(G.pts,G.dts,0),_=Math.min(G.pts,_),k=Math.max(G.pts,k)}h=y[E-1].dts;var z,W=N+4*U+8;try{z=new Uint8Array(W)}catch(ct){return void this.observer.emit(s.Events.ERROR,s.Events.ERROR,{type:o.ErrorTypes.MUX_ERROR,details:o.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:W,reason:"fail allocating video mdat "+W})}var Y=new DataView(z.buffer);Y.setUint32(0,W),z.set(a.default.types.mdat,4);for(var q=0;q<E;q++){for(var X=y[q],$=X.units,Q=0,J=0,Z=$.length;J<Z;J++){var tt=$[J],et=tt.data,rt=tt.data.byteLength;Y.setUint32(w,rt),w+=4,z.set(et,w),w+=rt,Q+=4+rt}if(q<E-1)i=y[q+1].dts-X.dts;else{var nt=this.config,it=X.dts-y[q>0?q-1:q].dts;if(nt.stretchShortVideoTrack&&null!==this.nextAudioPts){var at=Math.floor(nt.maxBufferHole*g),st=(n?_+n*g:this.nextAudioPts)-X.pts;st>at?((i=st-it)<0&&(i=it),u.logger.log("[mp4-remuxer]: It is approximately "+st/90+" ms to the next segment; using duration "+i/90+" ms for the last video frame.")):i=it}else i=it}var ot=Math.round(X.pts-X.dts);b.push(new v(X.key,i,Q,ot))}if(b.length&&f&&f<70){var ut=b[0].flags;ut.dependsOn=2,ut.isNonSync=0}console.assert(void 0!==i,"mp4SampleDuration must be computed"),this.nextAvcDts=S=h+i,this.isVideoContiguous=!0;var lt={data1:a.default.moof(t.sequenceNumber++,d,c({},t,{samples:b})),data2:z,startPTS:_/g,endPTS:(k+i)/g,startDTS:d/g,endDTS:S/g,type:"video",hasAudio:!1,hasVideo:!0,nb:b.length,dropped:t.dropped};return t.samples=[],t.dropped=0,console.assert(z.length,"MDAT length must not be zero"),lt},e.remuxAudio=function(t,e,r,n,l){var f,h=t.inputTimeScale,p=h/(t.samplerate?t.samplerate:h),g=t.isAAC?d:1152,y=g*p,b=this._initPTS,E=!t.isAAC&&this.typeSupported.mpeg,T=[],S=t.samples,w=E?0:8,_=this.nextAudioPts||-1,k=e*h;if(this.isAudioContiguous=r=r||S.length&&_>0&&(n&&Math.abs(k-_)<9e3||Math.abs(m(S[0].pts-b,k)-_)<20*y),S.forEach((function(t){t.pts=t.dts=m(t.pts-b,k)})),!r||_<0){if(!(S=S.filter((function(t){return t.pts>=0}))).length)return;_=0===l?0:n?Math.max(0,k):S[0].pts}if(t.isAAC)for(var A=this.config.maxAudioFramesDrift,L=0,D=_;L<S.length;){var R=S[L],C=R.pts,I=C-D,x=Math.abs(1e3*I/h);if(I<=-A*y&&void 0!==l)r||L>0?(u.logger.warn("[mp4-remuxer]: Dropping 1 audio frame @ "+(D/h).toFixed(3)+"s due to "+Math.round(x)+" ms overlap."),S.splice(L,1)):(u.logger.warn("Audio frame @ "+(C/h).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*I/h)+" ms."),D=C+y,L++);else if(I>=A*y&&x<1e4&&void 0!==l){var O=Math.floor(I/y);D=C-O*y,u.logger.warn("[mp4-remuxer]: Injecting "+O+" audio frame @ "+(D/h).toFixed(3)+"s due to "+Math.round(1e3*I/h)+" ms gap.");for(var P=0;P<O;P++){var M=Math.max(D,0);(f=i.default.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(u.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),f=R.unit.subarray()),S.splice(L,0,{unit:f,pts:M,dts:M}),D+=y,L++}R.pts=R.dts=D,D+=y,L++}else R.pts=R.dts=D,D+=y,L++}for(var F,U=null,N=null,B=0,G=S.length;G--;)B+=S[G].unit.byteLength;for(var j=0,H=S.length;j<H;j++){var V=S[j],K=V.unit,z=V.pts;if(null!==N)T[j-1].duration=Math.round((z-N)/p);else{var W=Math.round(1e3*(z-_)/h),Y=0;if(r&&t.isAAC){if(W>0&&W<1e4)Y=Math.round((z-_)/y),u.logger.log("[mp4-remuxer]: "+W+" ms hole between AAC samples detected,filling it"),Y>0&&((f=i.default.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(f=K.subarray()),B+=Y*f.length);else if(W<-12){u.logger.log("[mp4-remuxer]: drop overlapping AAC sample, expected/parsed/delta:"+(_/h).toFixed(3)+"s/"+(z/h).toFixed(3)+"s/"+-W+"ms"),B-=K.byteLength;continue}z=_}if(U=z,!(B>0))return;B+=w;try{F=new Uint8Array(B)}catch(rt){return void this.observer.emit(s.Events.ERROR,s.Events.ERROR,{type:o.ErrorTypes.MUX_ERROR,details:o.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating audio mdat "+B})}E||(new DataView(F.buffer).setUint32(0,B),F.set(a.default.types.mdat,4));for(var q=0;q<Y;q++)(f=i.default.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(u.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating the current frame instead"),f=K.subarray()),F.set(f,w),w+=f.byteLength,T.push(new v(!0,d,f.byteLength,0))}F.set(K,w);var X=K.byteLength;w+=X,T.push(new v(!0,g,X,0)),N=z}var $=T.length;if($){var Q=T[T.length-1];this.nextAudioPts=_=N+p*Q.duration;var J=E?new Uint8Array(0):a.default.moof(t.sequenceNumber++,U/p,c({},t,{samples:T}));t.samples=[];var Z=U/h,tt=_/h,et={data1:J,data2:F,startPTS:Z,endPTS:tt,startDTS:Z,endDTS:tt,type:"audio",hasAudio:!0,hasVideo:!1,nb:$};return this.isAudioContiguous=!0,console.assert(F.length,"MDAT length must not be zero"),et}},e.remuxEmptyAudio=function(t,e,r,n){var a=t.inputTimeScale,s=a/(t.samplerate?t.samplerate:a),o=this.nextAudioPts,l=(null!==o?o:n.startDTS*a)+this._initDTS,c=n.endDTS*a+this._initDTS,f=s*d,h=Math.ceil((c-l)/f),p=i.default.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(u.logger.warn("[mp4-remuxer]: remux empty Audio"),p){for(var g=[],m=0;m<h;m++){var v=l+m*f;g.push({unit:p,pts:v,dts:v})}return t.samples=g,this.remuxAudio(t,e,r,!1)}u.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},e.remuxID3=function(t,e){var r=t.samples.length;if(r){for(var n=t.inputTimeScale,i=this._initPTS,a=this._initDTS,s=0;s<r;s++){var o=t.samples[s];o.pts=m(o.pts-i,e*n)/n,o.dts=m(o.dts-a,e*n)/n}var u=t.samples;return t.samples=[],{samples:u}}},e.remuxText=function(t,e){var r=t.samples.length;if(r){for(var n=t.inputTimeScale,i=this._initPTS,a=0;a<r;a++){var s=t.samples[a];s.pts=m(s.pts-i,e*n)/n}t.samples.sort((function(t,e){return t.pts-e.pts}));var o=t.samples;return t.samples=[],{samples:o}}},t}();function m(t,e){var r;if(null===e)return t;for(r=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=r;return t}var v=function(t,e,r,n){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=e,this.size=r,this.cts=n,this.flags=new y(t)},y=function(t){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=t?2:1,this.isNonSync=t?0:1}},"./src/remux/passthrough-remuxer.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/polyfills/number.ts"),i=r("./src/utils/mp4-tools.ts"),a=r("./src/loader/fragment.ts"),s=r("./src/utils/logger.ts"),o=function(){function t(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var e=t.prototype;return e.destroy=function(){},e.resetTimeStamp=function(t){this.initPTS=t,this.lastEndDTS=null},e.resetNextTimestamp=function(){this.lastEndDTS=null},e.resetInitSegment=function(t,e,r){this.audioCodec=e,this.videoCodec=r,this.generateInitSegment(t),this.emitInitSegment=!0},e.generateInitSegment=function(t){var e=this.audioCodec,r=this.videoCodec;if(!t||!t.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var n=this.initData=Object(i.parseInitSegment)(t);e||(e=l(n.audio,a.ElementaryStreamTypes.AUDIO)),r||(r=l(n.video,a.ElementaryStreamTypes.VIDEO));var o={};n.audio&&n.video?o.audiovideo={container:"video/mp4",codec:e+","+r,initSegment:t,id:"main"}:n.audio?o.audio={container:"audio/mp4",codec:e,initSegment:t,id:"audio"}:n.video?o.video={container:"video/mp4",codec:r,initSegment:t,id:"main"}:s.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=o},e.remux=function(t,e,r,a,o){var l=this.initPTS,c=this.lastEndDTS,d={audio:void 0,video:void 0,text:a,id3:r,initSegment:void 0};Object(n.isFiniteNumber)(c)||(c=this.lastEndDTS=o||0);var f=e.samples;if(!f||!f.length)return d;var h={initPTS:void 0,timescale:1},p=this.initData;if(p&&p.length||(this.generateInitSegment(f),p=this.initData),!p||!p.length)return s.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1),Object(n.isFiniteNumber)(l)||(this.initPTS=h.initPTS=l=u(p,f,c));var g=Object(i.getDuration)(f,p),m=c,v=g+m;Object(i.offsetStartDTS)(p,f,l),g>0?this.lastEndDTS=v:(s.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var y=!!p.audio,b=!!p.video,E="";y&&(E+="audio"),b&&(E+="video");var T={data1:f,startPTS:m,startDTS:m,endPTS:v,endDTS:v,type:E,hasAudio:y,hasVideo:b,nb:1,dropped:0};return d.audio="audio"===T.type?T:void 0,d.video="audio"!==T.type?T:void 0,d.text=a,d.id3=r,d.initSegment=h,d},t}(),u=function(t,e,r){return Object(i.getStartDTS)(t,e)-r};function l(t,e){var r=null===t||void 0===t?void 0:t.codec;return r&&r.length>4?r:"hvc1"===r?"hvc1.1.c.L120.90":"av01"===r?"av01.0.04M.08":"avc1"===r||e===a.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}e.default=o},"./src/task-loop.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return n}));var n=function(){function t(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var e=t.prototype;return e.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},e.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},e.onHandlerDestroyed=function(){},e.hasInterval=function(){return!!this._tickInterval},e.hasNextTick=function(){return!!this._tickTimer},e.setInterval=function(t){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,t),!0)},e.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},e.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},e.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},e.doTick=function(){},t}()},"./src/types/level.ts":function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i;function a(t,e){var r=t.canSkipUntil,n=t.canSkipDateRanges,a=t.endSN;return r&&(void 0!==e?e-a:0)<r?n?i.v2:i.Yes:i.No}r.r(e),r.d(e,"HlsSkip",(function(){return i})),r.d(e,"getSkipValue",(function(){return a})),r.d(e,"HlsUrlParameters",(function(){return s})),r.d(e,"Level",(function(){return o})),function(t){t.No="",t.Yes="YES",t.v2="v2"}(i||(i={}));var s=function(){function t(t,e,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=e,this.skip=r}return t.prototype.addDirectives=function(t){var e=new self.URL(t),r=e.searchParams;return void 0!==this.msn&&r.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&r.set("_HLS_part",this.part.toString()),this.skip&&r.set("_HLS_skip",this.skip),r.sort(),e.search=r.toString(),e.toString()},t}(),o=function(){function t(t){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[t.url],this.attrs=t.attrs,this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.unknownCodecs=t.unknownCodecs,this.codecSet=[t.videoCodec,t.audioCodec].filter((function(t){return t})).join(",").replace(/\.[^.,]+/g,"")}var e,r,i;return e=t,(r=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(t){var e=t%this.url.length;this._urlId!==e&&(this.details=void 0,this._urlId=e)}}])&&n(e.prototype,r),i&&n(e,i),t}()},"./src/types/loader.ts":function(t,e,r){"use strict";var n,i;r.r(e),r.d(e,"PlaylistContextType",(function(){return n})),r.d(e,"PlaylistLevelType",(function(){return i})),function(t){t.MANIFEST="manifest",t.LEVEL="level",t.AUDIO_TRACK="audioTrack",t.SUBTITLE_TRACK="subtitleTrack"}(n||(n={})),function(t){t.MAIN="main",t.AUDIO="audio",t.SUBTITLE="subtitle"}(i||(i={}))},"./src/types/transmuxer.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"ChunkMetadata",(function(){return n}));var n=function(t,e,r,n,i,a){void 0===n&&(n=0),void 0===i&&(i=-1),void 0===a&&(a=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=e,this.id=r,this.size=n,this.part=i,this.partial=a}},"./src/utils/attr-list.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"AttrList",(function(){return a}));var n=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,a=function(){function t(e){for(var r in"string"===typeof e&&(e=t.parseAttrList(e)),e)e.hasOwnProperty(r)&&(this[r]=e[r])}var e=t.prototype;return e.decimalInteger=function(t){var e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},e.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var r=new Uint8Array(e.length/2),n=0;n<e.length/2;n++)r[n]=parseInt(e.slice(2*n,2*n+2),16);return r}return null},e.hexadecimalIntegerAsNumber=function(t){var e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},e.decimalFloatingPoint=function(t){return parseFloat(this[t])},e.optionalFloat=function(t,e){var r=this[t];return r?parseFloat(r):e},e.enumeratedString=function(t){return this[t]},e.bool=function(t){return"YES"===this[t]},e.decimalResolution=function(t){var e=n.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},t.parseAttrList=function(t){var e,r={};for(i.lastIndex=0;null!==(e=i.exec(t));){var n=e[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[e[1]]=n}return r},t}()},"./src/utils/binary-search.ts":function(t,e,r){"use strict";r.r(e),e.default={search:function(t,e){for(var r=0,n=t.length-1,i=null,a=null;r<=n;){var s=e(a=t[i=(r+n)/2|0]);if(s>0)r=i+1;else{if(!(s<0))return a;n=i-1}}return null}}},"./src/utils/buffer-helper.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"BufferHelper",(function(){return a}));var n=r("./src/utils/logger.ts"),i={length:0,start:function(){return 0},end:function(){return 0}},a=function(){function t(){}return t.isBuffered=function(e,r){try{if(e)for(var n=t.getBuffered(e),i=0;i<n.length;i++)if(r>=n.start(i)&&r<=n.end(i))return!0}catch(a){}return!1},t.bufferInfo=function(e,r,n){try{if(e){var i,a=t.getBuffered(e),s=[];for(i=0;i<a.length;i++)s.push({start:a.start(i),end:a.end(i)});return this.bufferedInfo(s,r,n)}}catch(o){}return{len:0,start:r,end:r,nextStart:void 0}},t.bufferedInfo=function(t,e,r){t.sort((function(t,e){var r=t.start-e.start;return r||e.end-t.end}));var n=[];if(r)for(var i=0;i<t.length;i++){var a=n.length;if(a){var s=n[a-1].end;t[i].start-s<r?t[i].end>s&&(n[a-1].end=t[i].end):n.push(t[i])}else n.push(t[i])}else n=t;for(var o,u=0,l=e,c=e,d=0;d<n.length;d++){var f=n[d].start,h=n[d].end;if(e+r>=f&&e<h)l=f,u=(c=h)-e;else if(e+r<f){o=f;break}}return{len:u,start:l||0,end:c||0,nextStart:o}},t.getBuffered=function(t){try{return t.buffered}catch(e){return n.logger.log("failed to get media.buffered",e),i}},t}()},"./src/utils/cea-608-parser.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"Row",(function(){return y})),r.d(e,"CaptionScreen",(function(){return b}));var n,i=r("./src/utils/logger.ts"),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},s=function(t){var e=t;return a.hasOwnProperty(t)&&(e=a[t]),String.fromCharCode(e)},o=15,u=100,l={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},c={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(t){t[t.ERROR=0]="ERROR",t[t.TEXT=1]="TEXT",t[t.WARNING=2]="WARNING",t[t.INFO=2]="INFO",t[t.DEBUG=3]="DEBUG",t[t.DATA=3]="DATA"}(n||(n={}));var p=function(){function t(){this.time=null,this.verboseLevel=n.ERROR}return t.prototype.log=function(t,e){this.verboseLevel>=t&&i.logger.log(this.time+" ["+t+"] "+e)},t}(),g=function(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r].toString(16));return e},m=function(){function t(t,e,r,n,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=t||"white",this.underline=e||!1,this.italics=r||!1,this.background=n||"black",this.flash=i||!1}var e=t.prototype;return e.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.setStyles=function(t){for(var e=["foreground","underline","italics","background","flash"],r=0;r<e.length;r++){var n=e[r];t.hasOwnProperty(n)&&(this[n]=t[n])}},e.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},e.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},e.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},t}(),v=function(){function t(t,e,r,n,i,a){this.uchar=void 0,this.penState=void 0,this.uchar=t||" ",this.penState=new m(e,r,n,i,a)}var e=t.prototype;return e.reset=function(){this.uchar=" ",this.penState.reset()},e.setChar=function(t,e){this.uchar=t,this.penState.copy(e)},e.setPenState=function(t){this.penState.copy(t)},e.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},e.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},e.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},t}(),y=function(){function t(t){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var e=0;e<u;e++)this.chars.push(new v);this.logger=t,this.pos=0,this.currPenState=new m}var e=t.prototype;return e.equals=function(t){for(var e=!0,r=0;r<u;r++)if(!this.chars[r].equals(t.chars[r])){e=!1;break}return e},e.copy=function(t){for(var e=0;e<u;e++)this.chars[e].copy(t.chars[e])},e.isEmpty=function(){for(var t=!0,e=0;e<u;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},e.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(n.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>u&&(this.logger.log(n.DEBUG,"Too large cursor position "+this.pos),this.pos=u)},e.moveCursor=function(t){var e=this.pos+t;if(t>1)for(var r=this.pos+1;r<e+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(e)},e.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.insertChar=function(t){t>=144&&this.backSpace();var e=s(t);this.pos>=u?this.logger.log(n.ERROR,"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))},e.clearFromPos=function(t){var e;for(e=t;e<u;e++)this.chars[e].reset()},e.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.getTextString=function(){for(var t=[],e=!0,r=0;r<u;r++){var n=this.chars[r].uchar;" "!==n&&(e=!1),t.push(n)}return e?"":t.join("")},e.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},t}(),b=function(){function t(t){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var e=0;e<o;e++)this.rows.push(new y(t));this.logger=t,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var e=t.prototype;return e.reset=function(){for(var t=0;t<o;t++)this.rows[t].clear();this.currRow=14},e.equals=function(t){for(var e=!0,r=0;r<o;r++)if(!this.rows[r].equals(t.rows[r])){e=!1;break}return e},e.copy=function(t){for(var e=0;e<o;e++)this.rows[e].copy(t.rows[e])},e.isEmpty=function(){for(var t=!0,e=0;e<o;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},e.backSpace=function(){this.rows[this.currRow].backSpace()},e.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.insertChar=function(t){this.rows[this.currRow].insertChar(t)},e.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},e.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},e.setCursor=function(t){this.logger.log(n.INFO,"setCursor: "+t),this.rows[this.currRow].setCursor(t)},e.setPAC=function(t){this.logger.log(n.INFO,"pacData = "+JSON.stringify(t));var e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(var r=0;r<o;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){var s=a.rows[i].cueStartTime,u=this.logger.time;if(s&&null!==u&&s<u)for(var l=0;l<this.nrRollUpRows;l++)this.rows[e-this.nrRollUpRows+l+1].copy(a.rows[i+l])}}this.currRow=e;var c=this.rows[this.currRow];if(null!==t.indent){var d=t.indent,f=Math.max(d-1,0);c.setCursor(t.indent),t.color=c.chars[f].penState.foreground}var h={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(h)},e.setBkgData=function(t){this.logger.log(n.INFO,"bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},e.setRollUpRows=function(t){this.nrRollUpRows=t},e.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(n.TEXT,this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(n.INFO,"Rolling up")}else this.logger.log(n.DEBUG,"roll_up but nrRollUpRows not set yet")},e.getDisplayText=function(t){t=t||!1;for(var e=[],r="",n=-1,i=0;i<o;i++){var a=this.rows[i].getTextString();a&&(n=i+1,t?e.push("Row "+n+": '"+a+"'"):e.push(a.trim()))}return e.length>0&&(r=t?"["+e.join(" | ")+"]":e.join("\n")),r},e.getTextAndFormat=function(){return this.rows},t}(),E=function(){function t(t,e,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new b(r),this.nonDisplayedMemory=new b(r),this.lastOutputScreen=new b(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var e=t.prototype;return e.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},e.getHandler=function(){return this.outputFilter},e.setHandler=function(t){this.outputFilter=t},e.setPAC=function(t){this.writeScreen.setPAC(t)},e.setBkgData=function(t){this.writeScreen.setBkgData(t)},e.setMode=function(t){t!==this.mode&&(this.mode=t,this.logger.log(n.INFO,"MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},e.insertChars=function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(n.INFO,r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(n.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.ccRCL=function(){this.logger.log(n.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.ccBS=function(){this.logger.log(n.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.ccAOF=function(){},e.ccAON=function(){},e.ccDER=function(){this.logger.log(n.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.ccRU=function(t){this.logger.log(n.INFO,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},e.ccFON=function(){this.logger.log(n.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.ccRDC=function(){this.logger.log(n.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.ccTR=function(){this.logger.log(n.INFO,"TR"),this.setMode("MODE_TEXT")},e.ccRTD=function(){this.logger.log(n.INFO,"RTD"),this.setMode("MODE_TEXT")},e.ccEDM=function(){this.logger.log(n.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.ccCR=function(){this.logger.log(n.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.ccENM=function(){this.logger.log(n.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.ccEOC=function(){if(this.logger.log(n.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(n.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.ccTO=function(t){this.logger.log(n.INFO,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},e.ccMIDROW=function(t){var e={flash:!1};if(e.underline=t%2===1,e.italics=t>=46,e.italics)e.foreground="white";else{var r=Math.floor(t/2)-16;e.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(n.INFO,"MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},e.outputDataUpdate=function(t){void 0===t&&(t=!1);var e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},e.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},t}(),T=function(){function t(t,e,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var n=new p;this.channels=[null,new E(t,e,n),new E(t+1,r,n)],this.cmdHistory={a:null,b:null},this.logger=n}var e=t.prototype;return e.getHandler=function(t){return this.channels[t].getHandler()},e.setHandler=function(t,e){this.channels[t].setHandler(e)},e.addData=function(t,e){var r,i,a,s=!1;this.logger.time=t;for(var o=0;o<e.length;o+=2)if(i=127&e[o],a=127&e[o+1],0!==i||0!==a){if(this.logger.log(n.DATA,"["+g([e[o],e[o+1]])+"] -> ("+g([i,a])+")"),(r=this.parseCmd(i,a))||(r=this.parseMidrow(i,a)),r||(r=this.parsePAC(i,a)),r||(r=this.parseBackgroundAttributes(i,a)),!r&&(s=this.parseChars(i,a))){var u=this.currentChannel;u&&u>0?this.channels[u].insertChars(s):this.logger.log(n.WARNING,"No channel found yet. TEXT-MODE?")}r||s||this.logger.log(n.WARNING,"Couldn't parse cleaned data "+g([i,a])+" orig: "+g([e[o],e[o+1]]))}},e.parseCmd=function(t,e){var r=this.cmdHistory;if(!((20===t||28===t||21===t||29===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=33&&e<=35))return!1;if(w(t,e,r))return S(null,null,r),this.logger.log(n.DEBUG,"Repeated command ("+g([t,e])+") is dropped"),!0;var i=20===t||21===t||23===t?1:2,a=this.channels[i];return 20===t||21===t||28===t||29===t?32===e?a.ccRCL():33===e?a.ccBS():34===e?a.ccAOF():35===e?a.ccAON():36===e?a.ccDER():37===e?a.ccRU(2):38===e?a.ccRU(3):39===e?a.ccRU(4):40===e?a.ccFON():41===e?a.ccRDC():42===e?a.ccTR():43===e?a.ccRTD():44===e?a.ccEDM():45===e?a.ccCR():46===e?a.ccENM():47===e&&a.ccEOC():a.ccTO(e-32),S(t,e,r),this.currentChannel=i,!0},e.parseMidrow=function(t,e){var r=0;if((17===t||25===t)&&e>=32&&e<=47){if((r=17===t?1:2)!==this.currentChannel)return this.logger.log(n.ERROR,"Mismatch channel in midrow parsing"),!1;var i=this.channels[r];return!!i&&(i.ccMIDROW(e),this.logger.log(n.DEBUG,"MIDROW ("+g([t,e])+")"),!0)}return!1},e.parsePAC=function(t,e){var r,n=this.cmdHistory;if(!((t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127)&&!((16===t||24===t)&&e>=64&&e<=95))return!1;if(w(t,e,n))return S(null,null,n),!0;var i=t<=23?1:2;r=e>=64&&e<=95?1===i?l[t]:d[t]:1===i?c[t]:f[t];var a=this.channels[i];return!!a&&(a.setPAC(this.interpretPAC(r,e)),S(t,e,n),this.currentChannel=i,!0)},e.interpretPAC=function(t,e){var r,n={color:null,italics:!1,indent:null,underline:!1,row:t};return r=e>95?e-96:e-64,n.underline=1===(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},e.parseChars=function(t,e){var r,i,a=null,o=null;if(t>=25?(r=2,o=t-8):(r=1,o=t),o>=17&&o<=19?(i=17===o?e+80:18===o?e+112:e+144,this.logger.log(n.INFO,"Special char '"+s(i)+"' in channel "+r),a=[i]):t>=32&&t<=127&&(a=0===e?[t]:[t,e]),a){var u=g(a);this.logger.log(n.DEBUG,"Char codes =  "+u.join(",")),S(t,e,this.cmdHistory)}return a},e.parseBackgroundAttributes=function(t,e){var r;if(!((16===t||24===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=45&&e<=47))return!1;var n={};16===t||24===t?(r=Math.floor((e-32)/2),n.background=h[r],e%2===1&&(n.background=n.background+"_semi")):45===e?n.background="transparent":(n.foreground="black",47===e&&(n.underline=!0));var i=t<=23?1:2;return this.channels[i].setBkgData(n),S(t,e,this.cmdHistory),!0},e.reset=function(){for(var t=0;t<Object.keys(this.channels).length;t++){var e=this.channels[t];e&&e.reset()}this.cmdHistory={a:null,b:null}},e.cueSplitAtTime=function(t){for(var e=0;e<this.channels.length;e++){var r=this.channels[e];r&&r.cueSplitAtTime(t)}},t}();function S(t,e,r){r.a=t,r.b=e}function w(t,e,r){return r.a===t&&r.b===e}e.default=T},"./src/utils/codecs.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"isCodecType",(function(){return i})),r.d(e,"isCodecSupportedInMp4",(function(){return a}));var n={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function i(t,e){var r=n[e];return!!r&&!0===r[t.slice(0,4)]}function a(t,e){return MediaSource.isTypeSupported((e||"video")+'/mp4;codecs="'+t+'"')}},"./src/utils/cues.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/utils/vttparser.ts"),i=r("./src/utils/webvtt-parser.ts"),a=r("./src/utils/texttrack-utils.ts"),s=/\s/,o={newCue:function(t,e,r,o){for(var u,l,c,d,f,h=[],p=self.VTTCue||self.TextTrackCue,g=0;g<o.rows.length;g++)if(c=!0,d=0,f="",!(u=o.rows[g]).isEmpty()){for(var m=0;m<u.chars.length;m++)s.test(u.chars[m].uchar)&&c?d++:(f+=u.chars[m].uchar,c=!1);u.cueStartTime=e,e===r&&(r+=1e-4),d>=16?d--:d++;var v=Object(n.fixLineBreaks)(f.trim()),y=Object(i.generateCueId)(e,r,v);t&&t.cues&&t.cues.getCueById(y)||((l=new p(e,r,v)).id=y,l.line=g+1,l.align="left",l.position=10+Math.min(80,10*Math.floor(8*d/32)),h.push(l))}return t&&h.length&&(h.sort((function(t,e){return"auto"===t.line||"auto"===e.line?0:t.line>8&&e.line>8?e.line-t.line:t.line-e.line})),h.forEach((function(e){return Object(a.addCueToTrack)(t,e)}))),h}};e.default=o},"./src/utils/discontinuities.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"findFirstFragWithCC",(function(){return s})),r.d(e,"shouldAlignOnDiscontinuities",(function(){return o})),r.d(e,"findDiscontinuousReferenceFrag",(function(){return u})),r.d(e,"adjustSlidingStart",(function(){return c})),r.d(e,"alignStream",(function(){return d})),r.d(e,"alignPDT",(function(){return f}));var n=r("./src/polyfills/number.ts"),i=r("./src/utils/logger.ts"),a=r("./src/controller/level-helper.ts");function s(t,e){for(var r=null,n=0,i=t.length;n<i;n++){var a=t[n];if(a&&a.cc===e){r=a;break}}return r}function o(t,e,r){return!(!e.details||!(r.endCC>r.startCC||t&&t.cc<r.startCC))}function u(t,e){var r=t.fragments,n=e.fragments;if(n.length&&r.length){var a=s(r,n[0].cc);if(a&&(!a||a.startPTS))return a;i.logger.log("No frag in previous level to align on")}else i.logger.log("No fragments to align")}function l(t,e){if(t){var r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}}function c(t,e){for(var r=e.fragments,n=0,i=r.length;n<i;n++)l(r[n],t);e.fragmentHint&&l(e.fragmentHint,t),e.alignedSliding=!0}function d(t,e,r){e&&(function(t,e,r){if(o(t,r,e)){var a=u(r.details,e);a&&Object(n.isFiniteNumber)(a.start)&&(i.logger.log("Adjusting PTS using last level due to CC increase within current level "+e.url),c(a.start,e))}}(t,r,e),!r.alignedSliding&&e.details&&f(r,e.details),r.alignedSliding||!e.details||r.skippedSegments||Object(a.adjustSliding)(e.details,r))}function f(t,e){if(e.fragments.length&&t.hasProgramDateTime&&e.hasProgramDateTime){var r=e.fragments[0].programDateTime,a=t.fragments[0].programDateTime,s=(a-r)/1e3+e.fragments[0].start;s&&Object(n.isFiniteNumber)(s)&&(i.logger.log("Adjusting PTS using programDateTime delta "+(a-r)+"ms, sliding:"+s.toFixed(3)+" "+t.url+" "),c(s,t))}}},"./src/utils/ewma-bandwidth-estimator.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/utils/ewma.ts"),i=function(){function t(t,e,r){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new n.default(t),this.fast_=new n.default(e)}var e=t.prototype;return e.update=function(t,e){var r=this.slow_,i=this.fast_;this.slow_.halfLife!==t&&(this.slow_=new n.default(t,r.getEstimate(),r.getTotalWeight())),this.fast_.halfLife!==e&&(this.fast_=new n.default(e,i.getEstimate(),i.getTotalWeight()))},e.sample=function(t,e){var r=(t=Math.max(t,this.minDelayMs_))/1e3,n=8*e/r;this.fast_.sample(r,n),this.slow_.sample(r,n)},e.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},e.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.destroy=function(){},t}();e.default=i},"./src/utils/ewma.ts":function(t,e,r){"use strict";r.r(e);var n=function(){function t(t,e,r){void 0===e&&(e=0),void 0===r&&(r=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=e,this.totalWeight_=r}var e=t.prototype;return e.sample=function(t,e){var r=Math.pow(this.alpha_,t);this.estimate_=e*(1-r)+r*this.estimate_,this.totalWeight_+=t},e.getTotalWeight=function(){return this.totalWeight_},e.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_},t}();e.default=n},"./src/utils/fetch-loader.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"fetchSupported",(function(){return d}));var n=r("./src/polyfills/number.ts"),i=r("./src/loader/load-stats.ts"),a=r("./src/demux/chunk-cache.ts");function s(t){var e="function"===typeof Map?new Map:void 0;return(s=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return o(t,arguments,c(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,t)})(t)}function o(t,e,r){return(o=u()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&l(i,r.prototype),i}).apply(null,arguments)}function u(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(t){}return!1}var f=function(){function t(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||h,this.controller=new self.AbortController,this.stats=new i.LoadStats}var e=t.prototype;return e.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},e.abortInternal=function(){this.stats.aborted=!0,this.controller.abort()},e.abort=function(){var t;this.abortInternal(),null!==(t=this.callbacks)&&void 0!==t&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},e.load=function(t,e,r){var i=this,a=this.stats;if(a.loading.start)throw new Error("Loader can only be used once.");a.loading.start=self.performance.now();var s=function(t,e){var r={method:"GET",mode:"cors",credentials:"same-origin",signal:e};return t.rangeEnd&&(r.headers=new self.Headers({Range:"bytes="+t.rangeStart+"-"+String(t.rangeEnd-1)})),r}(t,this.controller.signal),o=r.onProgress,u="arraybuffer"===t.responseType,l=u?"byteLength":"length";this.context=t,this.config=e,this.callbacks=r,this.request=this.fetchSetup(t,s),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout((function(){i.abortInternal(),r.onTimeout(a,t,i.response)}),e.timeout),self.fetch(this.request).then((function(r){if(i.response=i.loader=r,!r.ok){var s=r.status,l=r.statusText;throw new p(l||"fetch, bad network response",s,r)}return a.loading.first=Math.max(self.performance.now(),a.loading.start),a.total=parseInt(r.headers.get("Content-Length")||"0"),o&&Object(n.isFiniteNumber)(e.highWaterMark)&&i.loadProgressively(r,a,t,e.highWaterMark,o),u?r.arrayBuffer():r.text()})).then((function(s){var u=i.response;self.clearTimeout(i.requestTimeout),a.loading.end=Math.max(self.performance.now(),a.loading.first),a.loaded=a.total=s[l];var c={url:u.url,data:s};o&&!Object(n.isFiniteNumber)(e.highWaterMark)&&o(a,t,s,u),r.onSuccess(c,a,t,u)})).catch((function(e){if(self.clearTimeout(i.requestTimeout),!a.aborted){var n=e.code||0;r.onError({code:n,text:e.message},t,e.details)}}))},e.getResponseHeader=function(t){if(this.response)try{return this.response.headers.get(t)}catch(e){}return null},e.loadProgressively=function(t,e,r,n,i){void 0===n&&(n=0);var s=new a.default,o=t.clone().body.getReader();!function a(){o.read().then((function(o){if(o.done)s.dataLength&&i(e,r,s.flush(),t);else{var u=o.value,l=u.length;e.loaded+=l,l<n||s.dataLength?(s.push(u),s.dataLength>=n&&i(e,r,s.flush(),t)):i(e,r,u,t),a()}})).catch((function(){}))}()},t}();function h(t,e){return new self.Request(t.url,e)}var p=function(t){var e,r;function n(e,r,n){var i;return(i=t.call(this,e)||this).code=void 0,i.details=void 0,i.code=r,i.details=n,i}return r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,l(e,r),n}(s(Error));e.default=f},"./src/utils/imsc1-ttml-parser.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"IMSC1_CODEC",(function(){return c})),r.d(e,"parseIMSC1",(function(){return h}));var n=r("./src/utils/mp4-tools.ts"),i=r("./src/utils/vttparser.ts"),a=r("./src/utils/vttcue.ts"),s=r("./src/demux/id3.ts"),o=r("./src/utils/timescale-conversion.ts"),u=r("./src/utils/webvtt-parser.ts");function l(){return(l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var c="stpp.ttml.im1t",d=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,f=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/;function h(t,e,r,i,c){var d=Object(n.findBox)(new Uint8Array(t),["mdat"]);if(0!==d.length){var f=d[0],h=Object(s.utf8ArrayToStr)(new Uint8Array(t,f.start,f.end-f.start)),E=Object(o.toTimescaleFromScale)(e,1,r);try{i(function(t,e){var r=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");var n={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},i=Object.keys(n).reduce((function(t,e){return t[e]=r.getAttribute("ttp:"+e)||n[e],t}),{}),s="preserve"!==r.getAttribute("xml:space"),o=g(p(r,"styling","style")),c=g(p(r,"layout","region")),d=p(r,"body","[begin]");return[].map.call(d,(function(t){var r=m(t,s);if(!r||!t.hasAttribute("begin"))return null;var n=b(t.getAttribute("begin"),i),d=b(t.getAttribute("dur"),i),f=b(t.getAttribute("end"),i);if(null===n)throw y(t);if(null===f){if(null===d)throw y(t);f=n+d}var h=new a.default(n-e,f-e,r);h.id=Object(u.generateCueId)(h.startTime,h.endTime,h.text);var p=c[t.getAttribute("region")],g=o[t.getAttribute("style")];h.position=10,h.size=80;var E=function(t,e){var r="http://www.w3.org/ns/ttml#styling";return["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((function(n,i){var a=v(e,r,i)||v(t,r,i);return a&&(n[i]=a),n}),{})}(p,g),T=E.textAlign;if(T){var S={left:"start",center:"center",right:"end",start:"start",end:"end"}[T];S&&(h.lineAlign=S),h.align=T}return l(h,E),h})).filter((function(t){return null!==t}))}(h,E))}catch(T){c(T)}}else c(new Error("Could not parse IMSC1 mdat"))}function p(t,e,r){var n=t.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(r)):[]}function g(t){return t.reduce((function(t,e){var r=e.getAttribute("xml:id");return r&&(t[r]=e),t}),{})}function m(t,e){return[].slice.call(t.childNodes).reduce((function(t,r,n){var i;return"br"===r.nodeName&&n?t+"\n":null!==(i=r.childNodes)&&void 0!==i&&i.length?m(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent}),"")}function v(t,e,r){return t.hasAttributeNS(e,r)?t.getAttributeNS(e,r):null}function y(t){return new Error("Could not parse ttml timestamp "+t)}function b(t,e){if(!t)return null;var r=Object(i.parseTimeStamp)(t);return null===r&&(d.test(t)?r=function(t,e){var r=d.exec(t),n=(0|r[4])+(0|r[5])/e.subFrameRate;return 3600*(0|r[1])+60*(0|r[2])+(0|r[3])+n/e.frameRate}(t,e):f.test(t)&&(r=function(t,e){var r=f.exec(t),n=Number(r[1]);switch(r[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}(t,e))),r}},"./src/utils/logger.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"enableLogs",(function(){return o})),r.d(e,"logger",(function(){return u}));var n=function(){},i={trace:n,debug:n,log:n,warn:n,info:n,error:n},a=i;function s(t){var e=self.console[t];return e?e.bind(self.console,"["+t+"] >"):n}function o(t){if(self.console&&!0===t||"object"===typeof t){!function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];r.forEach((function(e){a[e]=t[e]?t[e].bind(t):s(e)}))}(t,"debug","log","info","warn","error");try{a.log()}catch(e){a=i}}else a=i}var u=i},"./src/utils/mediakeys-helper.ts":function(t,e,r){"use strict";var n;r.r(e),r.d(e,"KeySystems",(function(){return n})),r.d(e,"requestMediaKeySystemAccess",(function(){return i})),function(t){t.WIDEVINE="com.widevine.alpha",t.PLAYREADY="com.microsoft.playready"}(n||(n={}));var i="undefined"!==typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null},"./src/utils/mediasource-helper.ts":function(t,e,r){"use strict";function n(){return self.MediaSource||self.WebKitMediaSource}r.r(e),r.d(e,"getMediaSource",(function(){return n}))},"./src/utils/mp4-tools.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"bin2str",(function(){return o})),r.d(e,"readUint16",(function(){return u})),r.d(e,"readUint32",(function(){return l})),r.d(e,"writeUint32",(function(){return c})),r.d(e,"findBox",(function(){return d})),r.d(e,"parseSegmentIndex",(function(){return f})),r.d(e,"parseInitSegment",(function(){return h})),r.d(e,"getStartDTS",(function(){return p})),r.d(e,"getDuration",(function(){return g})),r.d(e,"computeRawDurationFromSamples",(function(){return m})),r.d(e,"offsetStartDTS",(function(){return v})),r.d(e,"segmentValidRange",(function(){return y})),r.d(e,"appendUint8Array",(function(){return b}));var n=r("./src/utils/typed-array.ts"),i=r("./src/loader/fragment.ts"),a=Math.pow(2,32)-1,s=[].push;function o(t){return String.fromCharCode.apply(null,t)}function u(t,e){"data"in t&&(e+=t.start,t=t.data);var r=t[e]<<8|t[e+1];return r<0?65536+r:r}function l(t,e){"data"in t&&(e+=t.start,t=t.data);var r=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return r<0?4294967296+r:r}function c(t,e,r){"data"in t&&(e+=t.start,t=t.data),t[e]=r>>24,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r}function d(t,e){var r,n,i,a=[];if(!e.length)return a;"data"in t?(r=t.data,n=t.start,i=t.end):(n=0,i=(r=t).byteLength);for(var u=n;u<i;){var c=l(r,u),f=c>1?u+c:i;if(o(r.subarray(u+4,u+8))===e[0])if(1===e.length)a.push({data:r,start:u+8,end:f});else{var h=d({data:r,start:u+8,end:f},e.slice(1));h.length&&s.apply(a,h)}u=f}return a}function f(t){var e=d(t,["moov"])[0],r=e?e.end:null,n=d(t,["sidx"]);if(!n||!n[0])return null;var i=[],a=n[0],s=a.data[0],o=0===s?8:16,c=l(a,o);o+=4,o+=0===s?8:16,o+=2;var f=a.end+0,h=u(a,o);o+=2;for(var p=0;p<h;p++){var g=o,m=l(a,g);g+=4;var v=2147483647&m;if(1===(2147483648&m)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;var y=l(a,g);g+=4,i.push({referenceSize:v,subsegmentDuration:y,info:{duration:y/c,start:f,end:f+v-1}}),f+=v,o=g+=4}return{earliestPresentationTime:0,timescale:c,version:s,referencesCount:h,references:i,moovEndOffset:r}}function h(t){for(var e=[],r=d(t,["moov","trak"]),n=0;n<r.length;n++){var a=r[n],s=d(a,["tkhd"])[0];if(s){var u=s.data[s.start],c=0===u?12:20,f=l(s,c),h=d(a,["mdia","mdhd"])[0];if(h){var p=l(h,c=0===(u=h.data[h.start])?12:20),g=d(a,["mdia","hdlr"])[0];if(g){var m=o(g.data.subarray(g.start+8,g.start+12)),v={soun:i.ElementaryStreamTypes.AUDIO,vide:i.ElementaryStreamTypes.VIDEO}[m];if(v){var y=d(a,["mdia","minf","stbl","stsd"])[0],b=void 0;y&&(b=o(y.data.subarray(y.start+12,y.start+16))),e[f]={timescale:p,type:v},e[v]={timescale:p,id:f,codec:b}}}}}}return d(t,["moov","mvex","trex"]).forEach((function(t){var r=l(t,4),n=e[r];n&&(n.default={duration:l(t,12),flags:l(t,20)})})),e}function p(t,e){return d(e,["moof","traf"]).reduce((function(e,r){var n=d(r,["tfdt"])[0],i=n.data[n.start],a=d(r,["tfhd"]).reduce((function(e,r){var a=l(r,4),s=t[a];if(s){var o=l(n,4);1===i&&(o*=Math.pow(2,32),o+=l(n,8));var u=o/(s.timescale||9e4);if(isFinite(u)&&(null===e||u<e))return u}return e}),null);return null!==a&&isFinite(a)&&(null===e||a<e)?a:e}),null)||0}function g(t,e){for(var r=0,n=0,a=0,s=d(t,["moof","traf"]),o=0;o<s.length;o++){var u=s[o],c=d(u,["tfhd"])[0],h=e[l(c,4)];if(h){var p=h.default,g=l(c,0)|(null===p||void 0===p?void 0:p.flags),v=null===p||void 0===p?void 0:p.duration;8&g&&(v=l(c,2&g?12:8));for(var y=h.timescale||9e4,b=d(u,["trun"]),E=0;E<b.length;E++)r=v?v*l(b[E],4):m(b[E]),h.type===i.ElementaryStreamTypes.VIDEO?n+=r/y:h.type===i.ElementaryStreamTypes.AUDIO&&(a+=r/y)}}if(0===n&&0===a){var T=f(t);if(null!==T&&void 0!==T&&T.references)return T.references.reduce((function(t,e){return t+e.info.duration||0}),0)}return n||a}function m(t){var e=l(t,0),r=8;1&e&&(r+=4),4&e&&(r+=4);for(var n=0,i=l(t,4),a=0;a<i;a++)256&e&&(n+=l(t,r),r+=4),512&e&&(r+=4),1024&e&&(r+=4),2048&e&&(r+=4);return n}function v(t,e,r){d(e,["moof","traf"]).forEach((function(e){d(e,["tfhd"]).forEach((function(n){var i=l(n,4),s=t[i];if(s){var o=s.timescale||9e4;d(e,["tfdt"]).forEach((function(t){var e=t.data[t.start],n=l(t,4);if(0===e)c(t,4,n-r*o);else{n*=Math.pow(2,32),n+=l(t,8),n-=r*o,n=Math.max(n,0);var i=Math.floor(n/(a+1)),s=Math.floor(n%(a+1));c(t,4,i),c(t,8,s)}}))}}))}))}function y(t){var e={valid:null,remainder:null},r=d(t,["moof"]);if(!r)return e;if(r.length<2)return e.remainder=t,e;var i=r[r.length-1];return e.valid=Object(n.sliceUint8)(t,0,i.start-8),e.remainder=Object(n.sliceUint8)(t,i.start-8),e}function b(t,e){var r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}},"./src/utils/output-filter.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return n}));var n=function(){function t(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}var e=t.prototype;return e.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},e.newCue=function(t,e,r){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},e.reset=function(){this.cueRanges=[]},t}()},"./src/utils/texttrack-utils.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"sendAddTrackEvent",(function(){return i})),r.d(e,"addCueToTrack",(function(){return a})),r.d(e,"clearCurrentCues",(function(){return s})),r.d(e,"removeCuesInRange",(function(){return o})),r.d(e,"getCuesInRange",(function(){return u}));var n=r("./src/utils/logger.ts");function i(t,e){var r;try{r=new Event("addtrack")}catch(n){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)}function a(t,e){var r=t.mode;if("disabled"===r&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw new Error("addCue is failed for: "+e)}catch(a){n.logger.debug("[texttrack-utils]: "+a);var i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,t.addCue(i)}"disabled"===r&&(t.mode=r)}function s(t){var e=t.mode;if("disabled"===e&&(t.mode="hidden"),t.cues){for(var r=t.cues.length;r--;)t.removeCue(t.cues[r]);"disabled"===e&&(t.mode=e)}}function o(t,e,r){var n=t.mode;if("disabled"===n&&(t.mode="hidden"),t.cues&&t.cues.length){for(var i=u(t.cues,e,r),a=0;a<i.length;a++)t.removeCue(i[a]);"disabled"===n&&(t.mode=n)}}function u(t,e,r){var n=[],i=function(t,e){if(e<t[0].startTime)return 0;var r=t.length-1;if(e>t[r].endTime)return-1;for(var n=0,i=r;n<=i;){var a=Math.floor((i+n)/2);if(e<t[a].startTime)i=a-1;else{if(!(e>t[a].startTime&&n<r))return a;n=a+1}}return t[n].startTime-e<e-t[i].startTime?n:i}(t,e);if(i>-1)for(var a=i,s=t.length;a<s;a++){var o=t[a];if(o.startTime>=e&&o.endTime<=r)n.push(o);else if(o.startTime>r)return n}return n}},"./src/utils/time-ranges.ts":function(t,e,r){"use strict";r.r(e),e.default={toString:function(t){for(var e="",r=t.length,n=0;n<r;n++)e+="["+t.start(n).toFixed(3)+","+t.end(n).toFixed(3)+"]";return e}}},"./src/utils/timescale-conversion.ts":function(t,e,r){"use strict";function n(t,e,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);var i=t*e*r;return n?Math.round(i):i}function i(t,e,r,i){return void 0===r&&(r=1),void 0===i&&(i=!1),n(t,e,1/r,i)}function a(t,e){return void 0===e&&(e=!1),n(t,1e3,1/9e4,e)}function s(t,e){return void 0===e&&(e=1),n(t,9e4,1/e)}r.r(e),r.d(e,"toTimescaleFromBase",(function(){return n})),r.d(e,"toTimescaleFromScale",(function(){return i})),r.d(e,"toMsFromMpegTsClock",(function(){return a})),r.d(e,"toMpegTsClockFromTimescale",(function(){return s}))},"./src/utils/typed-array.ts":function(t,e,r){"use strict";function n(t,e,r){return Uint8Array.prototype.slice?t.slice(e,r):new Uint8Array(Array.prototype.slice.call(t,e,r))}r.r(e),r.d(e,"sliceUint8",(function(){return n}))},"./src/utils/vttcue.ts":function(t,e,r){"use strict";r.r(e),e.default=function(){if("undefined"!==typeof self&&self.VTTCue)return self.VTTCue;var t=["","lr","rl"],e=["start","middle","end","left","right"];function r(t,e){if("string"!==typeof e)return!1;if(!Array.isArray(t))return!1;var r=e.toLowerCase();return!!~t.indexOf(r)&&r}function n(t){return r(e,t)}function i(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var s in a)t[s]=a[s]}return t}function a(e,a,s){var o=this,u={enumerable:!0};o.hasBeenReset=!1;var l="",c=!1,d=e,f=a,h=s,p=null,g="",m=!0,v="auto",y="start",b=50,E="middle",T=50,S="middle";Object.defineProperty(o,"id",i({},u,{get:function(){return l},set:function(t){l=""+t}})),Object.defineProperty(o,"pauseOnExit",i({},u,{get:function(){return c},set:function(t){c=!!t}})),Object.defineProperty(o,"startTime",i({},u,{get:function(){return d},set:function(t){if("number"!==typeof t)throw new TypeError("Start time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",i({},u,{get:function(){return f},set:function(t){if("number"!==typeof t)throw new TypeError("End time must be set to a number.");f=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",i({},u,{get:function(){return h},set:function(t){h=""+t,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",i({},u,{get:function(){return p},set:function(t){p=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",i({},u,{get:function(){return g},set:function(e){var n=function(e){return r(t,e)}(e);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");g=n,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",i({},u,{get:function(){return m},set:function(t){m=!!t,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",i({},u,{get:function(){return v},set:function(t){if("number"!==typeof t&&"auto"!==t)throw new SyntaxError("An invalid number or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",i({},u,{get:function(){return y},set:function(t){var e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",i({},u,{get:function(){return b},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",i({},u,{get:function(){return E},set:function(t){var e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",i({},u,{get:function(){return T},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");T=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",i({},u,{get:function(){return S},set:function(t){var e=n(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");S=e,this.hasBeenReset=!0}})),o.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}()},"./src/utils/vttparser.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"parseTimeStamp",(function(){return a})),r.d(e,"fixLineBreaks",(function(){return d})),r.d(e,"VTTParser",(function(){return f}));var n=r("./src/utils/vttcue.ts"),i=function(){function t(){}return t.prototype.decode=function(t,e){if(!t)return"";if("string"!==typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))},t}();function a(t){function e(t,e,r,n){return 3600*(0|t)+60*(0|e)+(0|r)+parseFloat(n||0)}var r=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?e(r[2],r[3],0,r[4]):e(r[1],r[2],r[3],r[4]):null}var s=function(){function t(){this.values=Object.create(null)}var e=t.prototype;return e.set=function(t,e){this.get(t)||""===e||(this.values[t]=e)},e.get=function(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e},e.has=function(t){return t in this.values},e.alt=function(t,e,r){for(var n=0;n<r.length;++n)if(e===r[n]){this.set(t,e);break}},e.integer=function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},e.percent=function(t,e){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(e)){var r=parseFloat(e);if(r>=0&&r<=100)return this.set(t,r),!0}return!1},t}();function o(t,e,r,n){var i=n?t.split(n):[t];for(var a in i)if("string"===typeof i[a]){var s=i[a].split(r);2===s.length&&e(s[0],s[1])}}var u=new n.default(0,0,""),l="middle"===u.align?"middle":"center";function c(t,e,r){var n=t;function i(){var e=a(t);if(null===e)throw new Error("Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function c(){t=t.replace(/^\s+/,"")}if(c(),e.startTime=i(),c(),"--\x3e"!==t.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);t=t.substr(3),c(),e.endTime=i(),c(),function(t,e){var n=new s;o(t,(function(t,e){var i;switch(t){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===e){n.set(t,r[a].region);break}break;case"vertical":n.alt(t,e,["rl","lr"]);break;case"line":i=e.split(","),n.integer(t,i[0]),n.percent(t,i[0])&&n.set("snapToLines",!1),n.alt(t,i[0],["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start",l,"end"]);break;case"position":i=e.split(","),n.percent(t,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start",l,"end","line-left","line-right","auto"]);break;case"size":n.percent(t,e);break;case"align":n.alt(t,e,["start",l,"end","left","right"])}}),/:/,/\s/),e.region=n.get("region",null),e.vertical=n.get("vertical","");var i=n.get("line","auto");"auto"===i&&-1===u.line&&(i=-1),e.line=i,e.lineAlign=n.get("lineAlign","start"),e.snapToLines=n.get("snapToLines",!0),e.size=n.get("size",100),e.align=n.get("align",l);var a=n.get("position","auto");"auto"===a&&50===u.position&&(a="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=a}(t,e)}function d(t){return t.replace(/<br(?: \/)?>/gi,"\n")}var f=function(){function t(){this.state="INITIAL",this.buffer="",this.decoder=new i,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var e=t.prototype;return e.parse=function(t){var e=this;function r(){var t=e.buffer,r=0;for(t=d(t);r<t.length&&"\r"!==t[r]&&"\n"!==t[r];)++r;var n=t.substr(0,r);return"\r"===t[r]&&++r,"\n"===t[r]&&++r,e.buffer=t.substr(r),n}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{var i="";if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;var a=(i=r()).match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}for(var s=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(s?s=!1:i=r(),e.state){case"HEADER":/:/.test(i)?o(i,(function(t,e){}),/:/):i||(e.state="ID");continue;case"NOTE":i||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){e.state="NOTE";break}if(!i)continue;if(e.cue=new n.default(0,0,""),e.state="CUE",-1===i.indexOf("--\x3e")){e.cue.id=i;continue}case"CUE":if(!e.cue){e.state="BADCUE";continue}try{c(i,e.cue,e.regionList)}catch(l){e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var u=-1!==i.indexOf("--\x3e");if(!i||u&&(s=!0)){e.oncue&&e.cue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}if(null===e.cue)continue;e.cue.text&&(e.cue.text+="\n"),e.cue.text+=i;continue;case"BADCUE":i||(e.state="ID")}}}catch(l){"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this},e.flush=function(){var t=this;try{if((t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state||"BADWEBVTT"===t.state)throw new Error("Malformed WebVTT signature.")}catch(e){t.onparsingerror&&t.onparsingerror(e)}return t.onflush&&t.onflush(),this},t}()},"./src/utils/webvtt-parser.ts":function(t,e,r){"use strict";r.r(e),r.d(e,"generateCueId",(function(){return d})),r.d(e,"parseWebVTT",(function(){return f}));var n=r("./src/polyfills/number.ts"),i=r("./src/utils/vttparser.ts"),a=r("./src/demux/id3.ts"),s=r("./src/utils/timescale-conversion.ts"),o=r("./src/remux/mp4-remuxer.ts"),u=/\r\n|\n\r|\n|\r/g,l=function(t,e,r){return void 0===r&&(r=0),t.substr(r,e.length)===e},c=function(t){for(var e=5381,r=t.length;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString()};function d(t,e,r){return c(t.toString())+c(e.toString())+c(r)}function f(t,e,r,c,f,h,p,g){var m,v=new i.VTTParser,y=Object(a.utf8ArrayToStr)(new Uint8Array(t)).trim().replace(u,"\n").split("\n"),b=[],E=Object(s.toMpegTsClockFromTimescale)(e,r),T="00:00.000",S=0,w=0,_=!0,k=!1;v.oncue=function(t){var e=c[f],r=c.ccOffset,n=(S-E)/9e4;if(null!==e&&void 0!==e&&e.new&&(void 0!==w?r=c.ccOffset=e.start:function(t,e,r){var n=t[e],i=t[n.prevCC];if(!i||!i.new&&n.new)return t.ccOffset=t.presentationOffset=n.start,void(n.new=!1);for(;null!==(a=i)&&void 0!==a&&a.new;){var a;t.ccOffset+=n.start-i.start,n.new=!1,i=t[(n=i).prevCC]}t.presentationOffset=r}(c,f,n)),n&&(r=n-c.presentationOffset),k){var i=t.endTime-t.startTime,a=Object(o.normalizePts)(9e4*(t.startTime+r-w),9e4*h)/9e4;t.startTime=a,t.endTime=a+i}var s=t.text.trim();t.text=decodeURIComponent(encodeURIComponent(s)),t.id||(t.id=d(t.startTime,t.endTime,s)),t.endTime>0&&b.push(t)},v.onparsingerror=function(t){m=t},v.onflush=function(){m?g(m):p(b)},y.forEach((function(t){if(_){if(l(t,"X-TIMESTAMP-MAP=")){_=!1,k=!0,t.substr(16).split(",").forEach((function(t){l(t,"LOCAL:")?T=t.substr(6):l(t,"MPEGTS:")&&(S=parseInt(t.substr(7)))}));try{w=function(t){var e=parseInt(t.substr(-3)),r=parseInt(t.substr(-6,2)),i=parseInt(t.substr(-9,2)),a=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;if(!Object(n.isFiniteNumber)(e)||!Object(n.isFiniteNumber)(r)||!Object(n.isFiniteNumber)(i)||!Object(n.isFiniteNumber)(a))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+t);return e+=1e3*r,(e+=6e4*i)+36e5*a}(T)/1e3}catch(e){k=!1,m=e}return}""===t&&(_=!1)}v.parse(t+"\n")})),v.flush()}},"./src/utils/xhr-loader.ts":function(t,e,r){"use strict";r.r(e);var n=r("./src/utils/logger.ts"),i=r("./src/loader/load-stats.ts"),a=function(){function t(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=t?t.xhrSetup:null,this.stats=new i.LoadStats,this.retryDelay=0}var e=t.prototype;return e.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},e.abortInternal=function(){var t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,4!==t.readyState&&(this.stats.aborted=!0,t.abort()))},e.abort=function(){var t;this.abortInternal(),null!==(t=this.callbacks)&&void 0!==t&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},e.load=function(t,e,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=e,this.callbacks=r,this.retryDelay=e.retryDelay,this.loadInternal()},e.loadInternal=function(){var t=this.config,e=this.context;if(t){var r=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0;var i=this.xhrSetup;try{if(i)try{i(r,e.url)}catch(a){r.open("GET",e.url,!0),i(r,e.url)}r.readyState||r.open("GET",e.url,!0)}catch(a){return void this.callbacks.onError({code:r.status,text:a.message},e,r)}e.rangeEnd&&r.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),r.onreadystatechange=this.readystatechange.bind(this),r.onprogress=this.loadprogress.bind(this),r.responseType=e.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),t.timeout),r.send()}},e.readystatechange=function(){var t=this.context,e=this.loader,r=this.stats;if(t&&e){var i=e.readyState,a=this.config;if(!r.aborted&&i>=2)if(self.clearTimeout(this.requestTimeout),0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start)),4===i){e.onreadystatechange=null,e.onprogress=null;var s=e.status;if(s>=200&&s<300){var o,u;if(r.loading.end=Math.max(self.performance.now(),r.loading.first),u="arraybuffer"===t.responseType?(o=e.response).byteLength:(o=e.responseText).length,r.loaded=r.total=u,!this.callbacks)return;var l=this.callbacks.onProgress;if(l&&l(r,t,o,e),!this.callbacks)return;var c={url:e.responseURL,data:o};this.callbacks.onSuccess(c,r,t,e)}else r.retry>=a.maxRetry||s>=400&&s<499?(n.logger.error(s+" while loading "+t.url),this.callbacks.onError({code:s,text:e.statusText},t,e)):(n.logger.warn(s+" while loading "+t.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),r.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout)}},e.loadtimeout=function(){n.logger.warn("timeout while loading "+this.context.url);var t=this.callbacks;t&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader))},e.loadprogress=function(t){var e=this.stats;e.loaded=t.loaded,t.lengthComputable&&(e.total=t.total)},e.getResponseHeader=function(t){return this.loader&&this.loader.getAllResponseHeaders().indexOf(t)>=0?this.loader.getResponseHeader(t):null},t}();e.default=a}}).default},t.exports=n())},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(22);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(u){i=!0,a=u}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return r}}(t,e)||Object(n.a)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,r){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";function n(t){return"function"===typeof t}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){return Array.isArray||function(t){return t&&"number"===typeof t.length}}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(19);function i(t,e){if(t){if("string"===typeof t)return Object(n.a)(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(n.a)(t,e):void 0}}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(t){return t&&"number"===typeof t.length&&"function"!==typeof t}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.complete()}}},function(t,e,r){"use strict";function n(t){return!!t&&"function"!==typeof t.subscribe&&"function"===typeof t.then}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(1),i=r(3);function a(t,e){return function(r){if("function"!==typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new s(t,e))}}var s=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.project,this.thisArg))},t}(),o=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.project=r,i.count=0,i.thisArg=n||i,i}return n.a(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(r){return void this.destination.error(r)}this.destination.next(e)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var n=r(24),i=r(10),a=r(11),s=r(9),o=r(23),u=r(25),l=r(13),c=function(t){if(t&&"function"===typeof t[s.a])return c=t,function(t){var e=c[s.a]();if("function"!==typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(Object(o.a)(t))return Object(n.a)(t);if(Object(u.a)(t))return r=t,function(t){return r.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,i.a),t};if(t&&"function"===typeof t[a.a])return e=t,function(t){for(var r=e[a.a]();;){var n=void 0;try{n=r.next()}catch(i){return t.error(i),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"===typeof r.return&&t.add((function(){r.return&&r.return()})),t};var e,r,c,d=Object(l.a)(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+d+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},function(t,e,r){var n=r(74);t.exports=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,n(t,e)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,r){"use strict";var n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function s(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(t){n[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(i){return!1}}()?Object.assign:function(t,e){for(var r,o,u=s(t),l=1;l<arguments.length;l++){for(var c in r=Object(arguments[l]))i.call(r,c)&&(u[c]=r[c]);if(n){o=n(r);for(var d=0;d<o.length;d++)a.call(r,o[d])&&(u[o[d]]=r[o[d]])}}return u}},function(t,e,r){t.exports=r(53)},function(t,e,r){t.exports=r(55)},function(t,e){function r(){return t.exports=r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},t.exports.default=t.exports,t.exports.__esModule=!0,r.apply(this,arguments)}t.exports=r,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,r){(function(e){var r;r="undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{},t.exports=r}).call(this,r(42))},function(t,e,r){"use strict";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},function(t,e,r){"use strict";var n=r(6);function i(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,r){if(!e)return t;var a;if(r)a=r(e);else if(n.isURLSearchParams(e))a=e.toString();else{var s=[];n.forEach(e,(function(t,e){null!==t&&"undefined"!==typeof t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,(function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),s.push(i(e)+"="+i(t))})))})),a=s.join("&")}if(a){var o=t.indexOf("#");-1!==o&&(t=t.slice(0,o)),t+=(-1===t.indexOf("?")?"?":"&")+a}return t}},function(t,e,r){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,r){"use strict";(function(e){var n=r(6),i=r(61),a={"Content-Type":"application/x-www-form-urlencoded"};function s(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var o={adapter:function(){var t;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof e&&"[object process]"===Object.prototype.toString.call(e))&&(t=r(38)),t}(),transformRequest:[function(t,e){return i(e,"Accept"),i(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(s(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)?(s(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"===typeof t)try{t=JSON.parse(t)}catch(e){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(t){o.headers[t]={}})),n.forEach(["post","put","patch"],(function(t){o.headers[t]=n.merge(a)})),t.exports=o}).call(this,r(60))},function(t,e,r){"use strict";var n=r(6),i=r(62),a=r(64),s=r(35),o=r(65),u=r(68),l=r(69),c=r(39);t.exports=function(t){return new Promise((function(e,r){var d=t.data,f=t.headers;n.isFormData(d)&&delete f["Content-Type"];var h=new XMLHttpRequest;if(t.auth){var p=t.auth.username||"",g=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";f.Authorization="Basic "+btoa(p+":"+g)}var m=o(t.baseURL,t.url);if(h.open(t.method.toUpperCase(),s(m,t.params,t.paramsSerializer),!0),h.timeout=t.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in h?u(h.getAllResponseHeaders()):null,a={data:t.responseType&&"text"!==t.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:n,config:t,request:h};i(e,r,a),h=null}},h.onabort=function(){h&&(r(c("Request aborted",t,"ECONNABORTED",h)),h=null)},h.onerror=function(){r(c("Network Error",t,null,h)),h=null},h.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),r(c(e,t,"ECONNABORTED",h)),h=null},n.isStandardBrowserEnv()){var v=(t.withCredentials||l(m))&&t.xsrfCookieName?a.read(t.xsrfCookieName):void 0;v&&(f[t.xsrfHeaderName]=v)}if("setRequestHeader"in h&&n.forEach(f,(function(t,e){"undefined"===typeof d&&"content-type"===e.toLowerCase()?delete f[e]:h.setRequestHeader(e,t)})),n.isUndefined(t.withCredentials)||(h.withCredentials=!!t.withCredentials),t.responseType)try{h.responseType=t.responseType}catch(y){if("json"!==t.responseType)throw y}"function"===typeof t.onDownloadProgress&&h.addEventListener("progress",t.onDownloadProgress),"function"===typeof t.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){h&&(h.abort(),r(t),h=null)})),d||(d=null),h.send(d)}))}},function(t,e,r){"use strict";var n=r(63);t.exports=function(t,e,r,i,a){var s=new Error(t);return n(s,e,r,i,a)}},function(t,e,r){"use strict";var n=r(6);t.exports=function(t,e){e=e||{};var r={},i=["url","method","data"],a=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function u(t,e){return n.isPlainObject(t)&&n.isPlainObject(e)?n.merge(t,e):n.isPlainObject(e)?n.merge({},e):n.isArray(e)?e.slice():e}function l(i){n.isUndefined(e[i])?n.isUndefined(t[i])||(r[i]=u(void 0,t[i])):r[i]=u(t[i],e[i])}n.forEach(i,(function(t){n.isUndefined(e[t])||(r[t]=u(void 0,e[t]))})),n.forEach(a,l),n.forEach(s,(function(i){n.isUndefined(e[i])?n.isUndefined(t[i])||(r[i]=u(void 0,t[i])):r[i]=u(void 0,e[i])})),n.forEach(o,(function(n){n in e?r[n]=u(t[n],e[n]):n in t&&(r[n]=u(void 0,t[n]))}));var c=i.concat(a).concat(s).concat(o),d=Object.keys(t).concat(Object.keys(e)).filter((function(t){return-1===c.indexOf(t)}));return n.forEach(d,l),r}},function(t,e,r){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(n){"object"===typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=r(49)},function(t,e,r){"use strict";function n(t,e,r,n,i,a,s){try{var o=t[a](s),u=o.value}catch(l){return void r(l)}o.done?e(u):Promise.resolve(u).then(n,i)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(i,a){var s=t.apply(e,r);function o(t){n(s,i,a,o,u,"next",t)}function u(t){n(s,i,a,o,u,"throw",t)}o(void 0)}))}}r.d(e,"a",(function(){return i}))},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return a}));var n=r(33),i=r.n(n);function a(e){for(var r,n=(r=e,i.a.atob?i.a.atob(r):t.from(r,"base64").toString("binary")),a=new Uint8Array(n.length),s=0;s<n.length;s++)a[s]=n.charCodeAt(s);return a}}).call(this,r(75).Buffer)},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(19);var i=r(22);function a(t){return function(t){if(Array.isArray(t))return Object(n.a)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(i.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,r){"use strict";var n=r(29),i=60103,a=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var s=60109,o=60110,u=60112;e.Suspense=60113;var l=60115,c=60116;if("function"===typeof Symbol&&Symbol.for){var d=Symbol.for;i=d("react.element"),a=d("react.portal"),e.Fragment=d("react.fragment"),e.StrictMode=d("react.strict_mode"),e.Profiler=d("react.profiler"),s=d("react.provider"),o=d("react.context"),u=d("react.forward_ref"),e.Suspense=d("react.suspense"),l=d("react.memo"),c=d("react.lazy")}var f="function"===typeof Symbol&&Symbol.iterator;function h(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function m(t,e,r){this.props=t,this.context=e,this.refs=g,this.updater=r||p}function v(){}function y(t,e,r){this.props=t,this.context=e,this.refs=g,this.updater=r||p}m.prototype.isReactComponent={},m.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(h(85));this.updater.enqueueSetState(this,t,e,"setState")},m.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=m.prototype;var b=y.prototype=new v;b.constructor=y,n(b,m.prototype),b.isPureReactComponent=!0;var E={current:null},T=Object.prototype.hasOwnProperty,S={key:!0,ref:!0,__self:!0,__source:!0};function w(t,e,r){var n,a={},s=null,o=null;if(null!=e)for(n in void 0!==e.ref&&(o=e.ref),void 0!==e.key&&(s=""+e.key),e)T.call(e,n)&&!S.hasOwnProperty(n)&&(a[n]=e[n]);var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];a.children=l}if(t&&t.defaultProps)for(n in u=t.defaultProps)void 0===a[n]&&(a[n]=u[n]);return{$$typeof:i,type:t,key:s,ref:o,props:a,_owner:E.current}}function _(t){return"object"===typeof t&&null!==t&&t.$$typeof===i}var k=/\/+/g;function A(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function L(t,e,r,n,s){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var u=!1;if(null===t)u=!0;else switch(o){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case i:case a:u=!0}}if(u)return s=s(u=t),t=""===n?"."+A(u,0):n,Array.isArray(s)?(r="",null!=t&&(r=t.replace(k,"$&/")+"/"),L(s,e,r,"",(function(t){return t}))):null!=s&&(_(s)&&(s=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(s,r+(!s.key||u&&u.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+t)),e.push(s)),1;if(u=0,n=""===n?".":n+":",Array.isArray(t))for(var l=0;l<t.length;l++){var c=n+A(o=t[l],l);u+=L(o,e,r,c,s)}else if("function"===typeof(c=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t)))for(t=c.call(t),l=0;!(o=t.next()).done;)u+=L(o=o.value,e,r,c=n+A(o,l++),s);else if("object"===o)throw e=""+t,Error(h(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return u}function D(t,e,r){if(null==t)return t;var n=[],i=0;return L(t,n,"","",(function(t){return e.call(r,t,i++)})),n}function R(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var C={current:null};function I(){var t=C.current;if(null===t)throw Error(h(321));return t}var x={ReactCurrentDispatcher:C,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:E,IsSomeRendererActing:{current:!1},assign:n};e.Children={map:D,forEach:function(t,e,r){D(t,(function(){e.apply(this,arguments)}),r)},count:function(t){var e=0;return D(t,(function(){e++})),e},toArray:function(t){return D(t,(function(t){return t}))||[]},only:function(t){if(!_(t))throw Error(h(143));return t}},e.Component=m,e.PureComponent=y,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error(h(267,t));var a=n({},t.props),s=t.key,o=t.ref,u=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,u=E.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)T.call(e,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===e[c]&&void 0!==l?l[c]:e[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:i,type:t.type,key:s,ref:o,props:a,_owner:u}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:o,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=w,e.createFactory=function(t){var e=w.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=_,e.lazy=function(t){return{$$typeof:c,_payload:{_status:-1,_result:t},_init:R}},e.memo=function(t,e){return{$$typeof:l,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return I().useCallback(t,e)},e.useContext=function(t,e){return I().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return I().useEffect(t,e)},e.useImperativeHandle=function(t,e,r){return I().useImperativeHandle(t,e,r)},e.useLayoutEffect=function(t,e){return I().useLayoutEffect(t,e)},e.useMemo=function(t,e){return I().useMemo(t,e)},e.useReducer=function(t,e,r){return I().useReducer(t,e,r)},e.useRef=function(t){return I().useRef(t)},e.useState=function(t){return I().useState(t)},e.version="17.0.2"},function(t,e,r){"use strict";var n=r(7),i=r(29),a=r(50);function s(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!n)throw Error(s(227));var o=new Set,u={};function l(t,e){c(t,e),c(t+"Capture",e)}function c(t,e){for(u[t]=e,t=0;t<e.length;t++)o.add(e[t])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h=Object.prototype.hasOwnProperty,p={},g={};function m(t,e,r,n,i,a,s){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=s}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){v[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];v[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){v[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){v[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){v[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){v[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){v[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){v[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){v[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function b(t){return t[1].toUpperCase()}function E(t,e,r,n){var i=v.hasOwnProperty(e)?v[e]:null;(null!==i?0===i.type:!n&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(function(t,e,r,n){if(null===e||"undefined"===typeof e||function(t,e,r,n){if(null!==r&&0===r.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,r,i,n)&&(r=null),n||null===i?function(t){return!!h.call(g,t)||!h.call(p,t)&&(f.test(t)?g[t]=!0:(p[t]=!0,!1))}(e)&&(null===r?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=null===r?3!==i.type&&"":r:(e=i.attributeName,n=i.attributeNamespace,null===r?t.removeAttribute(e):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,b);v[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,b);v[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,b);v[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){v[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),v.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){v[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var T=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=60103,w=60106,_=60107,k=60108,A=60114,L=60109,D=60110,R=60112,C=60113,I=60120,x=60115,O=60116,P=60121,M=60128,F=60129,U=60130,N=60131;if("function"===typeof Symbol&&Symbol.for){var B=Symbol.for;S=B("react.element"),w=B("react.portal"),_=B("react.fragment"),k=B("react.strict_mode"),A=B("react.profiler"),L=B("react.provider"),D=B("react.context"),R=B("react.forward_ref"),C=B("react.suspense"),I=B("react.suspense_list"),x=B("react.memo"),O=B("react.lazy"),P=B("react.block"),B("react.scope"),M=B("react.opaque.id"),F=B("react.debug_trace_mode"),U=B("react.offscreen"),N=B("react.legacy_hidden")}var G,j="function"===typeof Symbol&&Symbol.iterator;function H(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=j&&t[j]||t["@@iterator"])?t:null}function V(t){if(void 0===G)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);G=e&&e[1]||""}return"\n"+G+t}var K=!1;function z(t,e){if(!t||K)return"";K=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),a=n.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o])return"\n"+i[s].replace(" at new "," at ")}while(1<=s&&0<=o);break}}}finally{K=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?V(t):""}function W(t){switch(t.tag){case 5:return V(t.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return t=z(t.type,!1);case 11:return t=z(t.type.render,!1);case 22:return t=z(t.type._render,!1);case 1:return t=z(t.type,!0);default:return""}}function Y(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case _:return"Fragment";case w:return"Portal";case A:return"Profiler";case k:return"StrictMode";case C:return"Suspense";case I:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case D:return(t.displayName||"Context")+".Consumer";case L:return(t._context.displayName||"Context")+".Provider";case R:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case x:return Y(t.type);case P:return Y(t._render);case O:e=t._payload,t=t._init;try{return Y(t(e))}catch(r){}}return null}function q(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function X(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function $(t){t._valueTracker||(t._valueTracker=function(t){var e=X(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(t){n=""+t,a.call(this,t)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(t){n=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function Q(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=X(t)?t.checked?"true":"false":t.value),(t=n)!==r&&(e.setValue(t),!0)}function J(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Z(t,e){var r=e.checked;return i({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:t._wrapperState.initialChecked})}function tt(t,e){var r=null==e.defaultValue?"":e.defaultValue,n=null!=e.checked?e.checked:e.defaultChecked;r=q(null!=e.value?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function et(t,e){null!=(e=e.checked)&&E(t,"checked",e,!1)}function rt(t,e){et(t,e);var r=q(e.value),n=e.type;if(null!=r)"number"===n?(0===r&&""===t.value||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if("submit"===n||"reset"===n)return void t.removeAttribute("value");e.hasOwnProperty("value")?it(t,e.type,r):e.hasOwnProperty("defaultValue")&&it(t,e.type,q(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function nt(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!("submit"!==n&&"reset"!==n||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}""!==(r=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==r&&(t.name=r)}function it(t,e,r){"number"===e&&J(t.ownerDocument)===t||(null==r?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}function at(t,e){return t=i({children:void 0},e),(e=function(t){var e="";return n.Children.forEach(t,(function(t){null!=t&&(e+=t)})),e}(e.children))&&(t.children=e),t}function st(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+q(r),e=null,i=0;i<t.length;i++){if(t[i].value===r)return t[i].selected=!0,void(n&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function ot(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(s(91));return i({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ut(t,e){var r=e.value;if(null==r){if(r=e.children,e=e.defaultValue,null!=r){if(null!=e)throw Error(s(92));if(Array.isArray(r)){if(!(1>=r.length))throw Error(s(93));r=r[0]}e=r}null==e&&(e=""),r=e}t._wrapperState={initialValue:q(r)}}function lt(t,e){var r=q(e.value),n=q(e.defaultValue);null!=r&&((r=""+r)!==t.value&&(t.value=r),null==e.defaultValue&&t.defaultValue!==r&&(t.defaultValue=r)),null!=n&&(t.defaultValue=""+n)}function ct(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}var dt="http://www.w3.org/1999/xhtml",ft="http://www.w3.org/2000/svg";function ht(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?ht(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var gt,mt,vt=(mt=function(t,e){if(t.namespaceURI!==ft||"innerHTML"in t)t.innerHTML=e;else{for((gt=gt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,r,n){MSApp.execUnsafeLocalFunction((function(){return mt(t,e)}))}:mt);function yt(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&3===r.nodeType)return void(r.nodeValue=e)}t.textContent=e}var bt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Et=["Webkit","ms","Moz","O"];function Tt(t,e,r){return null==e||"boolean"===typeof e||""===e?"":r||"number"!==typeof e||0===e||bt.hasOwnProperty(t)&&bt[t]?(""+e).trim():e+"px"}function St(t,e){for(var r in t=t.style,e)if(e.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=Tt(r,e[r],n);"float"===r&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}Object.keys(bt).forEach((function(t){Et.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bt[e]=bt[t]}))}));var wt=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _t(t,e){if(e){if(wt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(s(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(s(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(s(62))}}function kt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function At(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Lt=null,Dt=null,Rt=null;function Ct(t){if(t=ti(t)){if("function"!==typeof Lt)throw Error(s(280));var e=t.stateNode;e&&(e=ri(e),Lt(t.stateNode,t.type,e))}}function It(t){Dt?Rt?Rt.push(t):Rt=[t]:Dt=t}function xt(){if(Dt){var t=Dt,e=Rt;if(Rt=Dt=null,Ct(t),e)for(t=0;t<e.length;t++)Ct(e[t])}}function Ot(t,e){return t(e)}function Pt(t,e,r,n,i){return t(e,r,n,i)}function Mt(){}var Ft=Ot,Ut=!1,Nt=!1;function Bt(){null===Dt&&null===Rt||(Mt(),xt())}function Gt(t,e){var r=t.stateNode;if(null===r)return null;var n=ri(r);if(null===n)return null;r=n[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!n;break t;default:t=!1}if(t)return null;if(r&&"function"!==typeof r)throw Error(s(231,e,typeof r));return r}var jt=!1;if(d)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){jt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(mt){jt=!1}function Vt(t,e,r,n,i,a,s,o,u){var l=Array.prototype.slice.call(arguments,3);try{e.apply(r,l)}catch(c){this.onError(c)}}var Kt=!1,zt=null,Wt=!1,Yt=null,qt={onError:function(t){Kt=!0,zt=t}};function Xt(t,e,r,n,i,a,s,o,u){Kt=!1,zt=null,Vt.apply(qt,arguments)}function $t(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(1026&(e=t).flags)&&(r=e.return),t=e.return}while(t)}return 3===e.tag?r:null}function Qt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Jt(t){if($t(t)!==t)throw Error(s(188))}function Zt(t){if(!(t=function(t){var e=t.alternate;if(!e){if(null===(e=$t(t)))throw Error(s(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(n=i.return)){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return Jt(i),t;if(a===n)return Jt(i),e;a=a.sibling}throw Error(s(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,u=i.child;u;){if(u===r){o=!0,r=i,n=a;break}if(u===n){o=!0,n=i,r=a;break}u=u.sibling}if(!o){for(u=a.child;u;){if(u===r){o=!0,r=a,n=i;break}if(u===n){o=!0,n=a,r=i;break}u=u.sibling}if(!o)throw Error(s(189))}}if(r.alternate!==n)throw Error(s(190))}if(3!==r.tag)throw Error(s(188));return r.stateNode.current===r?t:e}(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function te(t,e){for(var r=t.alternate;null!==e;){if(e===t||e===r)return!0;e=e.return}return!1}var ee,re,ne,ie,ae=!1,se=[],oe=null,ue=null,le=null,ce=new Map,de=new Map,fe=[],he="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pe(t,e,r,n,i){return{blockedOn:t,domEventName:e,eventSystemFlags:16|r,nativeEvent:i,targetContainers:[n]}}function ge(t,e){switch(t){case"focusin":case"focusout":oe=null;break;case"dragenter":case"dragleave":ue=null;break;case"mouseover":case"mouseout":le=null;break;case"pointerover":case"pointerout":ce.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":de.delete(e.pointerId)}}function me(t,e,r,n,i,a){return null===t||t.nativeEvent!==a?(t=pe(e,r,n,i,a),null!==e&&(null!==(e=ti(e))&&re(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,null!==i&&-1===e.indexOf(i)&&e.push(i),t)}function ve(t){var e=Zn(t.target);if(null!==e){var r=$t(e);if(null!==r)if(13===(e=r.tag)){if(null!==(e=Qt(r)))return t.blockedOn=e,void ie(t.lanePriority,(function(){a.unstable_runWithPriority(t.priority,(function(){ne(r)}))}))}else if(3===e&&r.stateNode.hydrate)return void(t.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}t.blockedOn=null}function ye(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var r=Ze(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==r)return null!==(e=ti(r))&&re(e),t.blockedOn=r,!1;e.shift()}return!0}function be(t,e,r){ye(t)&&r.delete(e)}function Ee(){for(ae=!1;0<se.length;){var t=se[0];if(null!==t.blockedOn){null!==(t=ti(t.blockedOn))&&ee(t);break}for(var e=t.targetContainers;0<e.length;){var r=Ze(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==r){t.blockedOn=r;break}e.shift()}null===t.blockedOn&&se.shift()}null!==oe&&ye(oe)&&(oe=null),null!==ue&&ye(ue)&&(ue=null),null!==le&&ye(le)&&(le=null),ce.forEach(be),de.forEach(be)}function Te(t,e){t.blockedOn===e&&(t.blockedOn=null,ae||(ae=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ee)))}function Se(t){function e(e){return Te(e,t)}if(0<se.length){Te(se[0],t);for(var r=1;r<se.length;r++){var n=se[r];n.blockedOn===t&&(n.blockedOn=null)}}for(null!==oe&&Te(oe,t),null!==ue&&Te(ue,t),null!==le&&Te(le,t),ce.forEach(e),de.forEach(e),r=0;r<fe.length;r++)(n=fe[r]).blockedOn===t&&(n.blockedOn=null);for(;0<fe.length&&null===(r=fe[0]).blockedOn;)ve(r),null===r.blockedOn&&fe.shift()}function we(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var _e={animationend:we("Animation","AnimationEnd"),animationiteration:we("Animation","AnimationIteration"),animationstart:we("Animation","AnimationStart"),transitionend:we("Transition","TransitionEnd")},ke={},Ae={};function Le(t){if(ke[t])return ke[t];if(!_e[t])return t;var e,r=_e[t];for(e in r)if(r.hasOwnProperty(e)&&e in Ae)return ke[t]=r[e];return t}d&&(Ae=document.createElement("div").style,"AnimationEvent"in window||(delete _e.animationend.animation,delete _e.animationiteration.animation,delete _e.animationstart.animation),"TransitionEvent"in window||delete _e.transitionend.transition);var De=Le("animationend"),Re=Le("animationiteration"),Ce=Le("animationstart"),Ie=Le("transitionend"),xe=new Map,Oe=new Map,Pe=["abort","abort",De,"animationEnd",Re,"animationIteration",Ce,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Ie,"transitionEnd","waiting","waiting"];function Me(t,e){for(var r=0;r<t.length;r+=2){var n=t[r],i=t[r+1];i="on"+(i[0].toUpperCase()+i.slice(1)),Oe.set(n,e),xe.set(n,i),l(i,[n])}}(0,a.unstable_now)();var Fe=8;function Ue(t){if(0!==(1&t))return Fe=15,1;if(0!==(2&t))return Fe=14,2;if(0!==(4&t))return Fe=13,4;var e=24&t;return 0!==e?(Fe=12,e):0!==(32&t)?(Fe=11,32):0!==(e=192&t)?(Fe=10,e):0!==(256&t)?(Fe=9,256):0!==(e=3584&t)?(Fe=8,e):0!==(4096&t)?(Fe=7,4096):0!==(e=4186112&t)?(Fe=6,e):0!==(e=62914560&t)?(Fe=5,e):67108864&t?(Fe=4,67108864):0!==(134217728&t)?(Fe=3,134217728):0!==(e=805306368&t)?(Fe=2,e):0!==(1073741824&t)?(Fe=1,1073741824):(Fe=8,t)}function Ne(t,e){var r=t.pendingLanes;if(0===r)return Fe=0;var n=0,i=0,a=t.expiredLanes,s=t.suspendedLanes,o=t.pingedLanes;if(0!==a)n=a,i=Fe=15;else if(0!==(a=134217727&r)){var u=a&~s;0!==u?(n=Ue(u),i=Fe):0!==(o&=a)&&(n=Ue(o),i=Fe)}else 0!==(a=r&~s)?(n=Ue(a),i=Fe):0!==o&&(n=Ue(o),i=Fe);if(0===n)return 0;if(n=r&((0>(n=31-Ke(n))?0:1<<n)<<1)-1,0!==e&&e!==n&&0===(e&s)){if(Ue(e),i<=Fe)return e;Fe=i}if(0!==(e=t.entangledLanes))for(t=t.entanglements,e&=n;0<e;)i=1<<(r=31-Ke(e)),n|=t[r],e&=~i;return n}function Be(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function Ge(t,e){switch(t){case 15:return 1;case 14:return 2;case 12:return 0===(t=je(24&~e))?Ge(10,e):t;case 10:return 0===(t=je(192&~e))?Ge(8,e):t;case 8:return 0===(t=je(3584&~e))&&(0===(t=je(4186112&~e))&&(t=512)),t;case 2:return 0===(e=je(805306368&~e))&&(e=268435456),e}throw Error(s(358,t))}function je(t){return t&-t}function He(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Ve(t,e,r){t.pendingLanes|=e;var n=e-1;t.suspendedLanes&=n,t.pingedLanes&=n,(t=t.eventTimes)[e=31-Ke(e)]=r}var Ke=Math.clz32?Math.clz32:function(t){return 0===t?32:31-(ze(t)/We|0)|0},ze=Math.log,We=Math.LN2;var Ye=a.unstable_UserBlockingPriority,qe=a.unstable_runWithPriority,Xe=!0;function $e(t,e,r,n){Ut||Mt();var i=Je,a=Ut;Ut=!0;try{Pt(i,t,e,r,n)}finally{(Ut=a)||Bt()}}function Qe(t,e,r,n){qe(Ye,Je.bind(null,t,e,r,n))}function Je(t,e,r,n){var i;if(Xe)if((i=0===(4&e))&&0<se.length&&-1<he.indexOf(t))t=pe(null,t,e,r,n),se.push(t);else{var a=Ze(t,e,r,n);if(null===a)i&&ge(t,n);else{if(i){if(-1<he.indexOf(t))return t=pe(a,t,e,r,n),void se.push(t);if(function(t,e,r,n,i){switch(e){case"focusin":return oe=me(oe,t,e,r,n,i),!0;case"dragenter":return ue=me(ue,t,e,r,n,i),!0;case"mouseover":return le=me(le,t,e,r,n,i),!0;case"pointerover":var a=i.pointerId;return ce.set(a,me(ce.get(a)||null,t,e,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,de.set(a,me(de.get(a)||null,t,e,r,n,i)),!0}return!1}(a,t,e,r,n))return;ge(t,n)}xn(t,e,n,null,r)}}}function Ze(t,e,r,n){var i=At(n);if(null!==(i=Zn(i))){var a=$t(i);if(null===a)i=null;else{var s=a.tag;if(13===s){if(null!==(i=Qt(a)))return i;i=null}else if(3===s){if(a.stateNode.hydrate)return 3===a.tag?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return xn(t,e,n,i,r),null}var tr=null,er=null,rr=null;function nr(){if(rr)return rr;var t,e,r=er,n=r.length,i="value"in tr?tr.value:tr.textContent,a=i.length;for(t=0;t<n&&r[t]===i[t];t++);var s=n-t;for(e=1;e<=s&&r[n-e]===i[a-e];e++);return rr=i.slice(t,1<e?1-e:void 0)}function ir(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function ar(){return!0}function sr(){return!1}function or(t){function e(e,r,n,i,a){for(var s in this._reactName=e,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null,t)t.hasOwnProperty(s)&&(e=t[s],this[s]=e?e(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?ar:sr,this.isPropagationStopped=sr,this}return i(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=ar)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=ar)},persist:function(){},isPersistent:ar}),e}var ur,lr,cr,dr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fr=or(dr),hr=i({},dr,{view:0,detail:0}),pr=or(hr),gr=i({},hr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ar,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cr&&(cr&&"mousemove"===t.type?(ur=t.screenX-cr.screenX,lr=t.screenY-cr.screenY):lr=ur=0,cr=t),ur)},movementY:function(t){return"movementY"in t?t.movementY:lr}}),mr=or(gr),vr=or(i({},gr,{dataTransfer:0})),yr=or(i({},hr,{relatedTarget:0})),br=or(i({},dr,{animationName:0,elapsedTime:0,pseudoElement:0})),Er=or(i({},dr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}})),Tr=or(i({},dr,{data:0})),Sr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_r={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kr(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=_r[t])&&!!e[t]}function Ar(){return kr}var Lr=or(i({},hr,{key:function(t){if(t.key){var e=Sr[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=ir(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?wr[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ar,charCode:function(t){return"keypress"===t.type?ir(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?ir(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}})),Dr=or(i({},gr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rr=or(i({},hr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ar})),Cr=or(i({},dr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ir=or(i({},gr,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0})),xr=[9,13,27,32],Or=d&&"CompositionEvent"in window,Pr=null;d&&"documentMode"in document&&(Pr=document.documentMode);var Mr=d&&"TextEvent"in window&&!Pr,Fr=d&&(!Or||Pr&&8<Pr&&11>=Pr),Ur=String.fromCharCode(32),Nr=!1;function Br(t,e){switch(t){case"keyup":return-1!==xr.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gr(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var jr=!1;var Hr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Hr[t.type]:"textarea"===e}function Kr(t,e,r,n){It(n),0<(e=Pn(e,"onChange")).length&&(r=new fr("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var zr=null,Wr=null;function Yr(t){An(t,0)}function qr(t){if(Q(ei(t)))return t}function Xr(t,e){if("change"===t)return e}var $r=!1;if(d){var Qr;if(d){var Jr="oninput"in document;if(!Jr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Jr="function"===typeof Zr.oninput}Qr=Jr}else Qr=!1;$r=Qr&&(!document.documentMode||9<document.documentMode)}function tn(){zr&&(zr.detachEvent("onpropertychange",en),Wr=zr=null)}function en(t){if("value"===t.propertyName&&qr(Wr)){var e=[];if(Kr(e,Wr,t,At(t)),t=Yr,Ut)t(e);else{Ut=!0;try{Ot(t,e)}finally{Ut=!1,Bt()}}}}function rn(t,e,r){"focusin"===t?(tn(),Wr=r,(zr=e).attachEvent("onpropertychange",en)):"focusout"===t&&tn()}function nn(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return qr(Wr)}function an(t,e){if("click"===t)return qr(e)}function sn(t,e){if("input"===t||"change"===t)return qr(e)}var on="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e},un=Object.prototype.hasOwnProperty;function ln(t,e){if(on(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++)if(!un.call(e,r[n])||!on(t[r[n]],e[r[n]]))return!1;return!0}function cn(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dn(t,e){var r,n=cn(t);for(t=0;n;){if(3===n.nodeType){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=cn(n)}}function fn(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?fn(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function hn(){for(var t=window,e=J();e instanceof t.HTMLIFrameElement;){try{var r="string"===typeof e.contentWindow.location.href}catch(n){r=!1}if(!r)break;e=J((t=e.contentWindow).document)}return e}function pn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}var gn=d&&"documentMode"in document&&11>=document.documentMode,mn=null,vn=null,yn=null,bn=!1;function En(t,e,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bn||null==mn||mn!==J(n)||("selectionStart"in(n=mn)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},yn&&ln(yn,n)||(yn=n,0<(n=Pn(vn,"onSelect")).length&&(e=new fr("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=mn)))}Me("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Me("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Me(Pe,2);for(var Tn="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Sn=0;Sn<Tn.length;Sn++)Oe.set(Tn[Sn],0);c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_n=new Set("cancel close invalid load scroll toggle".split(" ").concat(wn));function kn(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,function(t,e,r,n,i,a,o,u,l){if(Xt.apply(this,arguments),Kt){if(!Kt)throw Error(s(198));var c=zt;Kt=!1,zt=null,Wt||(Wt=!0,Yt=c)}}(n,e,void 0,t),t.currentTarget=null}function An(t,e){e=0!==(4&e);for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;t:{var a=void 0;if(e)for(var s=n.length-1;0<=s;s--){var o=n[s],u=o.instance,l=o.currentTarget;if(o=o.listener,u!==a&&i.isPropagationStopped())break t;kn(i,o,l),a=u}else for(s=0;s<n.length;s++){if(u=(o=n[s]).instance,l=o.currentTarget,o=o.listener,u!==a&&i.isPropagationStopped())break t;kn(i,o,l),a=u}}}if(Wt)throw t=Yt,Wt=!1,Yt=null,t}function Ln(t,e){var r=ni(e),n=t+"__bubble";r.has(n)||(In(e,t,2,!1),r.add(n))}var Dn="_reactListening"+Math.random().toString(36).slice(2);function Rn(t){t[Dn]||(t[Dn]=!0,o.forEach((function(e){_n.has(e)||Cn(e,!1,t,null),Cn(e,!0,t,null)})))}function Cn(t,e,r,n){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=r;if("selectionchange"===t&&9!==r.nodeType&&(a=r.ownerDocument),null!==n&&!e&&_n.has(t)){if("scroll"!==t)return;i|=2,a=n}var s=ni(a),o=t+"__"+(e?"capture":"bubble");s.has(o)||(e&&(i|=4),In(a,t,i,e),s.add(o))}function In(t,e,r,n){var i=Oe.get(e);switch(void 0===i?2:i){case 0:i=$e;break;case 1:i=Qe;break;default:i=Je}r=i.bind(null,e,r,t),i=void 0,!jt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(i=!0),n?void 0!==i?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):void 0!==i?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function xn(t,e,r,n,i){var a=n;if(0===(1&e)&&0===(2&e)&&null!==n)t:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var o=n.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=n.return;null!==s;){var u=s.tag;if((3===u||4===u)&&((u=s.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=Zn(o)))return;if(5===(u=s.tag)||6===u){n=a=s;continue t}o=o.parentNode}}n=n.return}!function(t,e,r){if(Nt)return t(e,r);Nt=!0;try{Ft(t,e,r)}finally{Nt=!1,Bt()}}((function(){var n=a,i=At(r),s=[];t:{var o=xe.get(t);if(void 0!==o){var u=fr,l=t;switch(t){case"keypress":if(0===ir(r))break t;case"keydown":case"keyup":u=Lr;break;case"focusin":l="focus",u=yr;break;case"focusout":l="blur",u=yr;break;case"beforeblur":case"afterblur":u=yr;break;case"click":if(2===r.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=mr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Rr;break;case De:case Re:case Ce:u=br;break;case Ie:u=Cr;break;case"scroll":u=pr;break;case"wheel":u=Ir;break;case"copy":case"cut":case"paste":u=Er;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Dr}var c=0!==(4&e),d=!c&&"scroll"===t,f=c?null!==o?o+"Capture":null:o;c=[];for(var h,p=n;null!==p;){var g=(h=p).stateNode;if(5===h.tag&&null!==g&&(h=g,null!==f&&(null!=(g=Gt(p,f))&&c.push(On(p,g,h)))),d)break;p=p.return}0<c.length&&(o=new u(o,l,null,r,i),s.push({event:o,listeners:c}))}}if(0===(7&e)){if(u="mouseout"===t||"pointerout"===t,(!(o="mouseover"===t||"pointerover"===t)||0!==(16&e)||!(l=r.relatedTarget||r.fromElement)||!Zn(l)&&!l[Qn])&&(u||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,u?(u=n,null!==(l=(l=r.relatedTarget||r.toElement)?Zn(l):null)&&(l!==(d=$t(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(u=null,l=n),u!==l)){if(c=mr,g="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(c=Dr,g="onPointerLeave",f="onPointerEnter",p="pointer"),d=null==u?o:ei(u),h=null==l?o:ei(l),(o=new c(g,p+"leave",u,r,i)).target=d,o.relatedTarget=h,g=null,Zn(i)===n&&((c=new c(f,p+"enter",l,r,i)).target=h,c.relatedTarget=d,g=c),d=g,u&&l)t:{for(f=l,p=0,h=c=u;h;h=Mn(h))p++;for(h=0,g=f;g;g=Mn(g))h++;for(;0<p-h;)c=Mn(c),p--;for(;0<h-p;)f=Mn(f),h--;for(;p--;){if(c===f||null!==f&&c===f.alternate)break t;c=Mn(c),f=Mn(f)}c=null}else c=null;null!==u&&Fn(s,o,u,c,!1),null!==l&&null!==d&&Fn(s,d,l,c,!0)}if("select"===(u=(o=n?ei(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===u&&"file"===o.type)var m=Xr;else if(Vr(o))if($r)m=sn;else{m=nn;var v=rn}else(u=o.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=an);switch(m&&(m=m(t,n))?Kr(s,m,r,i):(v&&v(t,o,n),"focusout"===t&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&it(o,"number",o.value)),v=n?ei(n):window,t){case"focusin":(Vr(v)||"true"===v.contentEditable)&&(mn=v,vn=n,yn=null);break;case"focusout":yn=vn=mn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,En(s,r,i);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":En(s,r,i)}var y;if(Or)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else jr?Br(t,r)&&(b="onCompositionEnd"):"keydown"===t&&229===r.keyCode&&(b="onCompositionStart");b&&(Fr&&"ko"!==r.locale&&(jr||"onCompositionStart"!==b?"onCompositionEnd"===b&&jr&&(y=nr()):(er="value"in(tr=i)?tr.value:tr.textContent,jr=!0)),0<(v=Pn(n,b)).length&&(b=new Tr(b,t,null,r,i),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Gr(r))&&(b.data=y))),(y=Mr?function(t,e){switch(t){case"compositionend":return Gr(e);case"keypress":return 32!==e.which?null:(Nr=!0,Ur);case"textInput":return(t=e.data)===Ur&&Nr?null:t;default:return null}}(t,r):function(t,e){if(jr)return"compositionend"===t||!Or&&Br(t,e)?(t=nr(),rr=er=tr=null,jr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fr&&"ko"!==e.locale?null:e.data;default:return null}}(t,r))&&(0<(n=Pn(n,"onBeforeInput")).length&&(i=new Tr("onBeforeInput","beforeinput",null,r,i),s.push({event:i,listeners:n}),i.data=y))}An(s,e)}))}function On(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Pn(t,e){for(var r=e+"Capture",n=[];null!==t;){var i=t,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Gt(t,r))&&n.unshift(On(t,a,i)),null!=(a=Gt(t,e))&&n.push(On(t,a,i))),t=t.return}return n}function Mn(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Fn(t,e,r,n,i){for(var a=e._reactName,s=[];null!==r&&r!==n;){var o=r,u=o.alternate,l=o.stateNode;if(null!==u&&u===n)break;5===o.tag&&null!==l&&(o=l,i?null!=(u=Gt(r,a))&&s.unshift(On(r,u,o)):i||null!=(u=Gt(r,a))&&s.push(On(r,u,o))),r=r.return}0!==s.length&&t.push({event:e,listeners:s})}function Un(){}var Nn=null,Bn=null;function Gn(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function jn(t,e){return"textarea"===t||"option"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Hn="function"===typeof setTimeout?setTimeout:void 0,Vn="function"===typeof clearTimeout?clearTimeout:void 0;function Kn(t){1===t.nodeType?t.textContent="":9===t.nodeType&&(null!=(t=t.body)&&(t.textContent=""))}function zn(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break}return t}function Wn(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var r=t.data;if("$"===r||"$!"===r||"$?"===r){if(0===e)return t;e--}else"/$"===r&&e++}t=t.previousSibling}return null}var Yn=0;var qn=Math.random().toString(36).slice(2),Xn="__reactFiber$"+qn,$n="__reactProps$"+qn,Qn="__reactContainer$"+qn,Jn="__reactEvents$"+qn;function Zn(t){var e=t[Xn];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Qn]||r[Xn]){if(r=e.alternate,null!==e.child||null!==r&&null!==r.child)for(t=Wn(t);null!==t;){if(r=t[Xn])return r;t=Wn(t)}return e}r=(t=r).parentNode}return null}function ti(t){return!(t=t[Xn]||t[Qn])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function ei(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(s(33))}function ri(t){return t[$n]||null}function ni(t){var e=t[Jn];return void 0===e&&(e=t[Jn]=new Set),e}var ii=[],ai=-1;function si(t){return{current:t}}function oi(t){0>ai||(t.current=ii[ai],ii[ai]=null,ai--)}function ui(t,e){ai++,ii[ai]=t.current,t.current=e}var li={},ci=si(li),di=si(!1),fi=li;function hi(t,e){var r=t.type.contextTypes;if(!r)return li;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in r)a[i]=e[i];return n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function pi(t){return null!==(t=t.childContextTypes)&&void 0!==t}function gi(){oi(di),oi(ci)}function mi(t,e,r){if(ci.current!==li)throw Error(s(168));ui(ci,e),ui(di,r)}function vi(t,e,r){var n=t.stateNode;if(t=e.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var a in n=n.getChildContext())if(!(a in t))throw Error(s(108,Y(e)||"Unknown",a));return i({},r,n)}function yi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||li,fi=ci.current,ui(ci,t),ui(di,di.current),!0}function bi(t,e,r){var n=t.stateNode;if(!n)throw Error(s(169));r?(t=vi(t,e,fi),n.__reactInternalMemoizedMergedChildContext=t,oi(di),oi(ci),ui(ci,t)):oi(di),ui(di,r)}var Ei=null,Ti=null,Si=a.unstable_runWithPriority,wi=a.unstable_scheduleCallback,_i=a.unstable_cancelCallback,ki=a.unstable_shouldYield,Ai=a.unstable_requestPaint,Li=a.unstable_now,Di=a.unstable_getCurrentPriorityLevel,Ri=a.unstable_ImmediatePriority,Ci=a.unstable_UserBlockingPriority,Ii=a.unstable_NormalPriority,xi=a.unstable_LowPriority,Oi=a.unstable_IdlePriority,Pi={},Mi=void 0!==Ai?Ai:function(){},Fi=null,Ui=null,Ni=!1,Bi=Li(),Gi=1e4>Bi?Li:function(){return Li()-Bi};function ji(){switch(Di()){case Ri:return 99;case Ci:return 98;case Ii:return 97;case xi:return 96;case Oi:return 95;default:throw Error(s(332))}}function Hi(t){switch(t){case 99:return Ri;case 98:return Ci;case 97:return Ii;case 96:return xi;case 95:return Oi;default:throw Error(s(332))}}function Vi(t,e){return t=Hi(t),Si(t,e)}function Ki(t,e,r){return t=Hi(t),wi(t,e,r)}function zi(){if(null!==Ui){var t=Ui;Ui=null,_i(t)}Wi()}function Wi(){if(!Ni&&null!==Fi){Ni=!0;var t=0;try{var e=Fi;Vi(99,(function(){for(;t<e.length;t++){var r=e[t];do{r=r(!0)}while(null!==r)}})),Fi=null}catch(r){throw null!==Fi&&(Fi=Fi.slice(t+1)),wi(Ri,zi),r}finally{Ni=!1}}}var Yi=T.ReactCurrentBatchConfig;function qi(t,e){if(t&&t.defaultProps){for(var r in e=i({},e),t=t.defaultProps)void 0===e[r]&&(e[r]=t[r]);return e}return e}var Xi=si(null),$i=null,Qi=null,Ji=null;function Zi(){Ji=Qi=$i=null}function ta(t){var e=Xi.current;oi(Xi),t.type._context._currentValue=e}function ea(t,e){for(;null!==t;){var r=t.alternate;if((t.childLanes&e)===e){if(null===r||(r.childLanes&e)===e)break;r.childLanes|=e}else t.childLanes|=e,null!==r&&(r.childLanes|=e);t=t.return}}function ra(t,e){$i=t,Ji=Qi=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(Os=!0),t.firstContext=null)}function na(t,e){if(Ji!==t&&!1!==e&&0!==e)if("number"===typeof e&&1073741823!==e||(Ji=t,e=1073741823),e={context:t,observedBits:e,next:null},null===Qi){if(null===$i)throw Error(s(308));Qi=e,$i.dependencies={lanes:0,firstContext:e,responders:null}}else Qi=Qi.next=e;return t._currentValue}var ia=!1;function aa(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function sa(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function oa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ua(t,e){if(null!==(t=t.updateQueue)){var r=(t=t.shared).pending;null===r?e.next=e:(e.next=r.next,r.next=e),t.pending=e}}function la(t,e){var r=t.updateQueue,n=t.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?i=a=s:a=a.next=s,r=r.next}while(null!==r);null===a?i=a=e:a=a.next=e}else i=a=e;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(t.updateQueue=r)}null===(t=r.lastBaseUpdate)?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ca(t,e,r,n){var a=t.updateQueue;ia=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,u=a.shared.pending;if(null!==u){a.shared.pending=null;var l=u,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var d=t.alternate;if(null!==d){var f=(d=d.updateQueue).lastBaseUpdate;f!==o&&(null===f?d.firstBaseUpdate=c:f.next=c,d.lastBaseUpdate=l)}}if(null!==s){for(f=a.baseState,o=0,d=c=l=null;;){u=s.lane;var h=s.eventTime;if((n&u)===u){null!==d&&(d=d.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var p=t,g=s;switch(u=e,h=r,g.tag){case 1:if("function"===typeof(p=g.payload)){f=p.call(h,f,u);break t}f=p;break t;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(u="function"===typeof(p=g.payload)?p.call(h,f,u):p)||void 0===u)break t;f=i({},f,u);break t;case 2:ia=!0}}null!==s.callback&&(t.flags|=32,null===(u=a.effects)?a.effects=[s]:u.push(s))}else h={eventTime:h,lane:u,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=h,l=f):d=d.next=h,o|=u;if(null===(s=s.next)){if(null===(u=a.shared.pending))break;s=u.next,u.next=null,a.lastBaseUpdate=u,a.shared.pending=null}}null===d&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,No|=o,t.lanes=o,t.memoizedState=f}}function da(t,e,r){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!==typeof i)throw Error(s(191,i));i.call(n)}}}var fa=(new n.Component).refs;function ha(t,e,r,n){r=null===(r=r(n,e=t.memoizedState))||void 0===r?e:i({},e,r),t.memoizedState=r,0===t.lanes&&(t.updateQueue.baseState=r)}var pa={isMounted:function(t){return!!(t=t._reactInternals)&&$t(t)===t},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=lu(),i=cu(t),a=oa(n,i);a.payload=e,void 0!==r&&null!==r&&(a.callback=r),ua(t,a),du(t,i,n)},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=lu(),i=cu(t),a=oa(n,i);a.tag=1,a.payload=e,void 0!==r&&null!==r&&(a.callback=r),ua(t,a),du(t,i,n)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=lu(),n=cu(t),i=oa(r,n);i.tag=2,void 0!==e&&null!==e&&(i.callback=e),ua(t,i),du(t,n,r)}};function ga(t,e,r,n,i,a,s){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(n,a,s):!e.prototype||!e.prototype.isPureReactComponent||(!ln(r,n)||!ln(i,a))}function ma(t,e,r){var n=!1,i=li,a=e.contextType;return"object"===typeof a&&null!==a?a=na(a):(i=pi(e)?fi:ci.current,a=(n=null!==(n=e.contextTypes)&&void 0!==n)?hi(t,i):li),e=new e(r,a),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=pa,t.stateNode=e,e._reactInternals=t,n&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function va(t,e,r,n){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(r,n),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&pa.enqueueReplaceState(e,e.state,null)}function ya(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs=fa,aa(t);var a=e.contextType;"object"===typeof a&&null!==a?i.context=na(a):(a=pi(e)?fi:ci.current,i.context=hi(t,a)),ca(t,r,i,n),i.state=t.memoizedState,"function"===typeof(a=e.getDerivedStateFromProps)&&(ha(t,e,a,r),i.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(e=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),e!==i.state&&pa.enqueueReplaceState(i,i.state,null),ca(t,r,i,n),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4)}var ba=Array.isArray;function Ea(t,e,r){if(null!==(t=r.ref)&&"function"!==typeof t&&"object"!==typeof t){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(s(309));var n=r.stateNode}if(!n)throw Error(s(147,t));var i=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===i?e.ref:((e=function(t){var e=n.refs;e===fa&&(e=n.refs={}),null===t?delete e[i]:e[i]=t})._stringRef=i,e)}if("string"!==typeof t)throw Error(s(284));if(!r._owner)throw Error(s(290,t))}return t}function Ta(t,e){if("textarea"!==t.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e))}function Sa(t){function e(e,r){if(t){var n=e.lastEffect;null!==n?(n.nextEffect=r,e.lastEffect=r):e.firstEffect=e.lastEffect=r,r.nextEffect=null,r.flags=8}}function r(r,n){if(!t)return null;for(;null!==n;)e(r,n),n=n.sibling;return null}function n(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(t,e){return(t=Vu(t,e)).index=0,t.sibling=null,t}function a(e,r,n){return e.index=n,t?null!==(n=e.alternate)?(n=n.index)<r?(e.flags=2,r):n:(e.flags=2,r):r}function o(e){return t&&null===e.alternate&&(e.flags=2),e}function u(t,e,r,n){return null===e||6!==e.tag?((e=Yu(r,t.mode,n)).return=t,e):((e=i(e,r)).return=t,e)}function l(t,e,r,n){return null!==e&&e.elementType===r.type?((n=i(e,r.props)).ref=Ea(t,e,r),n.return=t,n):((n=Ku(r.type,r.key,r.props,null,t.mode,n)).ref=Ea(t,e,r),n.return=t,n)}function c(t,e,r,n){return null===e||4!==e.tag||e.stateNode.containerInfo!==r.containerInfo||e.stateNode.implementation!==r.implementation?((e=qu(r,t.mode,n)).return=t,e):((e=i(e,r.children||[])).return=t,e)}function d(t,e,r,n,a){return null===e||7!==e.tag?((e=zu(r,t.mode,n,a)).return=t,e):((e=i(e,r)).return=t,e)}function f(t,e,r){if("string"===typeof e||"number"===typeof e)return(e=Yu(""+e,t.mode,r)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case S:return(r=Ku(e.type,e.key,e.props,null,t.mode,r)).ref=Ea(t,null,e),r.return=t,r;case w:return(e=qu(e,t.mode,r)).return=t,e}if(ba(e)||H(e))return(e=zu(e,t.mode,r,null)).return=t,e;Ta(t,e)}return null}function h(t,e,r,n){var i=null!==e?e.key:null;if("string"===typeof r||"number"===typeof r)return null!==i?null:u(t,e,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case S:return r.key===i?r.type===_?d(t,e,r.props.children,n,i):l(t,e,r,n):null;case w:return r.key===i?c(t,e,r,n):null}if(ba(r)||H(r))return null!==i?null:d(t,e,r,n,null);Ta(t,r)}return null}function p(t,e,r,n,i){if("string"===typeof n||"number"===typeof n)return u(e,t=t.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case S:return t=t.get(null===n.key?r:n.key)||null,n.type===_?d(e,t,n.props.children,i,n.key):l(e,t,n,i);case w:return c(e,t=t.get(null===n.key?r:n.key)||null,n,i)}if(ba(n)||H(n))return d(e,t=t.get(r)||null,n,i,null);Ta(e,n)}return null}function g(i,s,o,u){for(var l=null,c=null,d=s,g=s=0,m=null;null!==d&&g<o.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=h(i,d,o[g],u);if(null===v){null===d&&(d=m);break}t&&d&&null===v.alternate&&e(i,d),s=a(v,s,g),null===c?l=v:c.sibling=v,c=v,d=m}if(g===o.length)return r(i,d),l;if(null===d){for(;g<o.length;g++)null!==(d=f(i,o[g],u))&&(s=a(d,s,g),null===c?l=d:c.sibling=d,c=d);return l}for(d=n(i,d);g<o.length;g++)null!==(m=p(d,i,g,o[g],u))&&(t&&null!==m.alternate&&d.delete(null===m.key?g:m.key),s=a(m,s,g),null===c?l=m:c.sibling=m,c=m);return t&&d.forEach((function(t){return e(i,t)})),l}function m(i,o,u,l){var c=H(u);if("function"!==typeof c)throw Error(s(150));if(null==(u=c.call(u)))throw Error(s(151));for(var d=c=null,g=o,m=o=0,v=null,y=u.next();null!==g&&!y.done;m++,y=u.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=h(i,g,y.value,l);if(null===b){null===g&&(g=v);break}t&&g&&null===b.alternate&&e(i,g),o=a(b,o,m),null===d?c=b:d.sibling=b,d=b,g=v}if(y.done)return r(i,g),c;if(null===g){for(;!y.done;m++,y=u.next())null!==(y=f(i,y.value,l))&&(o=a(y,o,m),null===d?c=y:d.sibling=y,d=y);return c}for(g=n(i,g);!y.done;m++,y=u.next())null!==(y=p(g,i,m,y.value,l))&&(t&&null!==y.alternate&&g.delete(null===y.key?m:y.key),o=a(y,o,m),null===d?c=y:d.sibling=y,d=y);return t&&g.forEach((function(t){return e(i,t)})),c}return function(t,n,a,u){var l="object"===typeof a&&null!==a&&a.type===_&&null===a.key;l&&(a=a.props.children);var c="object"===typeof a&&null!==a;if(c)switch(a.$$typeof){case S:t:{for(c=a.key,l=n;null!==l;){if(l.key===c){switch(l.tag){case 7:if(a.type===_){r(t,l.sibling),(n=i(l,a.props.children)).return=t,t=n;break t}break;default:if(l.elementType===a.type){r(t,l.sibling),(n=i(l,a.props)).ref=Ea(t,l,a),n.return=t,t=n;break t}}r(t,l);break}e(t,l),l=l.sibling}a.type===_?((n=zu(a.props.children,t.mode,u,a.key)).return=t,t=n):((u=Ku(a.type,a.key,a.props,null,t.mode,u)).ref=Ea(t,n,a),u.return=t,t=u)}return o(t);case w:t:{for(l=a.key;null!==n;){if(n.key===l){if(4===n.tag&&n.stateNode.containerInfo===a.containerInfo&&n.stateNode.implementation===a.implementation){r(t,n.sibling),(n=i(n,a.children||[])).return=t,t=n;break t}r(t,n);break}e(t,n),n=n.sibling}(n=qu(a,t.mode,u)).return=t,t=n}return o(t)}if("string"===typeof a||"number"===typeof a)return a=""+a,null!==n&&6===n.tag?(r(t,n.sibling),(n=i(n,a)).return=t,t=n):(r(t,n),(n=Yu(a,t.mode,u)).return=t,t=n),o(t);if(ba(a))return g(t,n,a,u);if(H(a))return m(t,n,a,u);if(c&&Ta(t,a),"undefined"===typeof a&&!l)switch(t.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,Y(t.type)||"Component"))}return r(t,n)}}var wa=Sa(!0),_a=Sa(!1),ka={},Aa=si(ka),La=si(ka),Da=si(ka);function Ra(t){if(t===ka)throw Error(s(174));return t}function Ca(t,e){switch(ui(Da,e),ui(La,t),ui(Aa,ka),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pt(null,"");break;default:e=pt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}oi(Aa),ui(Aa,e)}function Ia(){oi(Aa),oi(La),oi(Da)}function xa(t){Ra(Da.current);var e=Ra(Aa.current),r=pt(e,t.type);e!==r&&(ui(La,t),ui(Aa,r))}function Oa(t){La.current===t&&(oi(Aa),oi(La))}var Pa=si(0);function Ma(t){for(var e=t;null!==e;){if(13===e.tag){var r=e.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(64&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Fa=null,Ua=null,Na=!1;function Ba(t,e){var r=ju(5,null,null,0);r.elementType="DELETED",r.type="DELETED",r.stateNode=e,r.return=t,r.flags=8,null!==t.lastEffect?(t.lastEffect.nextEffect=r,t.lastEffect=r):t.firstEffect=t.lastEffect=r}function Ga(t,e){switch(t.tag){case 5:var r=t.type;return null!==(e=1!==e.nodeType||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,!0);case 13:default:return!1}}function ja(t){if(Na){var e=Ua;if(e){var r=e;if(!Ga(t,e)){if(!(e=zn(r.nextSibling))||!Ga(t,e))return t.flags=-1025&t.flags|2,Na=!1,void(Fa=t);Ba(Fa,r)}Fa=t,Ua=zn(e.firstChild)}else t.flags=-1025&t.flags|2,Na=!1,Fa=t}}function Ha(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;Fa=t}function Va(t){if(t!==Fa)return!1;if(!Na)return Ha(t),Na=!0,!1;var e=t.type;if(5!==t.tag||"head"!==e&&"body"!==e&&!jn(e,t.memoizedProps))for(e=Ua;e;)Ba(t,e),e=zn(e.nextSibling);if(Ha(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(s(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var r=t.data;if("/$"===r){if(0===e){Ua=zn(t.nextSibling);break t}e--}else"$"!==r&&"$!"!==r&&"$?"!==r||e++}t=t.nextSibling}Ua=null}}else Ua=Fa?zn(t.stateNode.nextSibling):null;return!0}function Ka(){Ua=Fa=null,Na=!1}var za=[];function Wa(){for(var t=0;t<za.length;t++)za[t]._workInProgressVersionPrimary=null;za.length=0}var Ya=T.ReactCurrentDispatcher,qa=T.ReactCurrentBatchConfig,Xa=0,$a=null,Qa=null,Ja=null,Za=!1,ts=!1;function es(){throw Error(s(321))}function rs(t,e){if(null===e)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!on(t[r],e[r]))return!1;return!0}function ns(t,e,r,n,i,a){if(Xa=a,$a=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ya.current=null===t||null===t.memoizedState?Rs:Cs,t=r(n,i),ts){a=0;do{if(ts=!1,!(25>a))throw Error(s(301));a+=1,Ja=Qa=null,e.updateQueue=null,Ya.current=Is,t=r(n,i)}while(ts)}if(Ya.current=Ds,e=null!==Qa&&null!==Qa.next,Xa=0,Ja=Qa=$a=null,Za=!1,e)throw Error(s(300));return t}function is(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ja?$a.memoizedState=Ja=t:Ja=Ja.next=t,Ja}function as(){if(null===Qa){var t=$a.alternate;t=null!==t?t.memoizedState:null}else t=Qa.next;var e=null===Ja?$a.memoizedState:Ja.next;if(null!==e)Ja=e,Qa=t;else{if(null===t)throw Error(s(310));t={memoizedState:(Qa=t).memoizedState,baseState:Qa.baseState,baseQueue:Qa.baseQueue,queue:Qa.queue,next:null},null===Ja?$a.memoizedState=Ja=t:Ja=Ja.next=t}return Ja}function ss(t,e){return"function"===typeof e?e(t):e}function os(t){var e=as(),r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=t;var n=Qa,i=n.baseQueue,a=r.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(null!==i){i=i.next,n=n.baseState;var u=o=a=null,l=i;do{var c=l.lane;if((Xa&c)===c)null!==u&&(u=u.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),n=l.eagerReducer===t?l.eagerState:t(n,l.action);else{var d={lane:c,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};null===u?(o=u=d,a=n):u=u.next=d,$a.lanes|=c,No|=c}l=l.next}while(null!==l&&l!==i);null===u?a=n:u.next=o,on(n,e.memoizedState)||(Os=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=u,r.lastRenderedState=n}return[e.memoizedState,r.dispatch]}function us(t){var e=as(),r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,a=e.memoizedState;if(null!==i){r.pending=null;var o=i=i.next;do{a=t(a,o.action),o=o.next}while(o!==i);on(a,e.memoizedState)||(Os=!0),e.memoizedState=a,null===e.baseQueue&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function ls(t,e,r){var n=e._getVersion;n=n(e._source);var i=e._workInProgressVersionPrimary;if(null!==i?t=i===n:(t=t.mutableReadLanes,(t=(Xa&t)===t)&&(e._workInProgressVersionPrimary=n,za.push(e))),t)return r(e._source);throw za.push(e),Error(s(350))}function cs(t,e,r,n){var i=Co;if(null===i)throw Error(s(349));var a=e._getVersion,o=a(e._source),u=Ya.current,l=u.useState((function(){return ls(i,e,r)})),c=l[1],d=l[0];l=Ja;var f=t.memoizedState,h=f.refs,p=h.getSnapshot,g=f.source;f=f.subscribe;var m=$a;return t.memoizedState={refs:h,source:e,subscribe:n},u.useEffect((function(){h.getSnapshot=r,h.setSnapshot=c;var t=a(e._source);if(!on(o,t)){t=r(e._source),on(d,t)||(c(t),t=cu(m),i.mutableReadLanes|=t&i.pendingLanes),t=i.mutableReadLanes,i.entangledLanes|=t;for(var n=i.entanglements,s=t;0<s;){var u=31-Ke(s),l=1<<u;n[u]|=t,s&=~l}}}),[r,e,n]),u.useEffect((function(){return n(e._source,(function(){var t=h.getSnapshot,r=h.setSnapshot;try{r(t(e._source));var n=cu(m);i.mutableReadLanes|=n&i.pendingLanes}catch(a){r((function(){throw a}))}}))}),[e,n]),on(p,r)&&on(g,e)&&on(f,n)||((t={pending:null,dispatch:null,lastRenderedReducer:ss,lastRenderedState:d}).dispatch=c=Ls.bind(null,$a,t),l.queue=t,l.baseQueue=null,d=ls(i,e,r),l.memoizedState=l.baseState=d),d}function ds(t,e,r){return cs(as(),t,e,r)}function fs(t){var e=is();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t=(t=e.queue={pending:null,dispatch:null,lastRenderedReducer:ss,lastRenderedState:t}).dispatch=Ls.bind(null,$a,t),[e.memoizedState,t]}function hs(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},null===(e=$a.updateQueue)?(e={lastEffect:null},$a.updateQueue=e,e.lastEffect=t.next=t):null===(r=e.lastEffect)?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t),t}function ps(t){return t={current:t},is().memoizedState=t}function gs(){return as().memoizedState}function ms(t,e,r,n){var i=is();$a.flags|=t,i.memoizedState=hs(1|e,r,void 0,void 0===n?null:n)}function vs(t,e,r,n){var i=as();n=void 0===n?null:n;var a=void 0;if(null!==Qa){var s=Qa.memoizedState;if(a=s.destroy,null!==n&&rs(n,s.deps))return void hs(e,r,a,n)}$a.flags|=t,i.memoizedState=hs(1|e,r,a,n)}function ys(t,e){return ms(516,4,t,e)}function bs(t,e){return vs(516,4,t,e)}function Es(t,e){return vs(4,2,t,e)}function Ts(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ss(t,e,r){return r=null!==r&&void 0!==r?r.concat([t]):null,vs(4,2,Ts.bind(null,e,t),r)}function ws(){}function _s(t,e){var r=as();e=void 0===e?null:e;var n=r.memoizedState;return null!==n&&null!==e&&rs(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function ks(t,e){var r=as();e=void 0===e?null:e;var n=r.memoizedState;return null!==n&&null!==e&&rs(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function As(t,e){var r=ji();Vi(98>r?98:r,(function(){t(!0)})),Vi(97<r?97:r,(function(){var r=qa.transition;qa.transition=1;try{t(!1),e()}finally{qa.transition=r}}))}function Ls(t,e,r){var n=lu(),i=cu(t),a={lane:i,action:r,eagerReducer:null,eagerState:null,next:null},s=e.pending;if(null===s?a.next=a:(a.next=s.next,s.next=a),e.pending=a,s=t.alternate,t===$a||null!==s&&s===$a)ts=Za=!0;else{if(0===t.lanes&&(null===s||0===s.lanes)&&null!==(s=e.lastRenderedReducer))try{var o=e.lastRenderedState,u=s(o,r);if(a.eagerReducer=s,a.eagerState=u,on(u,o))return}catch(l){}du(t,i,n)}}var Ds={readContext:na,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useOpaqueIdentifier:es,unstable_isNewReconciler:!1},Rs={readContext:na,useCallback:function(t,e){return is().memoizedState=[t,void 0===e?null:e],t},useContext:na,useEffect:ys,useImperativeHandle:function(t,e,r){return r=null!==r&&void 0!==r?r.concat([t]):null,ms(4,2,Ts.bind(null,e,t),r)},useLayoutEffect:function(t,e){return ms(4,2,t,e)},useMemo:function(t,e){var r=is();return e=void 0===e?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=is();return e=void 0!==r?r(e):e,n.memoizedState=n.baseState=e,t=(t=n.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e}).dispatch=Ls.bind(null,$a,t),[n.memoizedState,t]},useRef:ps,useState:fs,useDebugValue:ws,useDeferredValue:function(t){var e=fs(t),r=e[0],n=e[1];return ys((function(){var e=qa.transition;qa.transition=1;try{n(t)}finally{qa.transition=e}}),[t]),r},useTransition:function(){var t=fs(!1),e=t[0];return ps(t=As.bind(null,t[1])),[t,e]},useMutableSource:function(t,e,r){var n=is();return n.memoizedState={refs:{getSnapshot:e,setSnapshot:null},source:t,subscribe:r},cs(n,t,e,r)},useOpaqueIdentifier:function(){if(Na){var t=!1,e=function(t){return{$$typeof:M,toString:t,valueOf:t}}((function(){throw t||(t=!0,r("r:"+(Yn++).toString(36))),Error(s(355))})),r=fs(e)[1];return 0===(2&$a.mode)&&($a.flags|=516,hs(5,(function(){r("r:"+(Yn++).toString(36))}),void 0,null)),e}return fs(e="r:"+(Yn++).toString(36)),e},unstable_isNewReconciler:!1},Cs={readContext:na,useCallback:_s,useContext:na,useEffect:bs,useImperativeHandle:Ss,useLayoutEffect:Es,useMemo:ks,useReducer:os,useRef:gs,useState:function(){return os(ss)},useDebugValue:ws,useDeferredValue:function(t){var e=os(ss),r=e[0],n=e[1];return bs((function(){var e=qa.transition;qa.transition=1;try{n(t)}finally{qa.transition=e}}),[t]),r},useTransition:function(){var t=os(ss)[0];return[gs().current,t]},useMutableSource:ds,useOpaqueIdentifier:function(){return os(ss)[0]},unstable_isNewReconciler:!1},Is={readContext:na,useCallback:_s,useContext:na,useEffect:bs,useImperativeHandle:Ss,useLayoutEffect:Es,useMemo:ks,useReducer:us,useRef:gs,useState:function(){return us(ss)},useDebugValue:ws,useDeferredValue:function(t){var e=us(ss),r=e[0],n=e[1];return bs((function(){var e=qa.transition;qa.transition=1;try{n(t)}finally{qa.transition=e}}),[t]),r},useTransition:function(){var t=us(ss)[0];return[gs().current,t]},useMutableSource:ds,useOpaqueIdentifier:function(){return us(ss)[0]},unstable_isNewReconciler:!1},xs=T.ReactCurrentOwner,Os=!1;function Ps(t,e,r,n){e.child=null===t?_a(e,null,r,n):wa(e,t.child,r,n)}function Ms(t,e,r,n,i){r=r.render;var a=e.ref;return ra(e,i),n=ns(t,e,r,n,a,i),null===t||Os?(e.flags|=1,Ps(t,e,n,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~i,eo(t,e,i))}function Fs(t,e,r,n,i,a){if(null===t){var s=r.type;return"function"!==typeof s||Hu(s)||void 0!==s.defaultProps||null!==r.compare||void 0!==r.defaultProps?((t=Ku(r.type,null,n,e,e.mode,a)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=s,Us(t,e,s,n,i,a))}return s=t.child,0===(i&a)&&(i=s.memoizedProps,(r=null!==(r=r.compare)?r:ln)(i,n)&&t.ref===e.ref)?eo(t,e,a):(e.flags|=1,(t=Vu(s,n)).ref=e.ref,t.return=e,e.child=t)}function Us(t,e,r,n,i,a){if(null!==t&&ln(t.memoizedProps,n)&&t.ref===e.ref){if(Os=!1,0===(a&i))return e.lanes=t.lanes,eo(t,e,a);0!==(16384&t.flags)&&(Os=!0)}return Gs(t,e,r,n,a)}function Ns(t,e,r){var n=e.pendingProps,i=n.children,a=null!==t?t.memoizedState:null;if("hidden"===n.mode||"unstable-defer-without-hiding"===n.mode)if(0===(4&e.mode))e.memoizedState={baseLanes:0},bu(e,r);else{if(0===(1073741824&r))return t=null!==a?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t},bu(e,t),null;e.memoizedState={baseLanes:0},bu(e,null!==a?a.baseLanes:r)}else null!==a?(n=a.baseLanes|r,e.memoizedState=null):n=r,bu(e,n);return Ps(t,e,i,r),e.child}function Bs(t,e){var r=e.ref;(null===t&&null!==r||null!==t&&t.ref!==r)&&(e.flags|=128)}function Gs(t,e,r,n,i){var a=pi(r)?fi:ci.current;return a=hi(e,a),ra(e,i),r=ns(t,e,r,n,a,i),null===t||Os?(e.flags|=1,Ps(t,e,r,i),e.child):(e.updateQueue=t.updateQueue,e.flags&=-517,t.lanes&=~i,eo(t,e,i))}function js(t,e,r,n,i){if(pi(r)){var a=!0;yi(e)}else a=!1;if(ra(e,i),null===e.stateNode)null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),ma(e,r,n),ya(e,r,n,i),n=!0;else if(null===t){var s=e.stateNode,o=e.memoizedProps;s.props=o;var u=s.context,l=r.contextType;"object"===typeof l&&null!==l?l=na(l):l=hi(e,l=pi(r)?fi:ci.current);var c=r.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==n||u!==l)&&va(e,s,n,l),ia=!1;var f=e.memoizedState;s.state=f,ca(e,n,s,i),u=e.memoizedState,o!==n||f!==u||di.current||ia?("function"===typeof c&&(ha(e,r,c,n),u=e.memoizedState),(o=ia||ga(e,r,o,n,f,u,l))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(e.flags|=4)):("function"===typeof s.componentDidMount&&(e.flags|=4),e.memoizedProps=n,e.memoizedState=u),s.props=n,s.state=u,s.context=l,n=o):("function"===typeof s.componentDidMount&&(e.flags|=4),n=!1)}else{s=e.stateNode,sa(t,e),o=e.memoizedProps,l=e.type===e.elementType?o:qi(e.type,o),s.props=l,d=e.pendingProps,f=s.context,"object"===typeof(u=r.contextType)&&null!==u?u=na(u):u=hi(e,u=pi(r)?fi:ci.current);var h=r.getDerivedStateFromProps;(c="function"===typeof h||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==d||f!==u)&&va(e,s,n,u),ia=!1,f=e.memoizedState,s.state=f,ca(e,n,s,i);var p=e.memoizedState;o!==d||f!==p||di.current||ia?("function"===typeof h&&(ha(e,r,h,n),p=e.memoizedState),(l=ia||ga(e,r,l,n,f,p,u))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,p,u),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,p,u)),"function"===typeof s.componentDidUpdate&&(e.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(e.flags|=256)):("function"!==typeof s.componentDidUpdate||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=256),e.memoizedProps=n,e.memoizedState=p),s.props=n,s.state=p,s.context=u,n=l):("function"!==typeof s.componentDidUpdate||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=256),n=!1)}return Hs(t,e,r,n,a,i)}function Hs(t,e,r,n,i,a){Bs(t,e);var s=0!==(64&e.flags);if(!n&&!s)return i&&bi(e,r,!1),eo(t,e,a);n=e.stateNode,xs.current=e;var o=s&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return e.flags|=1,null!==t&&s?(e.child=wa(e,t.child,null,a),e.child=wa(e,null,o,a)):Ps(t,e,o,a),e.memoizedState=n.state,i&&bi(e,r,!0),e.child}function Vs(t){var e=t.stateNode;e.pendingContext?mi(0,e.pendingContext,e.pendingContext!==e.context):e.context&&mi(0,e.context,!1),Ca(t,e.containerInfo)}var Ks,zs,Ws,Ys={dehydrated:null,retryLane:0};function qs(t,e,r){var n,i=e.pendingProps,a=Pa.current,s=!1;return(n=0!==(64&e.flags))||(n=(null===t||null!==t.memoizedState)&&0!==(2&a)),n?(s=!0,e.flags&=-65):null!==t&&null===t.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(a|=1),ui(Pa,1&a),null===t?(void 0!==i.fallback&&ja(e),t=i.children,a=i.fallback,s?(t=Xs(e,t,a,r),e.child.memoizedState={baseLanes:r},e.memoizedState=Ys,t):"number"===typeof i.unstable_expectedLoadTime?(t=Xs(e,t,a,r),e.child.memoizedState={baseLanes:r},e.memoizedState=Ys,e.lanes=33554432,t):((r=Wu({mode:"visible",children:t},e.mode,r,null)).return=e,e.child=r)):(t.memoizedState,s?(i=Qs(t,e,i.children,i.fallback,r),s=e.child,a=t.child.memoizedState,s.memoizedState=null===a?{baseLanes:r}:{baseLanes:a.baseLanes|r},s.childLanes=t.childLanes&~r,e.memoizedState=Ys,i):(r=$s(t,e,i.children,r),e.memoizedState=null,r))}function Xs(t,e,r,n){var i=t.mode,a=t.child;return e={mode:"hidden",children:e},0===(2&i)&&null!==a?(a.childLanes=0,a.pendingProps=e):a=Wu(e,i,0,null),r=zu(r,i,n,null),a.return=t,r.return=t,a.sibling=r,t.child=a,r}function $s(t,e,r,n){var i=t.child;return t=i.sibling,r=Vu(i,{mode:"visible",children:r}),0===(2&e.mode)&&(r.lanes=n),r.return=e,r.sibling=null,null!==t&&(t.nextEffect=null,t.flags=8,e.firstEffect=e.lastEffect=t),e.child=r}function Qs(t,e,r,n,i){var a=e.mode,s=t.child;t=s.sibling;var o={mode:"hidden",children:r};return 0===(2&a)&&e.child!==s?((r=e.child).childLanes=0,r.pendingProps=o,null!==(s=r.lastEffect)?(e.firstEffect=r.firstEffect,e.lastEffect=s,s.nextEffect=null):e.firstEffect=e.lastEffect=null):r=Vu(s,o),null!==t?n=Vu(t,n):(n=zu(n,a,i,null)).flags|=2,n.return=e,r.return=e,r.sibling=n,e.child=r,n}function Js(t,e){t.lanes|=e;var r=t.alternate;null!==r&&(r.lanes|=e),ea(t.return,e)}function Zs(t,e,r,n,i,a){var s=t.memoizedState;null===s?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i,lastEffect:a}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i,s.lastEffect=a)}function to(t,e,r){var n=e.pendingProps,i=n.revealOrder,a=n.tail;if(Ps(t,e,n.children,r),0!==(2&(n=Pa.current)))n=1&n|2,e.flags|=64;else{if(null!==t&&0!==(64&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Js(t,r);else if(19===t.tag)Js(t,r);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ui(Pa,n),0===(2&e.mode))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;null!==r;)null!==(t=r.alternate)&&null===Ma(t)&&(i=r),r=r.sibling;null===(r=i)?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Zs(e,!1,i,r,a,e.lastEffect);break;case"backwards":for(r=null,i=e.child,e.child=null;null!==i;){if(null!==(t=i.alternate)&&null===Ma(t)){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Zs(e,!0,r,null,a,e.lastEffect);break;case"together":Zs(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function eo(t,e,r){if(null!==t&&(e.dependencies=t.dependencies),No|=e.lanes,0!==(r&e.childLanes)){if(null!==t&&e.child!==t.child)throw Error(s(153));if(null!==e.child){for(r=Vu(t=e.child,t.pendingProps),e.child=r,r.return=e;null!==t.sibling;)t=t.sibling,(r=r.sibling=Vu(t,t.pendingProps)).return=e;r.sibling=null}return e.child}return null}function ro(t,e){if(!Na)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;null!==e;)null!==e.alternate&&(r=e),e=e.sibling;null===r?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?e||null===t.tail?t.tail=null:t.tail.sibling=null:n.sibling=null}}function no(t,e,r){var n=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return pi(e.type)&&gi(),null;case 3:return Ia(),oi(di),oi(ci),Wa(),(n=e.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==t&&null!==t.child||(Va(e)?e.flags|=4:n.hydrate||(e.flags|=256)),null;case 5:Oa(e);var a=Ra(Da.current);if(r=e.type,null!==t&&null!=e.stateNode)zs(t,e,r,n),t.ref!==e.ref&&(e.flags|=128);else{if(!n){if(null===e.stateNode)throw Error(s(166));return null}if(t=Ra(Aa.current),Va(e)){n=e.stateNode,r=e.type;var o=e.memoizedProps;switch(n[Xn]=e,n[$n]=o,r){case"dialog":Ln("cancel",n),Ln("close",n);break;case"iframe":case"object":case"embed":Ln("load",n);break;case"video":case"audio":for(t=0;t<wn.length;t++)Ln(wn[t],n);break;case"source":Ln("error",n);break;case"img":case"image":case"link":Ln("error",n),Ln("load",n);break;case"details":Ln("toggle",n);break;case"input":tt(n,o),Ln("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Ln("invalid",n);break;case"textarea":ut(n,o),Ln("invalid",n)}for(var l in _t(r,o),t=null,o)o.hasOwnProperty(l)&&(a=o[l],"children"===l?"string"===typeof a?n.textContent!==a&&(t=["children",a]):"number"===typeof a&&n.textContent!==""+a&&(t=["children",""+a]):u.hasOwnProperty(l)&&null!=a&&"onScroll"===l&&Ln("scroll",n));switch(r){case"input":$(n),nt(n,o,!0);break;case"textarea":$(n),ct(n);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(n.onclick=Un)}n=t,e.updateQueue=n,null!==n&&(e.flags|=4)}else{switch(l=9===a.nodeType?a:a.ownerDocument,t===dt&&(t=ht(r)),t===dt?"script"===r?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof n.is?t=l.createElement(r,{is:n.is}):(t=l.createElement(r),"select"===r&&(l=t,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):t=l.createElementNS(t,r),t[Xn]=e,t[$n]=n,Ks(t,e),e.stateNode=t,l=kt(r,n),r){case"dialog":Ln("cancel",t),Ln("close",t),a=n;break;case"iframe":case"object":case"embed":Ln("load",t),a=n;break;case"video":case"audio":for(a=0;a<wn.length;a++)Ln(wn[a],t);a=n;break;case"source":Ln("error",t),a=n;break;case"img":case"image":case"link":Ln("error",t),Ln("load",t),a=n;break;case"details":Ln("toggle",t),a=n;break;case"input":tt(t,n),a=Z(t,n),Ln("invalid",t);break;case"option":a=at(t,n);break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=i({},n,{value:void 0}),Ln("invalid",t);break;case"textarea":ut(t,n),a=ot(t,n),Ln("invalid",t);break;default:a=n}_t(r,a);var c=a;for(o in c)if(c.hasOwnProperty(o)){var d=c[o];"style"===o?St(t,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&vt(t,d):"children"===o?"string"===typeof d?("textarea"!==r||""!==d)&&yt(t,d):"number"===typeof d&&yt(t,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(u.hasOwnProperty(o)?null!=d&&"onScroll"===o&&Ln("scroll",t):null!=d&&E(t,o,d,l))}switch(r){case"input":$(t),nt(t,n,!1);break;case"textarea":$(t),ct(t);break;case"option":null!=n.value&&t.setAttribute("value",""+q(n.value));break;case"select":t.multiple=!!n.multiple,null!=(o=n.value)?st(t,!!n.multiple,o,!1):null!=n.defaultValue&&st(t,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(t.onclick=Un)}Gn(r,n)&&(e.flags|=4)}null!==e.ref&&(e.flags|=128)}return null;case 6:if(t&&null!=e.stateNode)Ws(0,e,t.memoizedProps,n);else{if("string"!==typeof n&&null===e.stateNode)throw Error(s(166));r=Ra(Da.current),Ra(Aa.current),Va(e)?(n=e.stateNode,r=e.memoizedProps,n[Xn]=e,n.nodeValue!==r&&(e.flags|=4)):((n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[Xn]=e,e.stateNode=n)}return null;case 13:return oi(Pa),n=e.memoizedState,0!==(64&e.flags)?(e.lanes=r,e):(n=null!==n,r=!1,null===t?void 0!==e.memoizedProps.fallback&&Va(e):r=null!==t.memoizedState,n&&!r&&0!==(2&e.mode)&&(null===t&&!0!==e.memoizedProps.unstable_avoidThisFallback||0!==(1&Pa.current)?0===Mo&&(Mo=3):(0!==Mo&&3!==Mo||(Mo=4),null===Co||0===(134217727&No)&&0===(134217727&Bo)||gu(Co,xo))),(n||r)&&(e.flags|=4),null);case 4:return Ia(),null===t&&Rn(e.stateNode.containerInfo),null;case 10:return ta(e),null;case 17:return pi(e.type)&&gi(),null;case 19:if(oi(Pa),null===(n=e.memoizedState))return null;if(o=0!==(64&e.flags),null===(l=n.rendering))if(o)ro(n,!1);else{if(0!==Mo||null!==t&&0!==(64&t.flags))for(t=e.child;null!==t;){if(null!==(l=Ma(t))){for(e.flags|=64,ro(n,!1),null!==(o=l.updateQueue)&&(e.updateQueue=o,e.flags|=4),null===n.lastEffect&&(e.firstEffect=null),e.lastEffect=n.lastEffect,n=r,r=e.child;null!==r;)t=n,(o=r).flags&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(l=o.alternate)?(o.childLanes=0,o.lanes=t,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,t=l.dependencies,o.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ui(Pa,1&Pa.current|2),e.child}t=t.sibling}null!==n.tail&&Gi()>Vo&&(e.flags|=64,o=!0,ro(n,!1),e.lanes=33554432)}else{if(!o)if(null!==(t=Ma(l))){if(e.flags|=64,o=!0,null!==(r=t.updateQueue)&&(e.updateQueue=r,e.flags|=4),ro(n,!0),null===n.tail&&"hidden"===n.tailMode&&!l.alternate&&!Na)return null!==(e=e.lastEffect=n.lastEffect)&&(e.nextEffect=null),null}else 2*Gi()-n.renderingStartTime>Vo&&1073741824!==r&&(e.flags|=64,o=!0,ro(n,!1),e.lanes=33554432);n.isBackwards?(l.sibling=e.child,e.child=l):(null!==(r=n.last)?r.sibling=l:e.child=l,n.last=l)}return null!==n.tail?(r=n.tail,n.rendering=r,n.tail=r.sibling,n.lastEffect=e.lastEffect,n.renderingStartTime=Gi(),r.sibling=null,e=Pa.current,ui(Pa,o?1&e|2:1&e),r):null;case 23:case 24:return Eu(),null!==t&&null!==t.memoizedState!==(null!==e.memoizedState)&&"unstable-defer-without-hiding"!==n.mode&&(e.flags|=4),null}throw Error(s(156,e.tag))}function io(t){switch(t.tag){case 1:pi(t.type)&&gi();var e=t.flags;return 4096&e?(t.flags=-4097&e|64,t):null;case 3:if(Ia(),oi(di),oi(ci),Wa(),0!==(64&(e=t.flags)))throw Error(s(285));return t.flags=-4097&e|64,t;case 5:return Oa(t),null;case 13:return oi(Pa),4096&(e=t.flags)?(t.flags=-4097&e|64,t):null;case 19:return oi(Pa),null;case 4:return Ia(),null;case 10:return ta(t),null;case 23:case 24:return Eu(),null;default:return null}}function ao(t,e){try{var r="",n=e;do{r+=W(n),n=n.return}while(n);var i=r}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:t,source:e,stack:i}}function so(t,e){try{console.error(e.value)}catch(r){setTimeout((function(){throw r}))}}Ks=function(t,e){for(var r=e.child;null!==r;){if(5===r.tag||6===r.tag)t.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===e)break;for(;null===r.sibling;){if(null===r.return||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},zs=function(t,e,r,n){var a=t.memoizedProps;if(a!==n){t=e.stateNode,Ra(Aa.current);var s,o=null;switch(r){case"input":a=Z(t,a),n=Z(t,n),o=[];break;case"option":a=at(t,a),n=at(t,n),o=[];break;case"select":a=i({},a,{value:void 0}),n=i({},n,{value:void 0}),o=[];break;case"textarea":a=ot(t,a),n=ot(t,n),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(t.onclick=Un)}for(d in _t(r,n),r=null,a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(u.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in n){var c=n[d];if(l=null!=a?a[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(o||(o=[]),o.push(d,r)),r=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(u.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Ln("scroll",t),o||l===c||(o=[])):"object"===typeof c&&null!==c&&c.$$typeof===M?c.toString():(o=o||[]).push(d,c))}r&&(o=o||[]).push("style",r);var d=o;(e.updateQueue=d)&&(e.flags|=4)}},Ws=function(t,e,r,n){r!==n&&(e.flags|=4)};var oo="function"===typeof WeakMap?WeakMap:Map;function uo(t,e,r){(r=oa(-1,r)).tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Yo||(Yo=!0,qo=n),so(0,e)},r}function lo(t,e,r){(r=oa(-1,r)).tag=3;var n=t.type.getDerivedStateFromError;if("function"===typeof n){var i=e.value;r.payload=function(){return so(0,e),n(i)}}var a=t.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(r.callback=function(){"function"!==typeof n&&(null===Xo?Xo=new Set([this]):Xo.add(this),so(0,e));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),r}var co="function"===typeof WeakSet?WeakSet:Set;function fo(t){var e=t.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(r){Uu(t,r)}else e.current=null}function ho(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&e.flags&&null!==t){var r=t.memoizedProps,n=t.memoizedState;e=(t=e.stateNode).getSnapshotBeforeUpdate(e.elementType===e.type?r:qi(e.type,r),n),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:return void(256&e.flags&&Kn(e.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(s(163))}function po(t,e,r){switch(r.tag){case 0:case 11:case 15:case 22:if(null!==(e=null!==(e=r.updateQueue)?e.lastEffect:null)){t=e=e.next;do{if(3===(3&t.tag)){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}if(null!==(e=null!==(e=r.updateQueue)?e.lastEffect:null)){t=e=e.next;do{var i=t;n=i.next,0!==(4&(i=i.tag))&&0!==(1&i)&&(Pu(r,t),Ou(r,t)),t=n}while(t!==e)}return;case 1:return t=r.stateNode,4&r.flags&&(null===e?t.componentDidMount():(n=r.elementType===r.type?e.memoizedProps:qi(r.type,e.memoizedProps),t.componentDidUpdate(n,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate))),void(null!==(e=r.updateQueue)&&da(r,e,t));case 3:if(null!==(e=r.updateQueue)){if(t=null,null!==r.child)switch(r.child.tag){case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}da(r,e,t)}return;case 5:return t=r.stateNode,void(null===e&&4&r.flags&&Gn(r.type,r.memoizedProps)&&t.focus());case 6:case 4:case 12:return;case 13:return void(null===r.memoizedState&&(r=r.alternate,null!==r&&(r=r.memoizedState,null!==r&&(r=r.dehydrated,null!==r&&Se(r)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(s(163))}function go(t,e){for(var r=t;;){if(5===r.tag){var n=r.stateNode;if(e)"function"===typeof(n=n.style).setProperty?n.setProperty("display","none","important"):n.display="none";else{n=r.stateNode;var i=r.memoizedProps.style;i=void 0!==i&&null!==i&&i.hasOwnProperty("display")?i.display:null,n.style.display=Tt("display",i)}}else if(6===r.tag)r.stateNode.nodeValue=e?"":r.memoizedProps;else if((23!==r.tag&&24!==r.tag||null===r.memoizedState||r===t)&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}}function mo(t,e){if(Ti&&"function"===typeof Ti.onCommitFiberUnmount)try{Ti.onCommitFiberUnmount(Ei,e)}catch(a){}switch(e.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(t=e.updateQueue)&&null!==(t=t.lastEffect)){var r=t=t.next;do{var n=r,i=n.destroy;if(n=n.tag,void 0!==i)if(0!==(4&n))Pu(e,r);else{n=e;try{i()}catch(a){Uu(n,a)}}r=r.next}while(r!==t)}break;case 1:if(fo(e),"function"===typeof(t=e.stateNode).componentWillUnmount)try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(a){Uu(e,a)}break;case 5:fo(e);break;case 4:So(t,e)}}function vo(t){t.alternate=null,t.child=null,t.dependencies=null,t.firstEffect=null,t.lastEffect=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.return=null,t.updateQueue=null}function yo(t){return 5===t.tag||3===t.tag||4===t.tag}function bo(t){t:{for(var e=t.return;null!==e;){if(yo(e))break t;e=e.return}throw Error(s(160))}var r=e;switch(e=r.stateNode,r.tag){case 5:var n=!1;break;case 3:case 4:e=e.containerInfo,n=!0;break;default:throw Error(s(161))}16&r.flags&&(yt(e,""),r.flags&=-17);t:e:for(r=t;;){for(;null===r.sibling;){if(null===r.return||yo(r.return)){r=null;break t}r=r.return}for(r.sibling.return=r.return,r=r.sibling;5!==r.tag&&6!==r.tag&&18!==r.tag;){if(2&r.flags)continue e;if(null===r.child||4===r.tag)continue e;r.child.return=r,r=r.child}if(!(2&r.flags)){r=r.stateNode;break t}}n?Eo(t,r,e):To(t,r,e)}function Eo(t,e,r){var n=t.tag,i=5===n||6===n;if(i)t=i?t.stateNode:t.stateNode.instance,e?8===r.nodeType?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(8===r.nodeType?(e=r.parentNode).insertBefore(t,r):(e=r).appendChild(t),null!==(r=r._reactRootContainer)&&void 0!==r||null!==e.onclick||(e.onclick=Un));else if(4!==n&&null!==(t=t.child))for(Eo(t,e,r),t=t.sibling;null!==t;)Eo(t,e,r),t=t.sibling}function To(t,e,r){var n=t.tag,i=5===n||6===n;if(i)t=i?t.stateNode:t.stateNode.instance,e?r.insertBefore(t,e):r.appendChild(t);else if(4!==n&&null!==(t=t.child))for(To(t,e,r),t=t.sibling;null!==t;)To(t,e,r),t=t.sibling}function So(t,e){for(var r,n,i=e,a=!1;;){if(!a){a=i.return;t:for(;;){if(null===a)throw Error(s(160));switch(r=a.stateNode,a.tag){case 5:n=!1;break t;case 3:case 4:r=r.containerInfo,n=!0;break t}a=a.return}a=!0}if(5===i.tag||6===i.tag){t:for(var o=t,u=i,l=u;;)if(mo(o,l),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===u)break t;for(;null===l.sibling;){if(null===l.return||l.return===u)break t;l=l.return}l.sibling.return=l.return,l=l.sibling}n?(o=r,u=i.stateNode,8===o.nodeType?o.parentNode.removeChild(u):o.removeChild(u)):r.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){r=i.stateNode.containerInfo,n=!0,i.child.return=i,i=i.child;continue}}else if(mo(t,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function wo(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:var r=e.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var n=r=r.next;do{3===(3&n.tag)&&(t=n.destroy,n.destroy=void 0,void 0!==t&&t()),n=n.next}while(n!==r)}return;case 1:return;case 5:if(null!=(r=e.stateNode)){n=e.memoizedProps;var i=null!==t?t.memoizedProps:n;t=e.type;var a=e.updateQueue;if(e.updateQueue=null,null!==a){for(r[$n]=n,"input"===t&&"radio"===n.type&&null!=n.name&&et(r,n),kt(t,i),e=kt(t,n),i=0;i<a.length;i+=2){var o=a[i],u=a[i+1];"style"===o?St(r,u):"dangerouslySetInnerHTML"===o?vt(r,u):"children"===o?yt(r,u):E(r,o,u,e)}switch(t){case"input":rt(r,n);break;case"textarea":lt(r,n);break;case"select":t=r._wrapperState.wasMultiple,r._wrapperState.wasMultiple=!!n.multiple,null!=(a=n.value)?st(r,!!n.multiple,a,!1):t!==!!n.multiple&&(null!=n.defaultValue?st(r,!!n.multiple,n.defaultValue,!0):st(r,!!n.multiple,n.multiple?[]:"",!1))}}}return;case 6:if(null===e.stateNode)throw Error(s(162));return void(e.stateNode.nodeValue=e.memoizedProps);case 3:return void((r=e.stateNode).hydrate&&(r.hydrate=!1,Se(r.containerInfo)));case 12:return;case 13:return null!==e.memoizedState&&(Ho=Gi(),go(e.child,!0)),void _o(e);case 19:return void _o(e);case 17:return;case 23:case 24:return void go(e,null!==e.memoizedState)}throw Error(s(163))}function _o(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var r=t.stateNode;null===r&&(r=t.stateNode=new co),e.forEach((function(e){var n=Bu.bind(null,t,e);r.has(e)||(r.add(e),e.then(n,n))}))}}function ko(t,e){return null!==t&&(null===(t=t.memoizedState)||null!==t.dehydrated)&&(null!==(e=e.memoizedState)&&null===e.dehydrated)}var Ao=Math.ceil,Lo=T.ReactCurrentDispatcher,Do=T.ReactCurrentOwner,Ro=0,Co=null,Io=null,xo=0,Oo=0,Po=si(0),Mo=0,Fo=null,Uo=0,No=0,Bo=0,Go=0,jo=null,Ho=0,Vo=1/0;function Ko(){Vo=Gi()+500}var zo,Wo=null,Yo=!1,qo=null,Xo=null,$o=!1,Qo=null,Jo=90,Zo=[],tu=[],eu=null,ru=0,nu=null,iu=-1,au=0,su=0,ou=null,uu=!1;function lu(){return 0!==(48&Ro)?Gi():-1!==iu?iu:iu=Gi()}function cu(t){if(0===(2&(t=t.mode)))return 1;if(0===(4&t))return 99===ji()?1:2;if(0===au&&(au=Uo),0!==Yi.transition){0!==su&&(su=null!==jo?jo.pendingLanes:0),t=au;var e=4186112&~su;return 0===(e&=-e)&&(0===(e=(t=4186112&~t)&-t)&&(e=8192)),e}return t=ji(),0!==(4&Ro)&&98===t?t=Ge(12,au):t=Ge(t=function(t){switch(t){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(t),au),t}function du(t,e,r){if(50<ru)throw ru=0,nu=null,Error(s(185));if(null===(t=fu(t,e)))return null;Ve(t,e,r),t===Co&&(Bo|=e,4===Mo&&gu(t,xo));var n=ji();1===e?0!==(8&Ro)&&0===(48&Ro)?mu(t):(hu(t,r),0===Ro&&(Ko(),zi())):(0===(4&Ro)||98!==n&&99!==n||(null===eu?eu=new Set([t]):eu.add(t)),hu(t,r)),jo=t}function fu(t,e){t.lanes|=e;var r=t.alternate;for(null!==r&&(r.lanes|=e),r=t,t=t.return;null!==t;)t.childLanes|=e,null!==(r=t.alternate)&&(r.childLanes|=e),r=t,t=t.return;return 3===r.tag?r.stateNode:null}function hu(t,e){for(var r=t.callbackNode,n=t.suspendedLanes,i=t.pingedLanes,a=t.expirationTimes,o=t.pendingLanes;0<o;){var u=31-Ke(o),l=1<<u,c=a[u];if(-1===c){if(0===(l&n)||0!==(l&i)){c=e,Ue(l);var d=Fe;a[u]=10<=d?c+250:6<=d?c+5e3:-1}}else c<=e&&(t.expiredLanes|=l);o&=~l}if(n=Ne(t,t===Co?xo:0),e=Fe,0===n)null!==r&&(r!==Pi&&_i(r),t.callbackNode=null,t.callbackPriority=0);else{if(null!==r){if(t.callbackPriority===e)return;r!==Pi&&_i(r)}15===e?(r=mu.bind(null,t),null===Fi?(Fi=[r],Ui=wi(Ri,Wi)):Fi.push(r),r=Pi):14===e?r=Ki(99,mu.bind(null,t)):r=Ki(r=function(t){switch(t){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,t))}}(e),pu.bind(null,t)),t.callbackPriority=e,t.callbackNode=r}}function pu(t){if(iu=-1,su=au=0,0!==(48&Ro))throw Error(s(327));var e=t.callbackNode;if(xu()&&t.callbackNode!==e)return null;var r=Ne(t,t===Co?xo:0);if(0===r)return null;var n=r,i=Ro;Ro|=16;var a=wu();for(Co===t&&xo===n||(Ko(),Tu(t,n));;)try{Au();break}catch(u){Su(t,u)}if(Zi(),Lo.current=a,Ro=i,null!==Io?n=0:(Co=null,xo=0,n=Mo),0!==(Uo&Bo))Tu(t,0);else if(0!==n){if(2===n&&(Ro|=64,t.hydrate&&(t.hydrate=!1,Kn(t.containerInfo)),0!==(r=Be(t))&&(n=_u(t,r))),1===n)throw e=Fo,Tu(t,0),gu(t,r),hu(t,Gi()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=r,n){case 0:case 1:throw Error(s(345));case 2:Ru(t);break;case 3:if(gu(t,r),(62914560&r)===r&&10<(n=Ho+500-Gi())){if(0!==Ne(t,0))break;if(((i=t.suspendedLanes)&r)!==r){lu(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Hn(Ru.bind(null,t),n);break}Ru(t);break;case 4:if(gu(t,r),(4186112&r)===r)break;for(n=t.eventTimes,i=-1;0<r;){var o=31-Ke(r);a=1<<o,(o=n[o])>i&&(i=o),r&=~a}if(r=i,10<(r=(120>(r=Gi()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ao(r/1960))-r)){t.timeoutHandle=Hn(Ru.bind(null,t),r);break}Ru(t);break;case 5:Ru(t);break;default:throw Error(s(329))}}return hu(t,Gi()),t.callbackNode===e?pu.bind(null,t):null}function gu(t,e){for(e&=~Go,e&=~Bo,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ke(e),n=1<<r;t[r]=-1,e&=~n}}function mu(t){if(0!==(48&Ro))throw Error(s(327));if(xu(),t===Co&&0!==(t.expiredLanes&xo)){var e=xo,r=_u(t,e);0!==(Uo&Bo)&&(r=_u(t,e=Ne(t,e)))}else r=_u(t,e=Ne(t,0));if(0!==t.tag&&2===r&&(Ro|=64,t.hydrate&&(t.hydrate=!1,Kn(t.containerInfo)),0!==(e=Be(t))&&(r=_u(t,e))),1===r)throw r=Fo,Tu(t,0),gu(t,e),hu(t,Gi()),r;return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ru(t),hu(t,Gi()),null}function vu(t,e){var r=Ro;Ro|=1;try{return t(e)}finally{0===(Ro=r)&&(Ko(),zi())}}function yu(t,e){var r=Ro;Ro&=-2,Ro|=8;try{return t(e)}finally{0===(Ro=r)&&(Ko(),zi())}}function bu(t,e){ui(Po,Oo),Oo|=e,Uo|=e}function Eu(){Oo=Po.current,oi(Po)}function Tu(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(-1!==r&&(t.timeoutHandle=-1,Vn(r)),null!==Io)for(r=Io.return;null!==r;){var n=r;switch(n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&gi();break;case 3:Ia(),oi(di),oi(ci),Wa();break;case 5:Oa(n);break;case 4:Ia();break;case 13:case 19:oi(Pa);break;case 10:ta(n);break;case 23:case 24:Eu()}r=r.return}Co=t,Io=Vu(t.current,null),xo=Oo=Uo=e,Mo=0,Fo=null,Go=Bo=No=0}function Su(t,e){for(;;){var r=Io;try{if(Zi(),Ya.current=Ds,Za){for(var n=$a.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}Za=!1}if(Xa=0,Ja=Qa=$a=null,ts=!1,Do.current=null,null===r||null===r.return){Mo=1,Fo=e,Io=null;break}t:{var a=t,s=r.return,o=r,u=e;if(e=xo,o.flags|=2048,o.firstEffect=o.lastEffect=null,null!==u&&"object"===typeof u&&"function"===typeof u.then){var l=u;if(0===(2&o.mode)){var c=o.alternate;c?(o.updateQueue=c.updateQueue,o.memoizedState=c.memoizedState,o.lanes=c.lanes):(o.updateQueue=null,o.memoizedState=null)}var d=0!==(1&Pa.current),f=s;do{var h;if(h=13===f.tag){var p=f.memoizedState;if(null!==p)h=null!==p.dehydrated;else{var g=f.memoizedProps;h=void 0!==g.fallback&&(!0!==g.unstable_avoidThisFallback||!d)}}if(h){var m=f.updateQueue;if(null===m){var v=new Set;v.add(l),f.updateQueue=v}else m.add(l);if(0===(2&f.mode)){if(f.flags|=64,o.flags|=16384,o.flags&=-2981,1===o.tag)if(null===o.alternate)o.tag=17;else{var y=oa(-1,1);y.tag=2,ua(o,y)}o.lanes|=1;break t}u=void 0,o=e;var b=a.pingCache;if(null===b?(b=a.pingCache=new oo,u=new Set,b.set(l,u)):void 0===(u=b.get(l))&&(u=new Set,b.set(l,u)),!u.has(o)){u.add(o);var E=Nu.bind(null,a,l,o);l.then(E,E)}f.flags|=4096,f.lanes=e;break t}f=f.return}while(null!==f);u=Error((Y(o.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Mo&&(Mo=2),u=ao(u,o),f=s;do{switch(f.tag){case 3:a=u,f.flags|=4096,e&=-e,f.lanes|=e,la(f,uo(0,a,e));break t;case 1:a=u;var T=f.type,S=f.stateNode;if(0===(64&f.flags)&&("function"===typeof T.getDerivedStateFromError||null!==S&&"function"===typeof S.componentDidCatch&&(null===Xo||!Xo.has(S)))){f.flags|=4096,e&=-e,f.lanes|=e,la(f,lo(f,a,e));break t}}f=f.return}while(null!==f)}Du(r)}catch(w){e=w,Io===r&&null!==r&&(Io=r=r.return);continue}break}}function wu(){var t=Lo.current;return Lo.current=Ds,null===t?Ds:t}function _u(t,e){var r=Ro;Ro|=16;var n=wu();for(Co===t&&xo===e||Tu(t,e);;)try{ku();break}catch(i){Su(t,i)}if(Zi(),Ro=r,Lo.current=n,null!==Io)throw Error(s(261));return Co=null,xo=0,Mo}function ku(){for(;null!==Io;)Lu(Io)}function Au(){for(;null!==Io&&!ki();)Lu(Io)}function Lu(t){var e=zo(t.alternate,t,Oo);t.memoizedProps=t.pendingProps,null===e?Du(t):Io=e,Do.current=null}function Du(t){var e=t;do{var r=e.alternate;if(t=e.return,0===(2048&e.flags)){if(null!==(r=no(r,e,Oo)))return void(Io=r);if(24!==(r=e).tag&&23!==r.tag||null===r.memoizedState||0!==(1073741824&Oo)||0===(4&r.mode)){for(var n=0,i=r.child;null!==i;)n|=i.lanes|i.childLanes,i=i.sibling;r.childLanes=n}null!==t&&0===(2048&t.flags)&&(null===t.firstEffect&&(t.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==t.lastEffect&&(t.lastEffect.nextEffect=e.firstEffect),t.lastEffect=e.lastEffect),1<e.flags&&(null!==t.lastEffect?t.lastEffect.nextEffect=e:t.firstEffect=e,t.lastEffect=e))}else{if(null!==(r=io(e)))return r.flags&=2047,void(Io=r);null!==t&&(t.firstEffect=t.lastEffect=null,t.flags|=2048)}if(null!==(e=e.sibling))return void(Io=e);Io=e=t}while(null!==e);0===Mo&&(Mo=5)}function Ru(t){var e=ji();return Vi(99,Cu.bind(null,t,e)),null}function Cu(t,e){do{xu()}while(null!==Qo);if(0!==(48&Ro))throw Error(s(327));var r=t.finishedWork;if(null===r)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(s(177));t.callbackNode=null;var n=r.lanes|r.childLanes,i=n,a=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;for(var o=t.eventTimes,u=t.expirationTimes;0<a;){var l=31-Ke(a),c=1<<l;i[l]=0,o[l]=-1,u[l]=-1,a&=~c}if(null!==eu&&0===(24&n)&&eu.has(t)&&eu.delete(t),t===Co&&(Io=Co=null,xo=0),1<r.flags?null!==r.lastEffect?(r.lastEffect.nextEffect=r,n=r.firstEffect):n=r:n=r.firstEffect,null!==n){if(i=Ro,Ro|=32,Do.current=null,Nn=Xe,pn(o=hn())){if("selectionStart"in o)u={start:o.selectionStart,end:o.selectionEnd};else t:if(u=(u=o.ownerDocument)&&u.defaultView||window,(c=u.getSelection&&u.getSelection())&&0!==c.rangeCount){u=c.anchorNode,a=c.anchorOffset,l=c.focusNode,c=c.focusOffset;try{u.nodeType,l.nodeType}catch(A){u=null;break t}var d=0,f=-1,h=-1,p=0,g=0,m=o,v=null;e:for(;;){for(var y;m!==u||0!==a&&3!==m.nodeType||(f=d+a),m!==l||0!==c&&3!==m.nodeType||(h=d+c),3===m.nodeType&&(d+=m.nodeValue.length),null!==(y=m.firstChild);)v=m,m=y;for(;;){if(m===o)break e;if(v===u&&++p===a&&(f=d),v===l&&++g===c&&(h=d),null!==(y=m.nextSibling))break;v=(m=v).parentNode}m=y}u=-1===f||-1===h?null:{start:f,end:h}}else u=null;u=u||{start:0,end:0}}else u=null;Bn={focusedElem:o,selectionRange:u},Xe=!1,ou=null,uu=!1,Wo=n;do{try{Iu()}catch(A){if(null===Wo)throw Error(s(330));Uu(Wo,A),Wo=Wo.nextEffect}}while(null!==Wo);ou=null,Wo=n;do{try{for(o=t;null!==Wo;){var b=Wo.flags;if(16&b&&yt(Wo.stateNode,""),128&b){var E=Wo.alternate;if(null!==E){var T=E.ref;null!==T&&("function"===typeof T?T(null):T.current=null)}}switch(1038&b){case 2:bo(Wo),Wo.flags&=-3;break;case 6:bo(Wo),Wo.flags&=-3,wo(Wo.alternate,Wo);break;case 1024:Wo.flags&=-1025;break;case 1028:Wo.flags&=-1025,wo(Wo.alternate,Wo);break;case 4:wo(Wo.alternate,Wo);break;case 8:So(o,u=Wo);var S=u.alternate;vo(u),null!==S&&vo(S)}Wo=Wo.nextEffect}}catch(A){if(null===Wo)throw Error(s(330));Uu(Wo,A),Wo=Wo.nextEffect}}while(null!==Wo);if(T=Bn,E=hn(),b=T.focusedElem,o=T.selectionRange,E!==b&&b&&b.ownerDocument&&fn(b.ownerDocument.documentElement,b)){null!==o&&pn(b)&&(E=o.start,void 0===(T=o.end)&&(T=E),"selectionStart"in b?(b.selectionStart=E,b.selectionEnd=Math.min(T,b.value.length)):(T=(E=b.ownerDocument||document)&&E.defaultView||window).getSelection&&(T=T.getSelection(),u=b.textContent.length,S=Math.min(o.start,u),o=void 0===o.end?S:Math.min(o.end,u),!T.extend&&S>o&&(u=o,o=S,S=u),u=dn(b,S),a=dn(b,o),u&&a&&(1!==T.rangeCount||T.anchorNode!==u.node||T.anchorOffset!==u.offset||T.focusNode!==a.node||T.focusOffset!==a.offset)&&((E=E.createRange()).setStart(u.node,u.offset),T.removeAllRanges(),S>o?(T.addRange(E),T.extend(a.node,a.offset)):(E.setEnd(a.node,a.offset),T.addRange(E))))),E=[];for(T=b;T=T.parentNode;)1===T.nodeType&&E.push({element:T,left:T.scrollLeft,top:T.scrollTop});for("function"===typeof b.focus&&b.focus(),b=0;b<E.length;b++)(T=E[b]).element.scrollLeft=T.left,T.element.scrollTop=T.top}Xe=!!Nn,Bn=Nn=null,t.current=r,Wo=n;do{try{for(b=t;null!==Wo;){var w=Wo.flags;if(36&w&&po(b,Wo.alternate,Wo),128&w){E=void 0;var _=Wo.ref;if(null!==_){var k=Wo.stateNode;switch(Wo.tag){case 5:E=k;break;default:E=k}"function"===typeof _?_(E):_.current=E}}Wo=Wo.nextEffect}}catch(A){if(null===Wo)throw Error(s(330));Uu(Wo,A),Wo=Wo.nextEffect}}while(null!==Wo);Wo=null,Mi(),Ro=i}else t.current=r;if($o)$o=!1,Qo=t,Jo=e;else for(Wo=n;null!==Wo;)e=Wo.nextEffect,Wo.nextEffect=null,8&Wo.flags&&((w=Wo).sibling=null,w.stateNode=null),Wo=e;if(0===(n=t.pendingLanes)&&(Xo=null),1===n?t===nu?ru++:(ru=0,nu=t):ru=0,r=r.stateNode,Ti&&"function"===typeof Ti.onCommitFiberRoot)try{Ti.onCommitFiberRoot(Ei,r,void 0,64===(64&r.current.flags))}catch(A){}if(hu(t,Gi()),Yo)throw Yo=!1,t=qo,qo=null,t;return 0!==(8&Ro)||zi(),null}function Iu(){for(;null!==Wo;){var t=Wo.alternate;uu||null===ou||(0!==(8&Wo.flags)?te(Wo,ou)&&(uu=!0):13===Wo.tag&&ko(t,Wo)&&te(Wo,ou)&&(uu=!0));var e=Wo.flags;0!==(256&e)&&ho(t,Wo),0===(512&e)||$o||($o=!0,Ki(97,(function(){return xu(),null}))),Wo=Wo.nextEffect}}function xu(){if(90!==Jo){var t=97<Jo?97:Jo;return Jo=90,Vi(t,Mu)}return!1}function Ou(t,e){Zo.push(e,t),$o||($o=!0,Ki(97,(function(){return xu(),null})))}function Pu(t,e){tu.push(e,t),$o||($o=!0,Ki(97,(function(){return xu(),null})))}function Mu(){if(null===Qo)return!1;var t=Qo;if(Qo=null,0!==(48&Ro))throw Error(s(331));var e=Ro;Ro|=32;var r=tu;tu=[];for(var n=0;n<r.length;n+=2){var i=r[n],a=r[n+1],o=i.destroy;if(i.destroy=void 0,"function"===typeof o)try{o()}catch(l){if(null===a)throw Error(s(330));Uu(a,l)}}for(r=Zo,Zo=[],n=0;n<r.length;n+=2){i=r[n],a=r[n+1];try{var u=i.create;i.destroy=u()}catch(l){if(null===a)throw Error(s(330));Uu(a,l)}}for(u=t.current.firstEffect;null!==u;)t=u.nextEffect,u.nextEffect=null,8&u.flags&&(u.sibling=null,u.stateNode=null),u=t;return Ro=e,zi(),!0}function Fu(t,e,r){ua(t,e=uo(0,e=ao(r,e),1)),e=lu(),null!==(t=fu(t,1))&&(Ve(t,1,e),hu(t,e))}function Uu(t,e){if(3===t.tag)Fu(t,t,e);else for(var r=t.return;null!==r;){if(3===r.tag){Fu(r,t,e);break}if(1===r.tag){var n=r.stateNode;if("function"===typeof r.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Xo||!Xo.has(n))){var i=lo(r,t=ao(e,t),1);if(ua(r,i),i=lu(),null!==(r=fu(r,1)))Ve(r,1,i),hu(r,i);else if("function"===typeof n.componentDidCatch&&(null===Xo||!Xo.has(n)))try{n.componentDidCatch(e,t)}catch(a){}break}}r=r.return}}function Nu(t,e,r){var n=t.pingCache;null!==n&&n.delete(e),e=lu(),t.pingedLanes|=t.suspendedLanes&r,Co===t&&(xo&r)===r&&(4===Mo||3===Mo&&(62914560&xo)===xo&&500>Gi()-Ho?Tu(t,0):Go|=r),hu(t,e)}function Bu(t,e){var r=t.stateNode;null!==r&&r.delete(e),0===(e=0)&&(0===(2&(e=t.mode))?e=1:0===(4&e)?e=99===ji()?1:2:(0===au&&(au=Uo),0===(e=je(62914560&~au))&&(e=4194304))),r=lu(),null!==(t=fu(t,e))&&(Ve(t,e,r),hu(t,r))}function Gu(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function ju(t,e,r,n){return new Gu(t,e,r,n)}function Hu(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Vu(t,e){var r=t.alternate;return null===r?((r=ju(t.tag,e,t.key,t.mode)).elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null),r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ku(t,e,r,n,i,a){var o=2;if(n=t,"function"===typeof t)Hu(t)&&(o=1);else if("string"===typeof t)o=5;else t:switch(t){case _:return zu(r.children,i,a,e);case F:o=8,i|=16;break;case k:o=8,i|=1;break;case A:return(t=ju(12,r,e,8|i)).elementType=A,t.type=A,t.lanes=a,t;case C:return(t=ju(13,r,e,i)).type=C,t.elementType=C,t.lanes=a,t;case I:return(t=ju(19,r,e,i)).elementType=I,t.lanes=a,t;case U:return Wu(r,i,a,e);case N:return(t=ju(24,r,e,i)).elementType=N,t.lanes=a,t;default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case L:o=10;break t;case D:o=9;break t;case R:o=11;break t;case x:o=14;break t;case O:o=16,n=null;break t;case P:o=22;break t}throw Error(s(130,null==t?t:typeof t,""))}return(e=ju(o,r,e,i)).elementType=t,e.type=n,e.lanes=a,e}function zu(t,e,r,n){return(t=ju(7,t,n,e)).lanes=r,t}function Wu(t,e,r,n){return(t=ju(23,t,n,e)).elementType=U,t.lanes=r,t}function Yu(t,e,r){return(t=ju(6,t,null,e)).lanes=r,t}function qu(t,e,r){return(e=ju(4,null!==t.children?t.children:[],t.key,e)).lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Xu(t,e,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=r,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=He(0),this.expirationTimes=He(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=He(0),this.mutableSourceEagerHydrationData=null}function $u(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:t,containerInfo:e,implementation:r}}function Qu(t,e,r,n){var i=e.current,a=lu(),o=cu(i);t:if(r){e:{if($t(r=r._reactInternals)!==r||1!==r.tag)throw Error(s(170));var u=r;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(pi(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(null!==u);throw Error(s(171))}if(1===r.tag){var l=r.type;if(pi(l)){r=vi(r,l,u);break t}}r=u}else r=li;return null===e.context?e.context=r:e.pendingContext=r,(e=oa(a,o)).payload={element:t},null!==(n=void 0===n?null:n)&&(e.callback=n),ua(i,e),du(i,o,a),o}function Ju(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:default:return t.child.stateNode}}function Zu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var r=t.retryLane;t.retryLane=0!==r&&r<e?r:e}}function tl(t,e){Zu(t,e),(t=t.alternate)&&Zu(t,e)}function el(t,e,r){var n=null!=r&&null!=r.hydrationOptions&&r.hydrationOptions.mutableSources||null;if(r=new Xu(t,e,null!=r&&!0===r.hydrate),e=ju(3,null,null,2===e?7:1===e?3:0),r.current=e,e.stateNode=r,aa(e),t[Qn]=r.current,Rn(8===t.nodeType?t.parentNode:t),n)for(t=0;t<n.length;t++){var i=(e=n[t])._getVersion;i=i(e._source),null==r.mutableSourceEagerHydrationData?r.mutableSourceEagerHydrationData=[e,i]:r.mutableSourceEagerHydrationData.push(e,i)}this._internalRoot=r}function rl(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function nl(t,e,r,n,i){var a=r._reactRootContainer;if(a){var s=a._internalRoot;if("function"===typeof i){var o=i;i=function(){var t=Ju(s);o.call(t)}}Qu(e,s,t,i)}else{if(a=r._reactRootContainer=function(t,e){if(e||(e=!(!(e=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var r;r=t.lastChild;)t.removeChild(r);return new el(t,0,e?{hydrate:!0}:void 0)}(r,n),s=a._internalRoot,"function"===typeof i){var u=i;i=function(){var t=Ju(s);u.call(t)}}yu((function(){Qu(e,s,t,i)}))}return Ju(s)}function il(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!rl(e))throw Error(s(200));return $u(t,e,null,r)}zo=function(t,e,r){var n=e.lanes;if(null!==t)if(t.memoizedProps!==e.pendingProps||di.current)Os=!0;else{if(0===(r&n)){switch(Os=!1,e.tag){case 3:Vs(e),Ka();break;case 5:xa(e);break;case 1:pi(e.type)&&yi(e);break;case 4:Ca(e,e.stateNode.containerInfo);break;case 10:n=e.memoizedProps.value;var i=e.type._context;ui(Xi,i._currentValue),i._currentValue=n;break;case 13:if(null!==e.memoizedState)return 0!==(r&e.child.childLanes)?qs(t,e,r):(ui(Pa,1&Pa.current),null!==(e=eo(t,e,r))?e.sibling:null);ui(Pa,1&Pa.current);break;case 19:if(n=0!==(r&e.childLanes),0!==(64&t.flags)){if(n)return to(t,e,r);e.flags|=64}if(null!==(i=e.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),ui(Pa,Pa.current),n)break;return null;case 23:case 24:return e.lanes=0,Ns(t,e,r)}return eo(t,e,r)}Os=0!==(16384&t.flags)}else Os=!1;switch(e.lanes=0,e.tag){case 2:if(n=e.type,null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,i=hi(e,ci.current),ra(e,r),i=ns(null,e,n,t,i,r),e.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,pi(n)){var a=!0;yi(e)}else a=!1;e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,aa(e);var o=n.getDerivedStateFromProps;"function"===typeof o&&ha(e,n,o,t),i.updater=pa,e.stateNode=i,i._reactInternals=e,ya(e,n,t,r),e=Hs(null,e,n,!0,a,r)}else e.tag=0,Ps(null,e,i,r),e=e.child;return e;case 16:i=e.elementType;t:{switch(null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,i=(a=i._init)(i._payload),e.type=i,a=e.tag=function(t){if("function"===typeof t)return Hu(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===R)return 11;if(t===x)return 14}return 2}(i),t=qi(i,t),a){case 0:e=Gs(null,e,i,t,r);break t;case 1:e=js(null,e,i,t,r);break t;case 11:e=Ms(null,e,i,t,r);break t;case 14:e=Fs(null,e,i,qi(i.type,t),n,r);break t}throw Error(s(306,i,""))}return e;case 0:return n=e.type,i=e.pendingProps,Gs(t,e,n,i=e.elementType===n?i:qi(n,i),r);case 1:return n=e.type,i=e.pendingProps,js(t,e,n,i=e.elementType===n?i:qi(n,i),r);case 3:if(Vs(e),n=e.updateQueue,null===t||null===n)throw Error(s(282));if(n=e.pendingProps,i=null!==(i=e.memoizedState)?i.element:null,sa(t,e),ca(e,n,null,r),(n=e.memoizedState.element)===i)Ka(),e=eo(t,e,r);else{if((a=(i=e.stateNode).hydrate)&&(Ua=zn(e.stateNode.containerInfo.firstChild),Fa=e,a=Na=!0),a){if(null!=(t=i.mutableSourceEagerHydrationData))for(i=0;i<t.length;i+=2)(a=t[i])._workInProgressVersionPrimary=t[i+1],za.push(a);for(r=_a(e,null,n,r),e.child=r;r;)r.flags=-3&r.flags|1024,r=r.sibling}else Ps(t,e,n,r),Ka();e=e.child}return e;case 5:return xa(e),null===t&&ja(e),n=e.type,i=e.pendingProps,a=null!==t?t.memoizedProps:null,o=i.children,jn(n,i)?o=null:null!==a&&jn(n,a)&&(e.flags|=16),Bs(t,e),Ps(t,e,o,r),e.child;case 6:return null===t&&ja(e),null;case 13:return qs(t,e,r);case 4:return Ca(e,e.stateNode.containerInfo),n=e.pendingProps,null===t?e.child=wa(e,null,n,r):Ps(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,Ms(t,e,n,i=e.elementType===n?i:qi(n,i),r);case 7:return Ps(t,e,e.pendingProps,r),e.child;case 8:case 12:return Ps(t,e,e.pendingProps.children,r),e.child;case 10:t:{n=e.type._context,i=e.pendingProps,o=e.memoizedProps,a=i.value;var u=e.type._context;if(ui(Xi,u._currentValue),u._currentValue=a,null!==o)if(u=o.value,0===(a=on(u,a)?0:0|("function"===typeof n._calculateChangedBits?n._calculateChangedBits(u,a):1073741823))){if(o.children===i.children&&!di.current){e=eo(t,e,r);break t}}else for(null!==(u=e.child)&&(u.return=e);null!==u;){var l=u.dependencies;if(null!==l){o=u.child;for(var c=l.firstContext;null!==c;){if(c.context===n&&0!==(c.observedBits&a)){1===u.tag&&((c=oa(-1,r&-r)).tag=2,ua(u,c)),u.lanes|=r,null!==(c=u.alternate)&&(c.lanes|=r),ea(u.return,r),l.lanes|=r;break}c=c.next}}else o=10===u.tag&&u.type===e.type?null:u.child;if(null!==o)o.return=u;else for(o=u;null!==o;){if(o===e){o=null;break}if(null!==(u=o.sibling)){u.return=o.return,o=u;break}o=o.return}u=o}Ps(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=(a=e.pendingProps).children,ra(e,r),n=n(i=na(i,a.unstable_observedBits)),e.flags|=1,Ps(t,e,n,r),e.child;case 14:return a=qi(i=e.type,e.pendingProps),Fs(t,e,i,a=qi(i.type,a),n,r);case 15:return Us(t,e,e.type,e.pendingProps,n,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:qi(n,i),null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,pi(n)?(t=!0,yi(e)):t=!1,ra(e,r),ma(e,n,i),ya(e,n,i,r),Hs(null,e,n,!0,t,r);case 19:return to(t,e,r);case 23:case 24:return Ns(t,e,r)}throw Error(s(156,e.tag))},el.prototype.render=function(t){Qu(t,this._internalRoot,null,null)},el.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Qu(null,t,null,(function(){e[Qn]=null}))},ee=function(t){13===t.tag&&(du(t,4,lu()),tl(t,4))},re=function(t){13===t.tag&&(du(t,67108864,lu()),tl(t,67108864))},ne=function(t){if(13===t.tag){var e=lu(),r=cu(t);du(t,r,e),tl(t,r)}},ie=function(t,e){return e()},Lt=function(t,e,r){switch(e){case"input":if(rt(t,r),e=r.name,"radio"===r.type&&null!=e){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=ri(n);if(!i)throw Error(s(90));Q(n),rt(n,i)}}}break;case"textarea":lt(t,r);break;case"select":null!=(e=r.value)&&st(t,!!r.multiple,e,!1)}},Ot=vu,Pt=function(t,e,r,n,i){var a=Ro;Ro|=4;try{return Vi(98,t.bind(null,e,r,n,i))}finally{0===(Ro=a)&&(Ko(),zi())}},Mt=function(){0===(49&Ro)&&(function(){if(null!==eu){var t=eu;eu=null,t.forEach((function(t){t.expiredLanes|=24&t.pendingLanes,hu(t,Gi())}))}zi()}(),xu())},Ft=function(t,e){var r=Ro;Ro|=2;try{return t(e)}finally{0===(Ro=r)&&(Ko(),zi())}};var al={Events:[ti,ei,ri,It,xt,xu,{current:!1}]},sl={findFiberByHostInstance:Zn,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},ol={bundleType:sl.bundleType,version:sl.version,rendererPackageName:sl.rendererPackageName,rendererConfig:sl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Zt(t))?null:t.stateNode},findFiberByHostInstance:sl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ul=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ul.isDisabled&&ul.supportsFiber)try{Ei=ul.inject(ol),Ti=ul}catch(mt){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=al,e.createPortal=il,e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(s(188));throw Error(s(268,Object.keys(t)))}return t=null===(t=Zt(e))?null:t.stateNode},e.flushSync=function(t,e){var r=Ro;if(0!==(48&r))return t(e);Ro|=1;try{if(t)return Vi(99,t.bind(null,e))}finally{Ro=r,zi()}},e.hydrate=function(t,e,r){if(!rl(e))throw Error(s(200));return nl(null,t,e,!0,r)},e.render=function(t,e,r){if(!rl(e))throw Error(s(200));return nl(null,t,e,!1,r)},e.unmountComponentAtNode=function(t){if(!rl(t))throw Error(s(40));return!!t._reactRootContainer&&(yu((function(){nl(null,null,t,!1,(function(){t._reactRootContainer=null,t[Qn]=null}))})),!0)},e.unstable_batchedUpdates=vu,e.unstable_createPortal=function(t,e){return il(t,e,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},e.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!rl(r))throw Error(s(200));if(null==t||void 0===t._reactInternals)throw Error(s(38));return nl(t,e,r,!1,n)},e.version="17.0.2"},function(t,e,r){"use strict";t.exports=r(51)},function(t,e,r){"use strict";var n,i,a,s;if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var u=Date,l=u.now();e.unstable_now=function(){return u.now()-l}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var c=null,d=null,f=function t(){if(null!==c)try{var r=e.unstable_now();c(!0,r),c=null}catch(n){throw setTimeout(t,0),n}};n=function(t){null!==c?setTimeout(n,0,t):(c=t,setTimeout(f,0))},i=function(t,e){d=setTimeout(t,e)},a=function(){clearTimeout(d)},e.unstable_shouldYield=function(){return!1},s=e.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var g=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof g&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var m=!1,v=null,y=-1,b=5,E=0;e.unstable_shouldYield=function(){return e.unstable_now()>=E},s=function(){},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<t?Math.floor(1e3/t):5};var T=new MessageChannel,S=T.port2;T.port1.onmessage=function(){if(null!==v){var t=e.unstable_now();E=t+b;try{v(!0,t)?S.postMessage(null):(m=!1,v=null)}catch(r){throw S.postMessage(null),r}}else m=!1},n=function(t){v=t,m||(m=!0,S.postMessage(null))},i=function(t,r){y=h((function(){t(e.unstable_now())}),r)},a=function(){p(y),y=-1}}function w(t,e){var r=t.length;t.push(e);t:for(;;){var n=r-1>>>1,i=t[n];if(!(void 0!==i&&0<A(i,e)))break t;t[n]=e,t[r]=i,r=n}}function _(t){return void 0===(t=t[0])?null:t}function k(t){var e=t[0];if(void 0!==e){var r=t.pop();if(r!==e){t[0]=r;t:for(var n=0,i=t.length;n<i;){var a=2*(n+1)-1,s=t[a],o=a+1,u=t[o];if(void 0!==s&&0>A(s,r))void 0!==u&&0>A(u,s)?(t[n]=u,t[o]=r,n=o):(t[n]=s,t[a]=r,n=a);else{if(!(void 0!==u&&0>A(u,r)))break t;t[n]=u,t[o]=r,n=o}}}return e}return null}function A(t,e){var r=t.sortIndex-e.sortIndex;return 0!==r?r:t.id-e.id}var L=[],D=[],R=1,C=null,I=3,x=!1,O=!1,P=!1;function M(t){for(var e=_(D);null!==e;){if(null===e.callback)k(D);else{if(!(e.startTime<=t))break;k(D),e.sortIndex=e.expirationTime,w(L,e)}e=_(D)}}function F(t){if(P=!1,M(t),!O)if(null!==_(L))O=!0,n(U);else{var e=_(D);null!==e&&i(F,e.startTime-t)}}function U(t,r){O=!1,P&&(P=!1,a()),x=!0;var n=I;try{for(M(r),C=_(L);null!==C&&(!(C.expirationTime>r)||t&&!e.unstable_shouldYield());){var s=C.callback;if("function"===typeof s){C.callback=null,I=C.priorityLevel;var o=s(C.expirationTime<=r);r=e.unstable_now(),"function"===typeof o?C.callback=o:C===_(L)&&k(L),M(r)}else k(L);C=_(L)}if(null!==C)var u=!0;else{var l=_(D);null!==l&&i(F,l.startTime-r),u=!1}return u}finally{C=null,I=n,x=!1}}var N=s;e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){O||x||(O=!0,n(U))},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_getFirstCallbackNode=function(){return _(L)},e.unstable_next=function(t){switch(I){case 1:case 2:case 3:var e=3;break;default:e=I}var r=I;I=e;try{return t()}finally{I=r}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=N,e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var r=I;I=t;try{return e()}finally{I=r}},e.unstable_scheduleCallback=function(t,r,s){var o=e.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,t){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return t={id:R++,callback:r,priorityLevel:t,startTime:s,expirationTime:u=s+u,sortIndex:-1},s>o?(t.sortIndex=s,w(D,t),null===_(L)&&t===_(D)&&(P?a():P=!0,i(F,s-o))):(t.sortIndex=u,w(L,t),O||x||(O=!0,n(U))),t},e.unstable_wrapCallback=function(t){var e=I;return function(){var r=I;I=e;try{return t.apply(this,arguments)}finally{I=r}}}},,function(t,e,r){var n=function(t){"use strict";var e,r=Object.prototype,n=r.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(I){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new D(n||[]);return a._invoke=function(t,e,r){var n=d;return function(i,a){if(n===h)throw new Error("Generator is already running");if(n===p){if("throw"===i)throw a;return C()}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var o=k(s,r);if(o){if(o===g)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===d)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var u=c(t,e,r);if("normal"===u.type){if(n=r.done?p:f,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(t,r,s),a}function c(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(I){return{type:"throw",arg:I}}}t.wrap=l;var d="suspendedStart",f="suspendedYield",h="executing",p="completed",g={};function m(){}function v(){}function y(){}var b={};b[a]=function(){return this};var E=Object.getPrototypeOf,T=E&&E(E(R([])));T&&T!==r&&n.call(T,a)&&(b=T);var S=y.prototype=m.prototype=Object.create(b);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(i,a,s,o){var u=c(t[i],t,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"===typeof d&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,s,o)}),(function(t){r("throw",t,s,o)})):e.resolve(d).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,o)}))}o(u.arg)}var i;this._invoke=function(t,n){function a(){return new e((function(e,i){r(t,n,e,i)}))}return i=i?i.then(a,a):a()}}function k(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,k(t,r),"throw"===r.method))return g;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=c(n,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function D(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var r=t[a];if(r)return r.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return s.next=s}}return{next:C}}function C(){return{value:e,done:!0}}return v.prototype=S.constructor=y,y.constructor=v,v.displayName=u(y,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,o,"GeneratorFunction")),t.prototype=Object.create(S),t},t.awrap=function(t){return{__await:t}},w(_.prototype),_.prototype[s]=function(){return this},t.AsyncIterator=_,t.async=function(e,r,n,i,a){void 0===a&&(a=Promise);var s=new _(l(e,r,n,i),a);return t.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},w(S),u(S,o,"Generator"),S[a]=function(){return this},S.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=R,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(n,i){return o.type="throw",o.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),l=n.call(s,"finallyLoc");if(u&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:R(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}(t.exports);try{regeneratorRuntime=n}catch(i){Function("r","regeneratorRuntime = r")(n)}},,function(t,e,r){"use strict";var n=r(6),i=r(34),a=r(56),s=r(40);function o(t){var e=new a(t),r=i(a.prototype.request,e);return n.extend(r,a.prototype,e),n.extend(r,e),r}var u=o(r(37));u.Axios=a,u.create=function(t){return o(s(u.defaults,t))},u.Cancel=r(41),u.CancelToken=r(70),u.isCancel=r(36),u.all=function(t){return Promise.all(t)},u.spread=r(71),u.isAxiosError=r(72),t.exports=u,t.exports.default=u},function(t,e,r){"use strict";var n=r(6),i=r(35),a=r(57),s=r(58),o=r(40);function u(t){this.defaults=t,this.interceptors={request:new a,response:new a}}u.prototype.request=function(t){"string"===typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=o(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[s,void 0],r=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)r=r.then(e.shift(),e.shift());return r},u.prototype.getUri=function(t){return t=o(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(t){u.prototype[t]=function(e,r){return this.request(o(r||{},{method:t,url:e,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(t){u.prototype[t]=function(e,r,n){return this.request(o(n||{},{method:t,url:e,data:r}))}})),t.exports=u},function(t,e,r){"use strict";var n=r(6);function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){n.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=i},function(t,e,r){"use strict";var n=r(6),i=r(59),a=r(36),s=r(37);function o(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return o(t),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||s.adapter)(t).then((function(e){return o(t),e.data=i(e.data,e.headers,t.transformResponse),e}),(function(e){return a(e)||(o(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},function(t,e,r){"use strict";var n=r(6);t.exports=function(t,e,r){return n.forEach(r,(function(r){t=r(t,e)})),t}},function(t,e){var r,n,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"===typeof setTimeout?setTimeout:a}catch(t){r=a}try{n="function"===typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var u,l=[],c=!1,d=-1;function f(){c&&u&&(c=!1,u.length?l=u.concat(l):d=-1,l.length&&h())}function h(){if(!c){var t=o(f);c=!0;for(var e=l.length;e;){for(u=l,l=[];++d<e;)u&&u[d].run();d=-1,e=l.length}u=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new p(t,e)),1!==l.length||c||o(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,r){"use strict";var n=r(6);t.exports=function(t,e){n.forEach(t,(function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])}))}},function(t,e,r){"use strict";var n=r(39);t.exports=function(t,e,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?e(n("Request failed with status code "+r.status,r.config,null,r.request,r)):t(r)}},function(t,e,r){"use strict";t.exports=function(t,e,r,n,i){return t.config=e,r&&(t.code=r),t.request=n,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,r){"use strict";var n=r(6);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,i,a,s){var o=[];o.push(t+"="+encodeURIComponent(e)),n.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),n.isString(i)&&o.push("path="+i),n.isString(a)&&o.push("domain="+a),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,r){"use strict";var n=r(66),i=r(67);t.exports=function(t,e){return t&&!n(e)?i(t,e):e}},function(t,e,r){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,r){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,r){"use strict";var n=r(6),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,r,a,s={};return t?(n.forEach(t.split("\n"),(function(t){if(a=t.indexOf(":"),e=n.trim(t.substr(0,a)).toLowerCase(),r=n.trim(t.substr(a+1)),e){if(s[e]&&i.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([r]):s[e]?s[e]+", "+r:r}})),s):s}},function(t,e,r){"use strict";var n=r(6);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=i(window.location.href),function(e){var r=n.isString(e)?i(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},function(t,e,r){"use strict";var n=r(41);function i(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var r=this;t((function(t){r.reason||(r.reason=new n(t),e(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i((function(e){t=e})),cancel:t}},t.exports=i},function(t,e,r){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,r){"use strict";t.exports=function(t){return"object"===typeof t&&!0===t.isAxiosError}},function(t,e,r){"use strict";r(29);var n=r(7),i=60103;if(e.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var a=Symbol.for;i=a("react.element"),e.Fragment=a("react.fragment")}var s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o=Object.prototype.hasOwnProperty,u={key:!0,ref:!0,__self:!0,__source:!0};function l(t,e,r){var n,a={},l=null,c=null;for(n in void 0!==r&&(l=""+r),void 0!==e.key&&(l=""+e.key),void 0!==e.ref&&(c=e.ref),e)o.call(e,n)&&!u.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===a[n]&&(a[n]=e[n]);return{$$typeof:i,type:t,key:l,ref:c,props:a,_owner:s.current}}e.jsx=l,e.jsxs=l},function(t,e){function r(e,n){return t.exports=r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.default=t.exports,t.exports.__esModule=!0,r(e,n)}t.exports=r,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,r){"use strict";(function(t){var n=r(76),i=r(77),a=r(78);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,r){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(t,e,r);if("number"===typeof t){if("string"===typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return l(this,t,e,r)}function l(t,e,r,n){if("number"===typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,r,n):"string"===typeof e?function(t,e,r){"string"===typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(e,r),i=(t=o(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(u.isBuffer(e)){var r=0|h(e.length);return 0===(t=o(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!==typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!==typeof e.length||(n=e.length)!==n?o(t,0):f(t,e);if("Buffer"===e.type&&a(e.data))return f(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!==typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e){if(c(e),t=o(t,e<0?0:0|h(e)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function f(t,e){var r=e.length<0?0:0|h(e.length);t=o(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function h(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!==typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return H(t).length;default:if(n)return j(t).length;e=(""+e).toLowerCase(),n=!0}}function g(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,r);case"utf8":case"utf-8":return A(this,e,r);case"ascii":return D(this,e,r);case"latin1":case"binary":return R(this,e,r);case"base64":return k(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function m(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function v(t,e,r,n,i){if(0===t.length)return-1;if("string"===typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"===typeof e&&(e=u.from(e,n)),u.isBuffer(e))return 0===e.length?-1:y(t,e,r,n,i);if("number"===typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):y(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,r,n,i){var a,s=1,o=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,o/=2,u/=2,r/=2}function l(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var c=-1;for(a=r;a<o;a++)if(l(t,a)===l(e,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===u)return c*s}else-1!==c&&(a-=a-c),c=-1}else for(r+u>o&&(r=o-u),a=r;a>=0;a--){for(var d=!0,f=0;f<u;f++)if(l(t,a+f)!==l(e,f)){d=!1;break}if(d)return a}return-1}function b(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var a=e.length;if(a%2!==0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var s=0;s<n;++s){var o=parseInt(e.substr(2*s,2),16);if(isNaN(o))return s;t[r+s]=o}return s}function E(t,e,r,n){return V(j(e,t.length-r),t,r,n)}function T(t,e,r,n){return V(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function S(t,e,r,n){return T(t,e,r,n)}function w(t,e,r,n){return V(H(e),t,r,n)}function _(t,e,r,n){return V(function(t,e){for(var r,n,i,a=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,i=r%256,a.push(i),a.push(n);return a}(e,t.length-r),t,r,n)}function k(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function A(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var a,s,o,u,l=t[i],c=null,d=l>239?4:l>223?3:l>191?2:1;if(i+d<=r)switch(d){case 1:l<128&&(c=l);break;case 2:128===(192&(a=t[i+1]))&&(u=(31&l)<<6|63&a)>127&&(c=u);break;case 3:a=t[i+1],s=t[i+2],128===(192&a)&&128===(192&s)&&(u=(15&l)<<12|(63&a)<<6|63&s)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:a=t[i+1],s=t[i+2],o=t[i+3],128===(192&a)&&128===(192&s)&&128===(192&o)&&(u=(15&l)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&u<1114112&&(c=u)}null===c?(c=65533,d=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=d}return function(t){var e=t.length;if(e<=L)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=L));return r}(n)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"===typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,r){return l(null,t,e,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,r){return function(t,e,r,n){return c(e),e<=0?o(t,e):void 0!==r?"string"===typeof n?o(t,e).fill(r,n):o(t,e).fill(r):o(t,e)}(null,t,e,r)},u.allocUnsafe=function(t){return d(null,t)},u.allocUnsafeSlow=function(t){return d(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,a=Math.min(r,n);i<a;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=u.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?A(this,0,t):g.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,r,n,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0),o=Math.min(a,s),l=this.slice(n,i),c=t.slice(e,r),d=0;d<o;++d)if(l[d]!==c[d]){a=l[d],s=c[d];break}return a<s?-1:s<a?1:0},u.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},u.prototype.indexOf=function(t,e,r){return v(this,t,e,r,!0)},u.prototype.lastIndexOf=function(t,e,r){return v(this,t,e,r,!1)},u.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"===typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return b(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":return T(this,t,e,r);case"latin1":case"binary":return S(this,t,e,r);case"base64":return w(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var L=4096;function D(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function R(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function C(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",a=e;a<r;++a)i+=G(t[a]);return i}function I(t,e,r){for(var n=t.slice(e,r),i="",a=0;a<n.length;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}function x(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,r,n,i,a){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function P(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-r,2);i<a;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function M(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-r,4);i<a;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function F(t,e,r,n,i,a){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(t,e,r,n,a){return a||F(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function N(t,e,r,n,a){return a||F(t,0,r,8),i.write(t,e,r,n,52,8),r+8}u.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;r=new u(i,void 0);for(var a=0;a<i;++a)r[a]=this[a+t]}return r},u.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=this[t],i=1,a=0;++a<e&&(i*=256);)n+=this[t+a]*i;return n},u.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},u.prototype.readUInt8=function(t,e){return e||x(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||x(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||x(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||x(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||x(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=this[t],i=1,a=0;++a<e&&(i*=256);)n+=this[t+a]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},u.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||x(t,e,this.length);for(var n=e,i=1,a=this[t+--n];n>0&&(i*=256);)a+=this[t+--n]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},u.prototype.readInt8=function(t,e){return e||x(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||x(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(t,e){e||x(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(t,e){return e||x(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||x(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||x(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||x(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||O(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,a=0;for(this[e]=255&t;++a<r&&(i*=256);)this[e+a]=t/i&255;return e+r},u.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||O(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+r},u.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):P(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):P(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):M(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);O(this,t,e,r,i-1,-i)}var a=0,s=1,o=0;for(this[e]=255&t;++a<r&&(s*=256);)t<0&&0===o&&0!==this[e+a-1]&&(o=1),this[e+a]=(t/s>>0)-o&255;return e+r},u.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);O(this,t,e,r,i-1,-i)}var a=r-1,s=1,o=0;for(this[e+a]=255&t;--a>=0&&(s*=256);)t<0&&0===o&&0!==this[e+a+1]&&(o=1),this[e+a]=(t/s>>0)-o&255;return e+r},u.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):P(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):P(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):M(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,r){return U(this,t,e,!0,r)},u.prototype.writeFloatBE=function(t,e,r){return U(this,t,e,!1,r)},u.prototype.writeDoubleLE=function(t,e,r){return N(this,t,e,!0,r)},u.prototype.writeDoubleBE=function(t,e,r){return N(this,t,e,!1,r)},u.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,a=n-r;if(this===t&&r<e&&e<n)for(i=a-1;i>=0;--i)t[i+e]=this[i+r];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+a),e);return a},u.prototype.fill=function(t,e,r,n){if("string"===typeof t){if("string"===typeof e?(n=e,e=0,r=this.length):"string"===typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"===typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var a;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"===typeof t)for(a=e;a<r;++a)this[a]=t;else{var s=u.isBuffer(t)?t:j(new u(t,n).toString()),o=s.length;for(a=0;a<r-e;++a)this[a+e]=s[a%o]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function G(t){return t<16?"0"+t.toString(16):t.toString(16)}function j(t,e){var r;e=e||1/0;for(var n=t.length,i=null,a=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;a.push(r)}else if(r<2048){if((e-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function H(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!==0;)t+="=";return t}(t))}function V(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}}).call(this,r(42))},function(t,e,r){"use strict";e.byteLength=function(t){var e=l(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,n=l(t),s=n[0],o=n[1],u=new a(function(t,e,r){return 3*(e+r)/4-r}(0,s,o)),c=0,d=o>0?s-4:s;for(r=0;r<d;r+=4)e=i[t.charCodeAt(r)]<<18|i[t.charCodeAt(r+1)]<<12|i[t.charCodeAt(r+2)]<<6|i[t.charCodeAt(r+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=255&e;2===o&&(e=i[t.charCodeAt(r)]<<2|i[t.charCodeAt(r+1)]>>4,u[c++]=255&e);1===o&&(e=i[t.charCodeAt(r)]<<10|i[t.charCodeAt(r+1)]<<4|i[t.charCodeAt(r+2)]>>2,u[c++]=e>>8&255,u[c++]=255&e);return u},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,a=[],s=16383,o=0,u=r-i;o<u;o+=s)a.push(c(t,o,o+s>u?u:o+s));1===i?(e=t[r-1],a.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],a.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return a.join("")};for(var n=[],i=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,u=s.length;o<u;++o)n[o]=s[o],i[s.charCodeAt(o)]=o;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,r){for(var i,a,s=[],o=e;o<r;o+=3)i=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),s.push(n[(a=i)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,r,n,i){var a,s,o=8*i-n-1,u=(1<<o)-1,l=u>>1,c=-7,d=r?i-1:0,f=r?-1:1,h=t[e+d];for(d+=f,a=h&(1<<-c)-1,h>>=-c,c+=o;c>0;a=256*a+t[e+d],d+=f,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=n;c>0;s=256*s+t[e+d],d+=f,c-=8);if(0===a)a=1-l;else{if(a===u)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),a-=l}return(h?-1:1)*s*Math.pow(2,a-n)},e.write=function(t,e,r,n,i,a){var s,o,u,l=8*a-i-1,c=(1<<l)-1,d=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:a-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(s++,u/=2),s+d>=c?(o=0,s=c):s+d>=1?(o=(e*u-1)*Math.pow(2,i),s+=d):(o=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;t[r+h]=255&o,h+=p,o/=256,i-=8);for(s=s<<i|o,l+=i;l>0;t[r+h]=255&s,h+=p,s/=256,l-=8);t[r+h-p]|=128*g}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e,r){t.exports=function(){"use strict";var t=function(){this.init=function(){var t={};this.on=function(e,r){t[e]||(t[e]=[]),t[e]=t[e].concat(r)},this.off=function(e,r){var n;return!!t[e]&&(n=t[e].indexOf(r),t[e]=t[e].slice(),t[e].splice(n,1),n>-1)},this.trigger=function(e){var r,n,i,a;if(r=t[e])if(2===arguments.length)for(i=r.length,n=0;n<i;++n)r[n].call(this,arguments[1]);else{for(a=[],n=arguments.length,n=1;n<arguments.length;++n)a.push(arguments[n]);for(i=r.length,n=0;n<i;++n)r[n].apply(this,a)}},this.dispose=function(){t={}}}};t.prototype.pipe=function(t){return this.on("data",(function(e){t.push(e)})),this.on("done",(function(e){t.flush(e)})),this.on("partialdone",(function(e){t.partialFlush(e)})),this.on("endedtimeline",(function(e){t.endTimeline(e)})),this.on("reset",(function(e){t.reset(e)})),t},t.prototype.push=function(t){this.trigger("data",t)},t.prototype.flush=function(t){this.trigger("done",t)},t.prototype.partialFlush=function(t){this.trigger("partialdone",t)},t.prototype.endTimeline=function(t){this.trigger("endedtimeline",t)},t.prototype.reset=function(t){this.trigger("reset",t)};var e,r,n,i,a,s,o,u=t,l=9e4;a=function(t,r){return e(i(t,r))},s=function(t,e){return r(n(t),e)},o=function(t,e,r){return n(r?t:t-e)};var c,d={ONE_SECOND_IN_TS:l,secondsToVideoTs:e=function(t){return t*l},secondsToAudioTs:r=function(t,e){return t*e},videoTsToSeconds:n=function(t){return t/l},audioTsToSeconds:i=function(t,e){return t/e},audioTsToVideoTs:a,videoTsToAudioTs:s,metadataTsToSeconds:o},f=d.ONE_SECOND_IN_TS,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(c=function(t){var e,r=0;c.prototype.init.call(this),this.push=function(n){var i,a,s,o,u,l,c=0;if(t||(r=0),"audio"===n.type)for(e?(o=e,(e=new Uint8Array(o.byteLength+n.data.byteLength)).set(o),e.set(n.data,o.byteLength)):e=n.data;c+5<e.length;)if(255===e[c]&&240===(246&e[c+1])){if(a=2*(1&~e[c+1]),i=(3&e[c+3])<<11|e[c+4]<<3|(224&e[c+5])>>5,l=(u=1024*(1+(3&e[c+6])))*f/h[(60&e[c+2])>>>2],s=c+i,e.byteLength<s)return;if(this.trigger("data",{pts:n.pts+r*l,dts:n.dts+r*l,sampleCount:u,audioobjecttype:1+(e[c+2]>>>6&3),channelcount:(1&e[c+2])<<2|(192&e[c+3])>>>6,samplerate:h[(60&e[c+2])>>>2],samplingfrequencyindex:(60&e[c+2])>>>2,samplesize:16,data:e.subarray(c+7+a,s)}),r++,e.byteLength===s)return void(e=void 0);e=e.subarray(s)}else c++},this.flush=function(){r=0,this.trigger("done")},this.reset=function(){e=void 0,this.trigger("reset")},this.endTimeline=function(){e=void 0,this.trigger("endedtimeline")}}).prototype=new u;var p,g,m,v=c,y=function(t){var e=t.byteLength,r=0,n=0;this.length=function(){return 8*e},this.bitsAvailable=function(){return 8*e+n},this.loadWord=function(){var i=t.byteLength-e,a=new Uint8Array(4),s=Math.min(4,e);if(0===s)throw new Error("no bytes available");a.set(t.subarray(i,i+s)),r=new DataView(a.buffer).getUint32(0),n=8*s,e-=s},this.skipBits=function(t){var i;n>t?(r<<=t,n-=t):(t-=n,t-=8*(i=Math.floor(t/8)),e-=i,this.loadWord(),r<<=t,n-=t)},this.readBits=function(t){var i=Math.min(n,t),a=r>>>32-i;return(n-=i)>0?r<<=i:e>0&&this.loadWord(),(i=t-i)>0?a<<i|this.readBits(i):a},this.skipLeadingZeros=function(){var t;for(t=0;t<n;++t)if(0!==(r&2147483648>>>t))return r<<=t,n-=t,t;return this.loadWord(),t+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var t=this.skipLeadingZeros();return this.readBits(t+1)-1},this.readExpGolomb=function(){var t=this.readUnsignedExpGolomb();return 1&t?1+t>>>1:-1*(t>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(g=function(){var t,e,r=0;g.prototype.init.call(this),this.push=function(n){var i;e?((i=new Uint8Array(e.byteLength+n.data.byteLength)).set(e),i.set(n.data,e.byteLength),e=i):e=n.data;for(var a=e.byteLength;r<a-3;r++)if(1===e[r+2]){t=r+5;break}for(;t<a;)switch(e[t]){case 0:if(0!==e[t-1]){t+=2;break}if(0!==e[t-2]){t++;break}r+3!==t-2&&this.trigger("data",e.subarray(r+3,t-2));do{t++}while(1!==e[t]&&t<a);r=t-2,t+=3;break;case 1:if(0!==e[t-1]||0!==e[t-2]){t+=3;break}this.trigger("data",e.subarray(r+3,t-2)),r=t-2,t+=3;break;default:t+=3}e=e.subarray(r),t-=r,r=0},this.reset=function(){e=null,r=0,this.trigger("reset")},this.flush=function(){e&&e.byteLength>3&&this.trigger("data",e.subarray(r+3)),e=null,r=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new u,m={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(p=function(){var t,e,r,n,i,a,s,o=new g;p.prototype.init.call(this),t=this,this.push=function(t){"video"===t.type&&(e=t.trackId,r=t.pts,n=t.dts,o.push(t))},o.on("data",(function(s){var o={trackId:e,pts:r,dts:n,data:s};switch(31&s[0]){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp",o.escapedRBSP=i(s.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp",o.escapedRBSP=i(s.subarray(1)),o.config=a(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp"}t.trigger("data",o)})),o.on("done",(function(){t.trigger("done")})),o.on("partialdone",(function(){t.trigger("partialdone")})),o.on("reset",(function(){t.trigger("reset")})),o.on("endedtimeline",(function(){t.trigger("endedtimeline")})),this.flush=function(){o.flush()},this.partialFlush=function(){o.partialFlush()},this.reset=function(){o.reset()},this.endTimeline=function(){o.endTimeline()},s=function(t,e){var r,n=8,i=8;for(r=0;r<t;r++)0!==i&&(i=(n+e.readExpGolomb()+256)%256),n=0===i?n:i},i=function(t){for(var e,r,n=t.byteLength,i=[],a=1;a<n-2;)0===t[a]&&0===t[a+1]&&3===t[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return t;e=n-i.length,r=new Uint8Array(e);var s=0;for(a=0;a<e;s++,a++)s===i[0]&&(s++,i.shift()),r[a]=t[s];return r},a=function(t){var e,r,n,i,a,o,u,l,c,d,f,h,p,g=0,v=0,b=0,E=0,T=1;if(r=(e=new y(t)).readUnsignedByte(),i=e.readUnsignedByte(),n=e.readUnsignedByte(),e.skipUnsignedExpGolomb(),m[r]&&(3===(a=e.readUnsignedExpGolomb())&&e.skipBits(1),e.skipUnsignedExpGolomb(),e.skipUnsignedExpGolomb(),e.skipBits(1),e.readBoolean()))for(f=3!==a?8:12,p=0;p<f;p++)e.readBoolean()&&s(p<6?16:64,e);if(e.skipUnsignedExpGolomb(),0===(o=e.readUnsignedExpGolomb()))e.readUnsignedExpGolomb();else if(1===o)for(e.skipBits(1),e.skipExpGolomb(),e.skipExpGolomb(),u=e.readUnsignedExpGolomb(),p=0;p<u;p++)e.skipExpGolomb();if(e.skipUnsignedExpGolomb(),e.skipBits(1),l=e.readUnsignedExpGolomb(),c=e.readUnsignedExpGolomb(),0===(d=e.readBits(1))&&e.skipBits(1),e.skipBits(1),e.readBoolean()&&(g=e.readUnsignedExpGolomb(),v=e.readUnsignedExpGolomb(),b=e.readUnsignedExpGolomb(),E=e.readUnsignedExpGolomb()),e.readBoolean()&&e.readBoolean()){switch(e.readUnsignedByte()){case 1:h=[1,1];break;case 2:h=[12,11];break;case 3:h=[10,11];break;case 4:h=[16,11];break;case 5:h=[40,33];break;case 6:h=[24,11];break;case 7:h=[20,11];break;case 8:h=[32,11];break;case 9:h=[80,33];break;case 10:h=[18,11];break;case 11:h=[15,11];break;case 12:h=[64,33];break;case 13:h=[160,99];break;case 14:h=[4,3];break;case 15:h=[3,2];break;case 16:h=[2,1];break;case 255:h=[e.readUnsignedByte()<<8|e.readUnsignedByte(),e.readUnsignedByte()<<8|e.readUnsignedByte()]}h&&(T=h[0]/h[1])}return{profileIdc:r,levelIdc:n,profileCompatibility:i,width:Math.ceil((16*(l+1)-2*g-2*v)*T),height:(2-d)*(c+1)*16-2*b-2*E,sarRatio:h}}}).prototype=new u;var b,E,T,S,w,_,k,A,L,D,R,C,I,x,O,P,M,F,U,N,B,G,j,H,V,K,z,W,Y,q,X,$,Q,J,Z,tt,et={H264Stream:p,NalByteStream:g},rt={Adts:v,h264:et},nt=Math.pow(2,32)-1;(function(){var t;if(j={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!==typeof Uint8Array){for(t in j)j.hasOwnProperty(t)&&(j[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);H=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),K=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),V=new Uint8Array([0,0,0,1]),z=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),W=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Y={video:z,audio:W},$=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),X=new Uint8Array([0,0,0,0,0,0,0,0]),Q=new Uint8Array([0,0,0,0,0,0,0,0]),J=Q,Z=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),tt=Q,q=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),b=function(t){var e,r,n=[],i=0;for(e=1;e<arguments.length;e++)n.push(arguments[e]);for(e=n.length;e--;)i+=n[e].byteLength;for(r=new Uint8Array(i+8),new DataView(r.buffer,r.byteOffset,r.byteLength).setUint32(0,r.byteLength),r.set(t,4),e=0,i=8;e<n.length;e++)r.set(n[e],i),i+=n[e].byteLength;return r},E=function(){return b(j.dinf,b(j.dref,$))},T=function(t){return b(j.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},S=function(){return b(j.ftyp,H,V,H,K)},P=function(t){return b(j.hdlr,Y[t])},w=function(t){return b(j.mdat,t)},O=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.samplerate&&(e[12]=t.samplerate>>>24&255,e[13]=t.samplerate>>>16&255,e[14]=t.samplerate>>>8&255,e[15]=255&t.samplerate),b(j.mdhd,e)},x=function(t){return b(j.mdia,O(t),P(t.type),k(t))},_=function(t){return b(j.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},k=function(t){return b(j.minf,"video"===t.type?b(j.vmhd,q):b(j.smhd,X),E(),F(t))},A=function(t,e){for(var r=[],n=e.length;n--;)r[n]=N(e[n]);return b.apply(null,[j.moof,_(t)].concat(r))},L=function(t){for(var e=t.length,r=[];e--;)r[e]=C(t[e]);return b.apply(null,[j.moov,R(4294967295)].concat(r).concat(D(t)))},D=function(t){for(var e=t.length,r=[];e--;)r[e]=B(t[e]);return b.apply(null,[j.mvex].concat(r))},R=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return b(j.mvhd,e)},M=function(t){var e,r,n=t.samples||[],i=new Uint8Array(4+n.length);for(r=0;r<n.length;r++)e=n[r].flags,i[r+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return b(j.sdtp,i)},F=function(t){return b(j.stbl,U(t),b(j.stts,tt),b(j.stsc,J),b(j.stsz,Z),b(j.stco,Q))},function(){var t,e;U=function(r){return b(j.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===r.type?t(r):e(r))},t=function(t){var e,r,n=t.sps||[],i=t.pps||[],a=[],s=[];for(e=0;e<n.length;e++)a.push((65280&n[e].byteLength)>>>8),a.push(255&n[e].byteLength),a=a.concat(Array.prototype.slice.call(n[e]));for(e=0;e<i.length;e++)s.push((65280&i[e].byteLength)>>>8),s.push(255&i[e].byteLength),s=s.concat(Array.prototype.slice.call(i[e]));if(r=[j.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),b(j.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([n.length],a,[i.length],s))),b(j.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],t.sarRatio){var o=t.sarRatio[0],u=t.sarRatio[1];r.push(b(j.pasp,new Uint8Array([(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o,(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u])))}return b.apply(null,r)},e=function(t){return b(j.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),T(t))}}(),I=function(t){var e=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return b(j.tkhd,e)},N=function(t){var e,r,n,i,a,s,o;return e=b(j.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),s=Math.floor(t.baseMediaDecodeTime/(nt+1)),o=Math.floor(t.baseMediaDecodeTime%(nt+1)),r=b(j.tfdt,new Uint8Array([1,0,0,0,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),a=92,"audio"===t.type?(n=G(t,a),b(j.traf,e,r,n)):(i=M(t),n=G(t,i.length+a),b(j.traf,e,r,n,i))},C=function(t){return t.duration=t.duration||4294967295,b(j.trak,I(t),x(t))},B=function(t){var e=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==t.type&&(e[e.length-1]=0),b(j.trex,e)},function(){var t,e,r;r=function(t,e){var r=0,n=0,i=0,a=0;return t.length&&(void 0!==t[0].duration&&(r=1),void 0!==t[0].size&&(n=2),void 0!==t[0].flags&&(i=4),void 0!==t[0].compositionTimeOffset&&(a=8)),[0,0,r|n|i|a,1,(4278190080&t.length)>>>24,(16711680&t.length)>>>16,(65280&t.length)>>>8,255&t.length,(4278190080&e)>>>24,(16711680&e)>>>16,(65280&e)>>>8,255&e]},e=function(t,e){var n,i,a,s,o,u;for(e+=20+16*(s=t.samples||[]).length,a=r(s,e),(i=new Uint8Array(a.length+16*s.length)).set(a),n=a.length,u=0;u<s.length;u++)o=s[u],i[n++]=(4278190080&o.duration)>>>24,i[n++]=(16711680&o.duration)>>>16,i[n++]=(65280&o.duration)>>>8,i[n++]=255&o.duration,i[n++]=(4278190080&o.size)>>>24,i[n++]=(16711680&o.size)>>>16,i[n++]=(65280&o.size)>>>8,i[n++]=255&o.size,i[n++]=o.flags.isLeading<<2|o.flags.dependsOn,i[n++]=o.flags.isDependedOn<<6|o.flags.hasRedundancy<<4|o.flags.paddingValue<<1|o.flags.isNonSyncSample,i[n++]=61440&o.flags.degradationPriority,i[n++]=15&o.flags.degradationPriority,i[n++]=(4278190080&o.compositionTimeOffset)>>>24,i[n++]=(16711680&o.compositionTimeOffset)>>>16,i[n++]=(65280&o.compositionTimeOffset)>>>8,i[n++]=255&o.compositionTimeOffset;return b(j.trun,i)},t=function(t,e){var n,i,a,s,o,u;for(e+=20+8*(s=t.samples||[]).length,a=r(s,e),(n=new Uint8Array(a.length+8*s.length)).set(a),i=a.length,u=0;u<s.length;u++)o=s[u],n[i++]=(4278190080&o.duration)>>>24,n[i++]=(16711680&o.duration)>>>16,n[i++]=(65280&o.duration)>>>8,n[i++]=255&o.duration,n[i++]=(4278190080&o.size)>>>24,n[i++]=(16711680&o.size)>>>16,n[i++]=(65280&o.size)>>>8,n[i++]=255&o.size;return b(j.trun,n)},G=function(r,n){return"audio"===r.type?t(r,n):e(r,n)}}();var it,at,st,ot,ut,lt,ct={ftyp:S,mdat:w,moof:A,moov:L,initSegment:function(t){var e,r=S(),n=L(t);return(e=new Uint8Array(r.byteLength+n.byteLength)).set(r),e.set(n,r.byteLength),e}},dt={toUnsigned:function(t){return t>>>0},toHexString:function(t){return("00"+t.toString(16)).slice(-2)}},ft=function(t){var e="";return e+=String.fromCharCode(t[0]),e+=String.fromCharCode(t[1]),e+=String.fromCharCode(t[2]),e+=String.fromCharCode(t[3])},ht=dt.toUnsigned,pt=function t(e,r){var n,i,a,s,o,u=[];if(!r.length)return null;for(n=0;n<e.byteLength;)i=ht(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),a=ft(e.subarray(n+4,n+8)),s=i>1?n+i:e.byteLength,a===r[0]&&(1===r.length?u.push(e.subarray(n+8,s)):(o=t(e.subarray(n+8,s),r.slice(1))).length&&(u=u.concat(o))),n=s;return u},gt=function(t){var e,r=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:r.getUint32(4)},i=1&n.flags[2],a=2&n.flags[2],s=8&n.flags[2],o=16&n.flags[2],u=32&n.flags[2],l=65536&n.flags[0],c=131072&n.flags[0];return e=8,i&&(e+=4,n.baseDataOffset=r.getUint32(12),e+=4),a&&(n.sampleDescriptionIndex=r.getUint32(e),e+=4),s&&(n.defaultSampleDuration=r.getUint32(e),e+=4),o&&(n.defaultSampleSize=r.getUint32(e),e+=4),u&&(n.defaultSampleFlags=r.getUint32(e)),l&&(n.durationIsEmpty=!0),!i&&c&&(n.baseDataOffsetIsMoof=!0),n},mt=function(t){return{isLeading:(12&t[0])>>>2,dependsOn:3&t[0],isDependedOn:(192&t[1])>>>6,hasRedundancy:(48&t[1])>>>4,paddingValue:(14&t[1])>>>1,isNonSyncSample:1&t[1],degradationPriority:t[2]<<8|t[3]}},vt=function(t){var e,r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},n=new DataView(t.buffer,t.byteOffset,t.byteLength),i=1&r.flags[2],a=4&r.flags[2],s=1&r.flags[1],o=2&r.flags[1],u=4&r.flags[1],l=8&r.flags[1],c=n.getUint32(4),d=8;for(i&&(r.dataOffset=n.getInt32(d),d+=4),a&&c&&(e={flags:mt(t.subarray(d,d+4))},d+=4,s&&(e.duration=n.getUint32(d),d+=4),o&&(e.size=n.getUint32(d),d+=4),l&&(1===r.version?e.compositionTimeOffset=n.getInt32(d):e.compositionTimeOffset=n.getUint32(d),d+=4),r.samples.push(e),c--);c--;)e={},s&&(e.duration=n.getUint32(d),d+=4),o&&(e.size=n.getUint32(d),d+=4),u&&(e.flags=mt(t.subarray(d,d+4)),d+=4),l&&(1===r.version?e.compositionTimeOffset=n.getInt32(d):e.compositionTimeOffset=n.getUint32(d),d+=4),r.samples.push(e);return r},yt=dt.toUnsigned,bt=function(t){var e={version:t[0],flags:new Uint8Array(t.subarray(1,4)),baseMediaDecodeTime:yt(t[4]<<24|t[5]<<16|t[6]<<8|t[7])};return 1===e.version&&(e.baseMediaDecodeTime*=Math.pow(2,32),e.baseMediaDecodeTime+=yt(t[8]<<24|t[9]<<16|t[10]<<8|t[11])),e},Et=dt.toUnsigned,Tt=dt.toHexString;it=function(t){var e={};return pt(t,["moov","trak"]).reduce((function(t,e){var r,n,i,a,s;return(r=pt(e,["tkhd"])[0])?(n=r[0],a=Et(r[i=0===n?12:20]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3]),(s=pt(e,["mdia","mdhd"])[0])?(i=0===(n=s[0])?12:20,t[a]=Et(s[i]<<24|s[i+1]<<16|s[i+2]<<8|s[i+3]),t):null):null}),e)},at=function(t,e){var r,n,i;return r=pt(e,["moof","traf"]),n=[].concat.apply([],r.map((function(e){return pt(e,["tfhd"]).map((function(r){var n,i,a;return n=Et(r[4]<<24|r[5]<<16|r[6]<<8|r[7]),i=t[n]||9e4,(a="number"!==typeof(a=pt(e,["tfdt"]).map((function(t){var e,r;return e=t[0],r=Et(t[4]<<24|t[5]<<16|t[6]<<8|t[7]),1===e&&(r*=Math.pow(2,32),r+=Et(t[8]<<24|t[9]<<16|t[10]<<8|t[11])),r}))[0])||isNaN(a)?1/0:a)/i}))}))),i=Math.min.apply(null,n),isFinite(i)?i:0},st=function(t,e){var r,n=pt(e,["moof","traf"]),i=0,a=0;if(n&&n.length){var s=pt(n[0],["tfhd"])[0],o=pt(n[0],["trun"])[0],u=pt(n[0],["tfdt"])[0];if(s&&(r=gt(s).trackId),u&&(i=bt(u).baseMediaDecodeTime),o){var l=vt(o);l.samples&&l.samples.length&&(a=l.samples[0].compositionTimeOffset||0)}}return(i+a)/(t[r]||9e4)},ot=function(t){var e=pt(t,["moov","trak"]),r=[];return e.forEach((function(t){var e=pt(t,["mdia","hdlr"]),n=pt(t,["tkhd"]);e.forEach((function(t,e){var i,a,s=ft(t.subarray(8,12)),o=n[e];"vide"===s&&(a=0===(i=new DataView(o.buffer,o.byteOffset,o.byteLength)).getUint8(0)?i.getUint32(12):i.getUint32(20),r.push(a))}))})),r},ut=function(t){var e=pt(t,["moov","trak"]),r=[];return e.forEach((function(t){var e,n,i={},a=pt(t,["tkhd"])[0];a&&(n=(e=new DataView(a.buffer,a.byteOffset,a.byteLength)).getUint8(0),i.id=0===n?e.getUint32(12):e.getUint32(20));var s=pt(t,["mdia","hdlr"])[0];if(s){var o=ft(s.subarray(8,12));i.type="vide"===o?"video":"soun"===o?"audio":o}var u=pt(t,["mdia","minf","stbl","stsd"])[0];if(u){var l=u.subarray(8);i.codec=ft(l.subarray(4,8));var c,d=pt(l,[i.codec])[0];d&&(/^[a-z]vc[1-9]$/i.test(i.codec)?(c=d.subarray(78),"avcC"===ft(c.subarray(4,8))&&c.length>11?(i.codec+=".",i.codec+=Tt(c[9]),i.codec+=Tt(c[10]),i.codec+=Tt(c[11])):i.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(i.codec)?(c=d.subarray(28),"esds"===ft(c.subarray(4,8))&&c.length>20&&0!==c[19]?(i.codec+="."+Tt(c[19]),i.codec+="."+Tt(c[20]>>>2&63).replace(/^0/,"")):i.codec="mp4a.40.2"):i.codec=i.codec.toLowerCase())}var f=pt(t,["mdia","mdhd"])[0];f&&(i.timescale=lt(f)),r.push(i)})),r};var St,wt={findBox:pt,parseType:ft,timescale:it,startTime:at,compositionStartTime:st,videoTrackIds:ot,tracks:ut,getTimescaleFromMediaHeader:lt=function(t){var e=0===t[0]?12:20;return Et(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])}},_t=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},kt=function(t,e){var r=_t();return r.dataOffset=e,r.compositionTimeOffset=t.pts-t.dts,r.duration=t.duration,r.size=4*t.length,r.size+=t.byteLength,t.keyFrame&&(r.flags.dependsOn=2,r.flags.isNonSyncSample=0),r},At={groupNalsIntoFrames:function(t){var e,r,n=[],i=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,n.byteLength=0,e=0;e<t.length;e++)"access_unit_delimiter_rbsp"===(r=t[e]).nalUnitType?(n.length&&(n.duration=r.dts-n.dts,i.byteLength+=n.byteLength,i.nalCount+=n.length,i.duration+=n.duration,i.push(n)),(n=[r]).byteLength=r.data.byteLength,n.pts=r.pts,n.dts=r.dts):("slice_layer_without_partitioning_rbsp_idr"===r.nalUnitType&&(n.keyFrame=!0),n.duration=r.dts-n.dts,n.byteLength+=r.data.byteLength,n.push(r));return i.length&&(!n.duration||n.duration<=0)&&(n.duration=i[i.length-1].duration),i.byteLength+=n.byteLength,i.nalCount+=n.length,i.duration+=n.duration,i.push(n),i},groupFramesIntoGops:function(t){var e,r,n=[],i=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=t[0].pts,n.dts=t[0].dts,i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=t[0].pts,i.dts=t[0].dts,e=0;e<t.length;e++)(r=t[e]).keyFrame?(n.length&&(i.push(n),i.byteLength+=n.byteLength,i.nalCount+=n.nalCount,i.duration+=n.duration),(n=[r]).nalCount=r.length,n.byteLength=r.byteLength,n.pts=r.pts,n.dts=r.dts,n.duration=r.duration):(n.duration+=r.duration,n.nalCount+=r.length,n.byteLength+=r.byteLength,n.push(r));return i.length&&n.duration<=0&&(n.duration=i[i.length-1].duration),i.byteLength+=n.byteLength,i.nalCount+=n.nalCount,i.duration+=n.duration,i.push(n),i},extendFirstKeyFrame:function(t){var e;return!t[0][0].keyFrame&&t.length>1&&(e=t.shift(),t.byteLength-=e.byteLength,t.nalCount-=e.nalCount,t[0][0].dts=e.dts,t[0][0].pts=e.pts,t[0][0].duration+=e.duration),t},generateSampleTable:function(t,e){var r,n,i,a,s,o=e||0,u=[];for(r=0;r<t.length;r++)for(a=t[r],n=0;n<a.length;n++)s=a[n],o+=(i=kt(s,o)).size,u.push(i);return u},concatenateNalData:function(t){var e,r,n,i,a,s,o=0,u=t.byteLength,l=t.nalCount,c=new Uint8Array(u+4*l),d=new DataView(c.buffer);for(e=0;e<t.length;e++)for(i=t[e],r=0;r<i.length;r++)for(a=i[r],n=0;n<a.length;n++)s=a[n],d.setUint32(o,s.data.byteLength),o+=4,c.set(s.data,o),o+=s.data.byteLength;return c},generateSampleTableForFrame:function(t,e){var r,n=[];return r=kt(t,e||0),n.push(r),n},concatenateNalDataForFrame:function(t){var e,r,n=0,i=t.byteLength,a=t.length,s=new Uint8Array(i+4*a),o=new DataView(s.buffer);for(e=0;e<t.length;e++)r=t[e],o.setUint32(n,r.data.byteLength),n+=4,s.set(r.data,n),n+=r.data.byteLength;return s}},Lt=[33,16,5,32,164,27],Dt=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Rt=function(t){for(var e=[];t--;)e.push(0);return e},Ct=function(t){return Object.keys(t).reduce((function(e,r){return e[r]=new Uint8Array(t[r].reduce((function(t,e){return t.concat(e)}),[])),e}),{})},It=function(){if(!St){var t={96e3:[Lt,[227,64],Rt(154),[56]],88200:[Lt,[231],Rt(170),[56]],64e3:[Lt,[248,192],Rt(240),[56]],48e3:[Lt,[255,192],Rt(268),[55,148,128],Rt(54),[112]],44100:[Lt,[255,192],Rt(268),[55,163,128],Rt(84),[112]],32e3:[Lt,[255,192],Rt(268),[55,234],Rt(226),[112]],24e3:[Lt,[255,192],Rt(268),[55,255,128],Rt(268),[111,112],Rt(126),[224]],16e3:[Lt,[255,192],Rt(268),[55,255,128],Rt(268),[111,255],Rt(269),[223,108],Rt(195),[1,192]],12e3:[Dt,Rt(268),[3,127,248],Rt(268),[6,255,240],Rt(268),[13,255,224],Rt(268),[27,253,128],Rt(259),[56]],11025:[Dt,Rt(268),[3,127,248],Rt(268),[6,255,240],Rt(268),[13,255,224],Rt(268),[27,255,192],Rt(268),[55,175,128],Rt(108),[112]],8e3:[Dt,Rt(268),[3,121,16],Rt(47),[7]]};St=Ct(t)}return St},xt=function(t){var e,r=0;for(e=0;e<t.length;e++)r+=t[e].data.byteLength;return r},Ot={prefixWithSilence:function(t,e,r,n){var i,a,s,o,u=0,l=0,c=0,f=0;if(e.length&&(i=d.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate),u=Math.ceil(d.ONE_SECOND_IN_TS/(t.samplerate/1024)),r&&n&&(l=i-Math.max(r,n),f=(c=Math.floor(l/u))*u),!(c<1||f>d.ONE_SECOND_IN_TS/2))){for((a=It()[t.samplerate])||(a=e[0].data),s=0;s<c;s++)o=e[0],e.splice(0,0,{data:a,dts:o.dts-u,pts:o.pts-u});return t.baseMediaDecodeTime-=Math.floor(d.videoTsToAudioTs(f,t.samplerate)),f}},trimAdtsFramesByEarliestDts:function(t,e,r){return e.minSegmentDts>=r?t:(e.minSegmentDts=1/0,t.filter((function(t){return t.dts>=r&&(e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),e.minSegmentPts=e.minSegmentDts,!0)})))},generateSampleTable:function(t){var e,r,n=[];for(e=0;e<t.length;e++)r=t[e],n.push({size:r.data.byteLength,duration:1024});return n},concatenateFrameData:function(t){var e,r,n=0,i=new Uint8Array(xt(t));for(e=0;e<t.length;e++)r=t[e],i.set(r.data,n),n+=r.data.byteLength;return i}},Pt=d.ONE_SECOND_IN_TS,Mt={clearDtsInfo:function(t){delete t.minSegmentDts,delete t.maxSegmentDts,delete t.minSegmentPts,delete t.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(t,e){var r,n=t.minSegmentDts;return e||(n-=t.timelineStartInfo.dts),r=t.timelineStartInfo.baseMediaDecodeTime,r+=n,r=Math.max(0,r),"audio"===t.type&&(r*=t.samplerate/Pt,r=Math.floor(r)),r},collectDtsInfo:function(t,e){"number"===typeof e.pts&&(void 0===t.timelineStartInfo.pts&&(t.timelineStartInfo.pts=e.pts),void 0===t.minSegmentPts?t.minSegmentPts=e.pts:t.minSegmentPts=Math.min(t.minSegmentPts,e.pts),void 0===t.maxSegmentPts?t.maxSegmentPts=e.pts:t.maxSegmentPts=Math.max(t.maxSegmentPts,e.pts)),"number"===typeof e.dts&&(void 0===t.timelineStartInfo.dts&&(t.timelineStartInfo.dts=e.dts),void 0===t.minSegmentDts?t.minSegmentDts=e.dts:t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),void 0===t.maxSegmentDts?t.maxSegmentDts=e.dts:t.maxSegmentDts=Math.max(t.maxSegmentDts,e.dts))}},Ft=4,Ut=128,Nt={parseSei:function(t){for(var e=0,r={payloadType:-1,payloadSize:0},n=0,i=0;e<t.byteLength&&t[e]!==Ut;){for(;255===t[e];)n+=255,e++;for(n+=t[e++];255===t[e];)i+=255,e++;if(i+=t[e++],!r.payload&&n===Ft){if("GA94"===String.fromCharCode(t[e+3],t[e+4],t[e+5],t[e+6])){r.payloadType=n,r.payloadSize=i,r.payload=t.subarray(e,e+i);break}r.payload=void 0}e+=i,n=0,i=0}return r},parseUserData:function(t){return 181!==t.payload[0]||49!==(t.payload[1]<<8|t.payload[2])||"GA94"!==String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])||3!==t.payload[7]?null:t.payload.subarray(8,t.payload.length-1)},parseCaptionPackets:function(t,e){var r,n,i,a,s=[];if(!(64&e[0]))return s;for(n=31&e[0],r=0;r<n;r++)a={type:3&e[2+(i=3*r)],pts:t},4&e[i+2]&&(a.ccData=e[i+3]<<8|e[i+4],s.push(a));return s},discardEmulationPreventionBytes:function(t){for(var e,r,n=t.byteLength,i=[],a=1;a<n-2;)0===t[a]&&0===t[a+1]&&3===t[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return t;e=n-i.length,r=new Uint8Array(e);var s=0;for(a=0;a<e;s++,a++)s===i[0]&&(s++,i.shift()),r[a]=t[s];return r},USER_DATA_REGISTERED_ITU_T_T35:Ft},Bt=function t(e){e=e||{},t.prototype.init.call(this),this.parse708captions_="boolean"!==typeof e.parse708captions||e.parse708captions,this.captionPackets_=[],this.ccStreams_=[new Qt(0,0),new Qt(0,1),new Qt(1,0),new Qt(1,1)],this.parse708captions_&&(this.cc708Stream_=new zt),this.reset(),this.ccStreams_.forEach((function(t){t.on("data",this.trigger.bind(this,"data")),t.on("partialdone",this.trigger.bind(this,"partialdone")),t.on("done",this.trigger.bind(this,"done"))}),this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};Bt.prototype=new u,Bt.prototype.push=function(t){var e,r,n;if("sei_rbsp"===t.nalUnitType&&(e=Nt.parseSei(t.escapedRBSP)).payload&&e.payloadType===Nt.USER_DATA_REGISTERED_ITU_T_T35&&(r=Nt.parseUserData(e)))if(t.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(t.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));n=Nt.parseCaptionPackets(t.pts,r),this.captionPackets_=this.captionPackets_.concat(n),this.latestDts_!==t.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=t.dts}},Bt.prototype.flushCCStreams=function(t){this.ccStreams_.forEach((function(e){return"flush"===t?e.flush():e.partialFlush()}),this)},Bt.prototype.flushStream=function(t){this.captionPackets_.length?(this.captionPackets_.forEach((function(t,e){t.presortIndex=e})),this.captionPackets_.sort((function(t,e){return t.pts===e.pts?t.presortIndex-e.presortIndex:t.pts-e.pts})),this.captionPackets_.forEach((function(t){t.type<2?this.dispatchCea608Packet(t):this.dispatchCea708Packet(t)}),this),this.captionPackets_.length=0,this.flushCCStreams(t)):this.flushCCStreams(t)},Bt.prototype.flush=function(){return this.flushStream("flush")},Bt.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Bt.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(t){t.reset()}))},Bt.prototype.dispatchCea608Packet=function(t){this.setsTextOrXDSActive(t)?this.activeCea608Channel_[t.type]=null:this.setsChannel1Active(t)?this.activeCea608Channel_[t.type]=0:this.setsChannel2Active(t)&&(this.activeCea608Channel_[t.type]=1),null!==this.activeCea608Channel_[t.type]&&this.ccStreams_[(t.type<<1)+this.activeCea608Channel_[t.type]].push(t)},Bt.prototype.setsChannel1Active=function(t){return 4096===(30720&t.ccData)},Bt.prototype.setsChannel2Active=function(t){return 6144===(30720&t.ccData)},Bt.prototype.setsTextOrXDSActive=function(t){return 256===(28928&t.ccData)||4138===(30974&t.ccData)||6186===(30974&t.ccData)},Bt.prototype.dispatchCea708Packet=function(t){this.parse708captions_&&this.cc708Stream_.push(t)};var Gt={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},jt=function(t){var e=Gt[t]||t;return 4096&t&&t===e?"":String.fromCharCode(e)},Ht=function(t){return 32<=t&&t<=127||160<=t&&t<=255},Vt=function(t){this.windowNum=t,this.reset()};Vt.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Vt.prototype.getText=function(){return this.rows.join("\n")},Vt.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Vt.prototype.newLine=function(t){for(this.rows.length>=this.virtualRowCount&&"function"===typeof this.beforeRowOverflow&&this.beforeRowOverflow(t),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Vt.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},Vt.prototype.addText=function(t){this.rows[this.rowIdx]+=t},Vt.prototype.backspace=function(){if(!this.isEmpty()){var t=this.rows[this.rowIdx];this.rows[this.rowIdx]=t.substr(0,t.length-1)}};var Kt=function(t){this.serviceNum=t,this.text="",this.currentWindow=new Vt(-1),this.windows=[]};Kt.prototype.init=function(t,e){this.startPts=t;for(var r=0;r<8;r++)this.windows[r]=new Vt(r),"function"===typeof e&&(this.windows[r].beforeRowOverflow=e)},Kt.prototype.setCurrentWindow=function(t){this.currentWindow=this.windows[t]};var zt=function t(){t.prototype.init.call(this);var e=this;this.current708Packet=null,this.services={},this.push=function(t){3===t.type?(e.new708Packet(),e.add708Bytes(t)):(null===e.current708Packet&&e.new708Packet(),e.add708Bytes(t))}};zt.prototype=new u,zt.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},zt.prototype.add708Bytes=function(t){var e=t.ccData,r=e>>>8,n=255&e;this.current708Packet.ptsVals.push(t.pts),this.current708Packet.data.push(r),this.current708Packet.data.push(n)},zt.prototype.push708Packet=function(){var t=this.current708Packet,e=t.data,r=null,n=null,i=0,a=e[i++];for(t.seq=a>>6,t.sizeCode=63&a;i<e.length;i++)n=31&(a=e[i++]),7===(r=a>>5)&&n>0&&(r=a=e[i++]),this.pushServiceBlock(r,i,n),n>0&&(i+=n-1)},zt.prototype.pushServiceBlock=function(t,e,r){var n,i=e,a=this.current708Packet.data,s=this.services[t];for(s||(s=this.initService(t,i));i<e+r&&i<a.length;i++)n=a[i],Ht(n)?i=this.handleText(i,s):16===n?i=this.extendedCommands(i,s):128<=n&&n<=135?i=this.setCurrentWindow(i,s):152<=n&&n<=159?i=this.defineWindow(i,s):136===n?i=this.clearWindows(i,s):140===n?i=this.deleteWindows(i,s):137===n?i=this.displayWindows(i,s):138===n?i=this.hideWindows(i,s):139===n?i=this.toggleWindows(i,s):151===n?i=this.setWindowAttributes(i,s):144===n?i=this.setPenAttributes(i,s):145===n?i=this.setPenColor(i,s):146===n?i=this.setPenLocation(i,s):143===n?s=this.reset(i,s):8===n?s.currentWindow.backspace():12===n?s.currentWindow.clearText():13===n?s.currentWindow.pendingNewLine=!0:14===n?s.currentWindow.clearText():141===n&&i++},zt.prototype.extendedCommands=function(t,e){var r=this.current708Packet.data[++t];return Ht(r)&&(t=this.handleText(t,e,!0)),t},zt.prototype.getPts=function(t){return this.current708Packet.ptsVals[Math.floor(t/2)]},zt.prototype.initService=function(t,e){var r=this;return this.services[t]=new Kt(t),this.services[t].init(this.getPts(e),(function(e){r.flushDisplayed(e,r.services[t])})),this.services[t]},zt.prototype.handleText=function(t,e,r){var n=this.current708Packet.data[t],i=jt((r?4096:0)|n),a=e.currentWindow;return a.pendingNewLine&&!a.isEmpty()&&a.newLine(this.getPts(t)),a.pendingNewLine=!1,a.addText(i),t},zt.prototype.setCurrentWindow=function(t,e){var r=7&this.current708Packet.data[t];return e.setCurrentWindow(r),t},zt.prototype.defineWindow=function(t,e){var r=this.current708Packet.data,n=r[t],i=7&n;e.setCurrentWindow(i);var a=e.currentWindow;return n=r[++t],a.visible=(32&n)>>5,a.rowLock=(16&n)>>4,a.columnLock=(8&n)>>3,a.priority=7&n,n=r[++t],a.relativePositioning=(128&n)>>7,a.anchorVertical=127&n,n=r[++t],a.anchorHorizontal=n,n=r[++t],a.anchorPoint=(240&n)>>4,a.rowCount=15&n,n=r[++t],a.columnCount=63&n,n=r[++t],a.windowStyle=(56&n)>>3,a.penStyle=7&n,a.virtualRowCount=a.rowCount+1,t},zt.prototype.setWindowAttributes=function(t,e){var r=this.current708Packet.data,n=r[t],i=e.currentWindow.winAttr;return n=r[++t],i.fillOpacity=(192&n)>>6,i.fillRed=(48&n)>>4,i.fillGreen=(12&n)>>2,i.fillBlue=3&n,n=r[++t],i.borderType=(192&n)>>6,i.borderRed=(48&n)>>4,i.borderGreen=(12&n)>>2,i.borderBlue=3&n,n=r[++t],i.borderType+=(128&n)>>5,i.wordWrap=(64&n)>>6,i.printDirection=(48&n)>>4,i.scrollDirection=(12&n)>>2,i.justify=3&n,n=r[++t],i.effectSpeed=(240&n)>>4,i.effectDirection=(12&n)>>2,i.displayEffect=3&n,t},zt.prototype.flushDisplayed=function(t,e){for(var r=[],n=0;n<8;n++)e.windows[n].visible&&!e.windows[n].isEmpty()&&r.push(e.windows[n].getText());e.endPts=t,e.text=r.join("\n\n"),this.pushCaption(e),e.startPts=t},zt.prototype.pushCaption=function(t){""!==t.text&&(this.trigger("data",{startPts:t.startPts,endPts:t.endPts,text:t.text,stream:"cc708_"+t.serviceNum}),t.text="",t.startPts=t.endPts)},zt.prototype.displayWindows=function(t,e){var r=this.current708Packet.data[++t],n=this.getPts(t);this.flushDisplayed(n,e);for(var i=0;i<8;i++)r&1<<i&&(e.windows[i].visible=1);return t},zt.prototype.hideWindows=function(t,e){var r=this.current708Packet.data[++t],n=this.getPts(t);this.flushDisplayed(n,e);for(var i=0;i<8;i++)r&1<<i&&(e.windows[i].visible=0);return t},zt.prototype.toggleWindows=function(t,e){var r=this.current708Packet.data[++t],n=this.getPts(t);this.flushDisplayed(n,e);for(var i=0;i<8;i++)r&1<<i&&(e.windows[i].visible^=1);return t},zt.prototype.clearWindows=function(t,e){var r=this.current708Packet.data[++t],n=this.getPts(t);this.flushDisplayed(n,e);for(var i=0;i<8;i++)r&1<<i&&e.windows[i].clearText();return t},zt.prototype.deleteWindows=function(t,e){var r=this.current708Packet.data[++t],n=this.getPts(t);this.flushDisplayed(n,e);for(var i=0;i<8;i++)r&1<<i&&e.windows[i].reset();return t},zt.prototype.setPenAttributes=function(t,e){var r=this.current708Packet.data,n=r[t],i=e.currentWindow.penAttr;return n=r[++t],i.textTag=(240&n)>>4,i.offset=(12&n)>>2,i.penSize=3&n,n=r[++t],i.italics=(128&n)>>7,i.underline=(64&n)>>6,i.edgeType=(56&n)>>3,i.fontStyle=7&n,t},zt.prototype.setPenColor=function(t,e){var r=this.current708Packet.data,n=r[t],i=e.currentWindow.penColor;return n=r[++t],i.fgOpacity=(192&n)>>6,i.fgRed=(48&n)>>4,i.fgGreen=(12&n)>>2,i.fgBlue=3&n,n=r[++t],i.bgOpacity=(192&n)>>6,i.bgRed=(48&n)>>4,i.bgGreen=(12&n)>>2,i.bgBlue=3&n,n=r[++t],i.edgeRed=(48&n)>>4,i.edgeGreen=(12&n)>>2,i.edgeBlue=3&n,t},zt.prototype.setPenLocation=function(t,e){var r=this.current708Packet.data,n=r[t],i=e.currentWindow.penLoc;return e.currentWindow.pendingNewLine=!0,n=r[++t],i.row=15&n,n=r[++t],i.column=63&n,t},zt.prototype.reset=function(t,e){var r=this.getPts(t);return this.flushDisplayed(r,e),this.initService(e.serviceNum,t)};var Wt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Yt=function(t){return null===t?"":(t=Wt[t]||t,String.fromCharCode(t))},qt=14,Xt=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],$t=function(){for(var t=[],e=qt+1;e--;)t.push("");return t},Qt=function t(e,r){t.prototype.init.call(this),this.field_=e||0,this.dataChannel_=r||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(t){var e,r,n,i,a;if((e=32639&t.ccData)!==this.lastControlCode_){if(4096===(61440&e)?this.lastControlCode_=e:e!==this.PADDING_&&(this.lastControlCode_=null),n=e>>>8,i=255&e,e!==this.PADDING_)if(e===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(e===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(t.pts),this.flushDisplayed(t.pts),r=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=r,this.startPts_=t.pts;else if(e===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(t.pts);else if(e===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(t.pts);else if(e===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(t.pts);else if(e===this.CARRIAGE_RETURN_)this.clearFormatting(t.pts),this.flushDisplayed(t.pts),this.shiftRowsUp_(),this.startPts_=t.pts;else if(e===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(e===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(t.pts),this.displayed_=$t();else if(e===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=$t();else if(e===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(t.pts),this.displayed_=$t()),this.mode_="paintOn",this.startPts_=t.pts;else if(this.isSpecialCharacter(n,i))a=Yt((n=(3&n)<<8)|i),this[this.mode_](t.pts,a),this.column_++;else if(this.isExtCharacter(n,i))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Yt((n=(3&n)<<8)|i),this[this.mode_](t.pts,a),this.column_++;else if(this.isMidRowCode(n,i))this.clearFormatting(t.pts),this[this.mode_](t.pts," "),this.column_++,14===(14&i)&&this.addFormatting(t.pts,["i"]),1===(1&i)&&this.addFormatting(t.pts,["u"]);else if(this.isOffsetControlCode(n,i))this.column_+=3&i;else if(this.isPAC(n,i)){var s=Xt.indexOf(7968&e);"rollUp"===this.mode_&&(s-this.rollUpRows_+1<0&&(s=this.rollUpRows_-1),this.setRollUp(t.pts,s)),s!==this.row_&&(this.clearFormatting(t.pts),this.row_=s),1&i&&-1===this.formatting_.indexOf("u")&&this.addFormatting(t.pts,["u"]),16===(16&e)&&(this.column_=4*((14&e)>>1)),this.isColorPAC(i)&&14===(14&i)&&this.addFormatting(t.pts,["i"])}else this.isNormalChar(n)&&(0===i&&(i=null),a=Yt(n),a+=Yt(i),this[this.mode_](t.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Qt.prototype=new u,Qt.prototype.flushDisplayed=function(t){var e=this.displayed_.map((function(t){try{return t.trim()}catch(e){return console.error("Skipping malformed caption."),""}})).join("\n").replace(/^\n+|\n+$/g,"");e.length&&this.trigger("data",{startPts:this.startPts_,endPts:t,text:e,stream:this.name_})},Qt.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=$t(),this.nonDisplayed_=$t(),this.lastControlCode_=null,this.column_=0,this.row_=qt,this.rollUpRows_=2,this.formatting_=[]},Qt.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Qt.prototype.isSpecialCharacter=function(t,e){return t===this.EXT_&&e>=48&&e<=63},Qt.prototype.isExtCharacter=function(t,e){return(t===this.EXT_+1||t===this.EXT_+2)&&e>=32&&e<=63},Qt.prototype.isMidRowCode=function(t,e){return t===this.EXT_&&e>=32&&e<=47},Qt.prototype.isOffsetControlCode=function(t,e){return t===this.OFFSET_&&e>=33&&e<=35},Qt.prototype.isPAC=function(t,e){return t>=this.BASE_&&t<this.BASE_+8&&e>=64&&e<=127},Qt.prototype.isColorPAC=function(t){return t>=64&&t<=79||t>=96&&t<=127},Qt.prototype.isNormalChar=function(t){return t>=32&&t<=127},Qt.prototype.setRollUp=function(t,e){if("rollUp"!==this.mode_&&(this.row_=qt,this.mode_="rollUp",this.flushDisplayed(t),this.nonDisplayed_=$t(),this.displayed_=$t()),void 0!==e&&e!==this.row_)for(var r=0;r<this.rollUpRows_;r++)this.displayed_[e-r]=this.displayed_[this.row_-r],this.displayed_[this.row_-r]="";void 0===e&&(e=this.row_),this.topRow_=e-this.rollUpRows_+1},Qt.prototype.addFormatting=function(t,e){this.formatting_=this.formatting_.concat(e);var r=e.reduce((function(t,e){return t+"<"+e+">"}),"");this[this.mode_](t,r)},Qt.prototype.clearFormatting=function(t){if(this.formatting_.length){var e=this.formatting_.reverse().reduce((function(t,e){return t+"</"+e+">"}),"");this.formatting_=[],this[this.mode_](t,e)}},Qt.prototype.popOn=function(t,e){var r=this.nonDisplayed_[this.row_];r+=e,this.nonDisplayed_[this.row_]=r},Qt.prototype.rollUp=function(t,e){var r=this.displayed_[this.row_];r+=e,this.displayed_[this.row_]=r},Qt.prototype.shiftRowsUp_=function(){var t;for(t=0;t<this.topRow_;t++)this.displayed_[t]="";for(t=this.row_+1;t<qt+1;t++)this.displayed_[t]="";for(t=this.topRow_;t<this.row_;t++)this.displayed_[t]=this.displayed_[t+1];this.displayed_[this.row_]=""},Qt.prototype.paintOn=function(t,e){var r=this.displayed_[this.row_];r+=e,this.displayed_[this.row_]=r};var Jt={CaptionStream:Bt,Cea608Stream:Qt,Cea708Stream:zt},Zt={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},te=8589934592,ee=4294967296,re="shared",ne=function(t,e){var r=1;for(t>e&&(r=-1);Math.abs(e-t)>ee;)t+=r*te;return t},ie=function t(e){var r,n;t.prototype.init.call(this),this.type_=e||re,this.push=function(t){this.type_!==re&&t.type!==this.type_||(void 0===n&&(n=t.dts),t.dts=ne(t.dts,n),t.pts=ne(t.pts,n),r=t.dts,this.trigger("data",t))},this.flush=function(){n=r,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){n=void 0,r=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};ie.prototype=new u;var ae,se={TimestampRolloverStream:ie,handleRollover:ne},oe=function(t,e,r){var n,i="";for(n=e;n<r;n++)i+="%"+("00"+t[n].toString(16)).slice(-2);return i},ue=function(t,e,r){return decodeURIComponent(oe(t,e,r))},le=function(t,e,r){return unescape(oe(t,e,r))},ce=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},de={TXXX:function(t){var e;if(3===t.data[0]){for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=ue(t.data,1,e),t.value=ue(t.data,e+1,t.data.length).replace(/\0*$/,"");break}t.data=t.value}},WXXX:function(t){var e;if(3===t.data[0])for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=ue(t.data,1,e),t.url=ue(t.data,e+1,t.data.length);break}},PRIV:function(t){var e;for(e=0;e<t.data.length;e++)if(0===t.data[e]){t.owner=le(t.data,0,e);break}t.privateData=t.data.subarray(e+1),t.data=t.privateData}};(ae=function(t){var e,r={debug:!(!t||!t.debug),descriptor:t&&t.descriptor},n=0,i=[],a=0;if(ae.prototype.init.call(this),this.dispatchType=Zt.METADATA_STREAM_TYPE.toString(16),r.descriptor)for(e=0;e<r.descriptor.length;e++)this.dispatchType+=("00"+r.descriptor[e].toString(16)).slice(-2);this.push=function(t){var e,s,o,u,l;if("timed-metadata"===t.type)if(t.dataAlignmentIndicator&&(a=0,i.length=0),0===i.length&&(t.data.length<10||t.data[0]!=="I".charCodeAt(0)||t.data[1]!=="D".charCodeAt(0)||t.data[2]!=="3".charCodeAt(0)))r.debug&&console.log("Skipping unrecognized metadata packet");else if(i.push(t),a+=t.data.byteLength,1===i.length&&(n=ce(t.data.subarray(6,10)),n+=10),!(a<n)){for(e={data:new Uint8Array(n),frames:[],pts:i[0].pts,dts:i[0].dts},l=0;l<n;)e.data.set(i[0].data.subarray(0,n-l),l),l+=i[0].data.byteLength,a-=i[0].data.byteLength,i.shift();s=10,64&e.data[5]&&(s+=4,s+=ce(e.data.subarray(10,14)),n-=ce(e.data.subarray(16,20)));do{if((o=ce(e.data.subarray(s+4,s+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((u={id:String.fromCharCode(e.data[s],e.data[s+1],e.data[s+2],e.data[s+3]),data:e.data.subarray(s+10,s+o+10)}).key=u.id,de[u.id]&&(de[u.id](u),"com.apple.streaming.transportStreamTimestamp"===u.owner)){var c=u.data,d=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;d*=4,d+=3&c[7],u.timeStamp=d,void 0===e.pts&&void 0===e.dts&&(e.pts=u.timeStamp,e.dts=u.timeStamp),this.trigger("timestamp",u)}e.frames.push(u),s+=10,s+=o}while(s<n);this.trigger("data",e)}}}).prototype=new u;var fe,he,pe,ge=ae,me=se.TimestampRolloverStream,ve=188,ye=71;(fe=function(){var t=new Uint8Array(ve),e=0;fe.prototype.init.call(this),this.push=function(r){var n,i=0,a=ve;for(e?((n=new Uint8Array(r.byteLength+e)).set(t.subarray(0,e)),n.set(r,e),e=0):n=r;a<n.byteLength;)n[i]!==ye||n[a]!==ye?(i++,a++):(this.trigger("data",n.subarray(i,a)),i+=ve,a+=ve);i<n.byteLength&&(t.set(n.subarray(i),0),e=n.byteLength-i)},this.flush=function(){e===ve&&t[0]===ye&&(this.trigger("data",t),e=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){e=0,this.trigger("reset")}}).prototype=new u,(he=function(){var t,e,r,n;he.prototype.init.call(this),n=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,t=function(t,n){var i=0;n.payloadUnitStartIndicator&&(i+=t[i]+1),"pat"===n.type?e(t.subarray(i),n):r(t.subarray(i),n)},e=function(t,e){e.section_number=t[7],e.last_section_number=t[8],n.pmtPid=(31&t[10])<<8|t[11],e.pmtPid=n.pmtPid},r=function(t,e){var r,i;if(1&t[5]){for(n.programMapTable={video:null,audio:null,"timed-metadata":{}},r=3+((15&t[1])<<8|t[2])-4,i=12+((15&t[10])<<8|t[11]);i<r;){var a=t[i],s=(31&t[i+1])<<8|t[i+2];a===Zt.H264_STREAM_TYPE&&null===n.programMapTable.video?n.programMapTable.video=s:a===Zt.ADTS_STREAM_TYPE&&null===n.programMapTable.audio?n.programMapTable.audio=s:a===Zt.METADATA_STREAM_TYPE&&(n.programMapTable["timed-metadata"][s]=a),i+=5+((15&t[i+3])<<8|t[i+4])}e.programMapTable=n.programMapTable}},this.push=function(e){var r={},n=4;if(r.payloadUnitStartIndicator=!!(64&e[1]),r.pid=31&e[1],r.pid<<=8,r.pid|=e[2],(48&e[3])>>>4>1&&(n+=e[n]+1),0===r.pid)r.type="pat",t(e.subarray(n),r),this.trigger("data",r);else if(r.pid===this.pmtPid)for(r.type="pmt",t(e.subarray(n),r),this.trigger("data",r);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,n,r]):this.processPes_(e,n,r)},this.processPes_=function(t,e,r){r.pid===this.programMapTable.video?r.streamType=Zt.H264_STREAM_TYPE:r.pid===this.programMapTable.audio?r.streamType=Zt.ADTS_STREAM_TYPE:r.streamType=this.programMapTable["timed-metadata"][r.pid],r.type="pes",r.data=t.subarray(e),this.trigger("data",r)}}).prototype=new u,he.STREAM_TYPES={h264:27,adts:15},(pe=function(){var t,e=this,r={data:[],size:0},n={data:[],size:0},i={data:[],size:0},a=function(t,e){var r,n=t[0]<<16|t[1]<<8|t[2];e.data=new Uint8Array,1===n&&(e.packetLength=6+(t[4]<<8|t[5]),e.dataAlignmentIndicator=0!==(4&t[6]),192&(r=t[7])&&(e.pts=(14&t[9])<<27|(255&t[10])<<20|(254&t[11])<<12|(255&t[12])<<5|(254&t[13])>>>3,e.pts*=4,e.pts+=(6&t[13])>>>1,e.dts=e.pts,64&r&&(e.dts=(14&t[14])<<27|(255&t[15])<<20|(254&t[16])<<12|(255&t[17])<<5|(254&t[18])>>>3,e.dts*=4,e.dts+=(6&t[18])>>>1)),e.data=t.subarray(9+t[8]))},s=function(t,r,n){var i,s=new Uint8Array(t.size),o={type:r},u=0,l=0,c=!1;if(t.data.length&&!(t.size<9)){for(o.trackId=t.data[0].pid,u=0;u<t.data.length;u++)i=t.data[u],s.set(i.data,l),l+=i.data.byteLength;a(s,o),c="video"===r||o.packetLength<=t.size,(n||c)&&(t.size=0,t.data.length=0),c&&e.trigger("data",o)}};pe.prototype.init.call(this),this.push=function(a){({pat:function(){},pes:function(){var t,e;switch(a.streamType){case Zt.H264_STREAM_TYPE:t=r,e="video";break;case Zt.ADTS_STREAM_TYPE:t=n,e="audio";break;case Zt.METADATA_STREAM_TYPE:t=i,e="timed-metadata";break;default:return}a.payloadUnitStartIndicator&&s(t,e,!0),t.data.push(a),t.size+=a.data.byteLength},pmt:function(){var r={type:"metadata",tracks:[]};null!==(t=a.programMapTable).video&&r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.video,codec:"avc",type:"video"}),null!==t.audio&&r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.audio,codec:"adts",type:"audio"}),e.trigger("data",r)}})[a.type]()},this.reset=function(){r.size=0,r.data.length=0,n.size=0,n.data.length=0,this.trigger("reset")},this.flushStreams_=function(){s(r,"video"),s(n,"audio"),s(i,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}}).prototype=new u;var be={PAT_PID:0,MP2T_PACKET_LENGTH:ve,TransportPacketStream:fe,TransportParseStream:he,ElementaryStream:pe,TimestampRolloverStream:me,CaptionStream:Jt.CaptionStream,Cea608Stream:Jt.Cea608Stream,Cea708Stream:Jt.Cea708Stream,MetadataStream:ge};for(var Ee in Zt)Zt.hasOwnProperty(Ee)&&(be[Ee]=Zt[Ee]);var Te,Se=be,we=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],_e=function(t,e){var r=t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9];return r=r>=0?r:0,(16&t[e+5])>>4?r+20:r+10},ke=function t(e,r){return e.length-r<10||e[r]!=="I".charCodeAt(0)||e[r+1]!=="D".charCodeAt(0)||e[r+2]!=="3".charCodeAt(0)?r:t(e,r+=_e(e,r))},Ae=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},Le=function(t,e,r){var n,i="";for(n=e;n<r;n++)i+="%"+("00"+t[n].toString(16)).slice(-2);return i},De=function(t,e,r){return unescape(Le(t,e,r))},Re={isLikelyAacData:function(t){var e=ke(t,0);return t.length>=e+2&&255===(255&t[e])&&240===(240&t[e+1])&&16===(22&t[e+1])},parseId3TagSize:_e,parseAdtsSize:function(t,e){var r=(224&t[e+5])>>5,n=t[e+4]<<3;return 6144&t[e+3]|n|r},parseType:function(t,e){return t[e]==="I".charCodeAt(0)&&t[e+1]==="D".charCodeAt(0)&&t[e+2]==="3".charCodeAt(0)?"timed-metadata":!0&t[e]&&240===(240&t[e+1])?"audio":null},parseSampleRate:function(t){for(var e=0;e+5<t.length;){if(255===t[e]&&240===(246&t[e+1]))return we[(60&t[e+2])>>>2];e++}return null},parseAacTimestamp:function(t){var e,r,n;e=10,64&t[5]&&(e+=4,e+=Ae(t.subarray(10,14)));do{if((r=Ae(t.subarray(e+4,e+8)))<1)return null;if("PRIV"===String.fromCharCode(t[e],t[e+1],t[e+2],t[e+3])){n=t.subarray(e+10,e+r+10);for(var i=0;i<n.byteLength;i++)if(0===n[i]){if("com.apple.streaming.transportStreamTimestamp"===De(n,0,i)){var a=n.subarray(i+1),s=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return s*=4,s+=3&a[7]}break}}e+=10,e+=r}while(e<t.byteLength);return null}};(Te=function(){var t=new Uint8Array,e=0;Te.prototype.init.call(this),this.setTimestamp=function(t){e=t},this.push=function(r){var n,i,a,s,o=0,u=0;for(t.length?(s=t.length,(t=new Uint8Array(r.byteLength+s)).set(t.subarray(0,s)),t.set(r,s)):t=r;t.length-u>=3;)if(t[u]!=="I".charCodeAt(0)||t[u+1]!=="D".charCodeAt(0)||t[u+2]!=="3".charCodeAt(0))if(255!==(255&t[u])||240!==(240&t[u+1]))u++;else{if(t.length-u<7)break;if(u+(o=Re.parseAdtsSize(t,u))>t.length)break;a={type:"audio",data:t.subarray(u,u+o),pts:e,dts:e},this.trigger("data",a),u+=o}else{if(t.length-u<10)break;if(u+(o=Re.parseId3TagSize(t,u))>t.length)break;i={type:"timed-metadata",data:t.subarray(u,u+o)},this.trigger("data",i),u+=o}n=t.length-u,t=n>0?t.subarray(u):new Uint8Array},this.reset=function(){t=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){t=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new u;var Ce,Ie,xe,Oe,Pe=Te,Me=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Fe=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Ue=et.H264Stream,Ne=Re.isLikelyAacData,Be=d.ONE_SECOND_IN_TS,Ge=function(t,e){var r;if(t.length!==e.length)return!1;for(r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0},je=function(t,e,r,n,i,a){return{start:{dts:t,pts:t+(r-e)},end:{dts:t+(n-e),pts:t+(i-r)},prependedContentDuration:a,baseMediaDecodeTime:t}};(Ie=function(t,e){var r=[],n=0,i=0,a=0,s=1/0;e=e||{},Ie.prototype.init.call(this),this.push=function(e){Mt.collectDtsInfo(t,e),t&&Me.forEach((function(r){t[r]=e[r]})),r.push(e)},this.setEarliestDts=function(t){i=t},this.setVideoBaseMediaDecodeTime=function(t){s=t},this.setAudioAppendStart=function(t){a=t},this.flush=function(){var o,u,l,c,f,h,p;0!==r.length?(o=Ot.trimAdtsFramesByEarliestDts(r,t,i),t.baseMediaDecodeTime=Mt.calculateTrackBaseMediaDecodeTime(t,e.keepOriginalTimestamps),p=Ot.prefixWithSilence(t,o,a,s),t.samples=Ot.generateSampleTable(o),l=ct.mdat(Ot.concatenateFrameData(o)),r=[],u=ct.moof(n,[t]),c=new Uint8Array(u.byteLength+l.byteLength),n++,c.set(u),c.set(l,u.byteLength),Mt.clearDtsInfo(t),f=Math.ceil(1024*Be/t.samplerate),o.length&&(h=o.length*f,this.trigger("segmentTimingInfo",je(d.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate),o[0].dts,o[0].pts,o[0].dts+h,o[0].pts+h,p||0)),this.trigger("timingInfo",{start:o[0].pts,end:o[0].pts+h})),this.trigger("data",{track:t,boxes:c}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){Mt.clearDtsInfo(t),r=[],this.trigger("reset")}}).prototype=new u,(Ce=function(t,e){var r,n,i=0,a=[],s=[];e=e||{},Ce.prototype.init.call(this),delete t.minPTS,this.gopCache_=[],this.push=function(e){Mt.collectDtsInfo(t,e),"seq_parameter_set_rbsp"!==e.nalUnitType||r||(r=e.config,t.sps=[e.data],Fe.forEach((function(e){t[e]=r[e]}),this)),"pic_parameter_set_rbsp"!==e.nalUnitType||n||(n=e.data,t.pps=[e.data]),a.push(e)},this.flush=function(){for(var r,n,o,u,l,c,d,f,h=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(r=At.groupNalsIntoFrames(a),(o=At.groupFramesIntoGops(r))[0][0].keyFrame||((n=this.getGopForFusion_(a[0],t))?(h=n.duration,o.unshift(n),o.byteLength+=n.byteLength,o.nalCount+=n.nalCount,o.pts=n.pts,o.dts=n.dts,o.duration+=n.duration):o=At.extendFirstKeyFrame(o)),s.length){var p;if(!(p=e.alignGopsAtEnd?this.alignGopsAtEnd_(o):this.alignGopsAtStart_(o)))return this.gopCache_.unshift({gop:o.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Mt.clearDtsInfo(t),o=p}Mt.collectDtsInfo(t,o),t.samples=At.generateSampleTable(o),l=ct.mdat(At.concatenateNalData(o)),t.baseMediaDecodeTime=Mt.calculateTrackBaseMediaDecodeTime(t,e.keepOriginalTimestamps),this.trigger("processedGopsInfo",o.map((function(t){return{pts:t.pts,dts:t.dts,byteLength:t.byteLength}}))),d=o[0],f=o[o.length-1],this.trigger("segmentTimingInfo",je(t.baseMediaDecodeTime,d.dts,d.pts,f.dts+f.duration,f.pts+f.duration,h)),this.trigger("timingInfo",{start:o[0].pts,end:o[o.length-1].pts+o[o.length-1].duration}),this.gopCache_.unshift({gop:o.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",t.baseMediaDecodeTime),this.trigger("timelineStartInfo",t.timelineStartInfo),u=ct.moof(i,[t]),c=new Uint8Array(u.byteLength+l.byteLength),i++,c.set(u),c.set(l,u.byteLength),this.trigger("data",{track:t,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),a=[],this.gopCache_.length=0,s.length=0,this.trigger("reset")},this.resetStream_=function(){Mt.clearDtsInfo(t),r=void 0,n=void 0},this.getGopForFusion_=function(e){var r,n,i,a,s,o=45e3,u=1e4,l=1/0;for(s=0;s<this.gopCache_.length;s++)i=(a=this.gopCache_[s]).gop,t.pps&&Ge(t.pps[0],a.pps[0])&&t.sps&&Ge(t.sps[0],a.sps[0])&&(i.dts<t.timelineStartInfo.dts||(r=e.dts-i.dts-i.duration)>=-u&&r<=o&&(!n||l>r)&&(n=a,l=r));return n?n.gop:null},this.alignGopsAtStart_=function(t){var e,r,n,i,a,o,u,l;for(a=t.byteLength,o=t.nalCount,u=t.duration,e=r=0;e<s.length&&r<t.length&&(n=s[e],i=t[r],n.pts!==i.pts);)i.pts>n.pts?e++:(r++,a-=i.byteLength,o-=i.nalCount,u-=i.duration);return 0===r?t:r===t.length?null:((l=t.slice(r)).byteLength=a,l.duration=u,l.nalCount=o,l.pts=l[0].pts,l.dts=l[0].dts,l)},this.alignGopsAtEnd_=function(t){var e,r,n,i,a,o,u;for(e=s.length-1,r=t.length-1,a=null,o=!1;e>=0&&r>=0;){if(n=s[e],i=t[r],n.pts===i.pts){o=!0;break}n.pts>i.pts?e--:(e===s.length-1&&(a=r),r--)}if(!o&&null===a)return null;if(0===(u=o?r:a))return t;var l=t.slice(u),c=l.reduce((function(t,e){return t.byteLength+=e.byteLength,t.duration+=e.duration,t.nalCount+=e.nalCount,t}),{byteLength:0,duration:0,nalCount:0});return l.byteLength=c.byteLength,l.duration=c.duration,l.nalCount=c.nalCount,l.pts=l[0].pts,l.dts=l[0].dts,l},this.alignGopsWith=function(t){s=t}}).prototype=new u,(Oe=function(t,e){this.numberOfTracks=0,this.metadataStream=e,"undefined"!==typeof(t=t||{}).remux?this.remuxTracks=!!t.remux:this.remuxTracks=!0,"boolean"===typeof t.keepOriginalTimestamps?this.keepOriginalTimestamps=t.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Oe.prototype.init.call(this),this.push=function(t){return t.text?this.pendingCaptions.push(t):t.frames?this.pendingMetadata.push(t):(this.pendingTracks.push(t.track),this.pendingBytes+=t.boxes.byteLength,"video"===t.track.type&&(this.videoTrack=t.track,this.pendingBoxes.push(t.boxes)),void("audio"===t.track.type&&(this.audioTrack=t.track,this.pendingBoxes.unshift(t.boxes))))}}).prototype=new u,Oe.prototype.flush=function(t){var e,r,n,i,a=0,s={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==t&&"AudioSegmentStream"!==t)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(o=this.videoTrack.timelineStartInfo.pts,Fe.forEach((function(t){s.info[t]=this.videoTrack[t]}),this)):this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts,Me.forEach((function(t){s.info[t]=this.audioTrack[t]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?s.type=this.pendingTracks[0].type:s.type="combined",this.emittedTracks+=this.pendingTracks.length,n=ct.initSegment(this.pendingTracks),s.initSegment=new Uint8Array(n.byteLength),s.initSegment.set(n),s.data=new Uint8Array(this.pendingBytes),i=0;i<this.pendingBoxes.length;i++)s.data.set(this.pendingBoxes[i],a),a+=this.pendingBoxes[i].byteLength;for(i=0;i<this.pendingCaptions.length;i++)(e=this.pendingCaptions[i]).startTime=d.metadataTsToSeconds(e.startPts,o,this.keepOriginalTimestamps),e.endTime=d.metadataTsToSeconds(e.endPts,o,this.keepOriginalTimestamps),s.captionStreams[e.stream]=!0,s.captions.push(e);for(i=0;i<this.pendingMetadata.length;i++)(r=this.pendingMetadata[i]).cueTime=d.metadataTsToSeconds(r.pts,o,this.keepOriginalTimestamps),s.metadata.push(r);for(s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",s),i=0;i<s.captions.length;i++)e=s.captions[i],this.trigger("caption",e);for(i=0;i<s.metadata.length;i++)r=s.metadata[i],this.trigger("id3Frame",r)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Oe.prototype.setRemux=function(t){this.remuxTracks=t},(xe=function(t){var e,r,n=this,i=!0;xe.prototype.init.call(this),t=t||{},this.baseMediaDecodeTime=t.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var i={};this.transmuxPipeline_=i,i.type="aac",i.metadataStream=new Se.MetadataStream,i.aacStream=new Pe,i.audioTimestampRolloverStream=new Se.TimestampRolloverStream("audio"),i.timedMetadataTimestampRolloverStream=new Se.TimestampRolloverStream("timed-metadata"),i.adtsStream=new v,i.coalesceStream=new Oe(t,i.metadataStream),i.headOfPipeline=i.aacStream,i.aacStream.pipe(i.audioTimestampRolloverStream).pipe(i.adtsStream),i.aacStream.pipe(i.timedMetadataTimestampRolloverStream).pipe(i.metadataStream).pipe(i.coalesceStream),i.metadataStream.on("timestamp",(function(t){i.aacStream.setTimestamp(t.timeStamp)})),i.aacStream.on("data",(function(a){"timed-metadata"!==a.type&&"audio"!==a.type||i.audioSegmentStream||(r=r||{timelineStartInfo:{baseMediaDecodeTime:n.baseMediaDecodeTime},codec:"adts",type:"audio"},i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new Ie(r,t),i.audioSegmentStream.on("timingInfo",n.trigger.bind(n,"audioTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream),n.trigger("trackinfo",{hasAudio:!!r,hasVideo:!!e}))})),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var i={};this.transmuxPipeline_=i,i.type="ts",i.metadataStream=new Se.MetadataStream,i.packetStream=new Se.TransportPacketStream,i.parseStream=new Se.TransportParseStream,i.elementaryStream=new Se.ElementaryStream,i.timestampRolloverStream=new Se.TimestampRolloverStream,i.adtsStream=new v,i.h264Stream=new Ue,i.captionStream=new Se.CaptionStream(t),i.coalesceStream=new Oe(t,i.metadataStream),i.headOfPipeline=i.packetStream,i.packetStream.pipe(i.parseStream).pipe(i.elementaryStream).pipe(i.timestampRolloverStream),i.timestampRolloverStream.pipe(i.h264Stream),i.timestampRolloverStream.pipe(i.adtsStream),i.timestampRolloverStream.pipe(i.metadataStream).pipe(i.coalesceStream),i.h264Stream.pipe(i.captionStream).pipe(i.coalesceStream),i.elementaryStream.on("data",(function(a){var s;if("metadata"===a.type){for(s=a.tracks.length;s--;)e||"video"!==a.tracks[s].type?r||"audio"!==a.tracks[s].type||((r=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime):(e=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime;e&&!i.videoSegmentStream&&(i.coalesceStream.numberOfTracks++,i.videoSegmentStream=new Ce(e,t),i.videoSegmentStream.on("timelineStartInfo",(function(e){r&&!t.keepOriginalTimestamps&&(r.timelineStartInfo=e,i.audioSegmentStream.setEarliestDts(e.dts-n.baseMediaDecodeTime))})),i.videoSegmentStream.on("processedGopsInfo",n.trigger.bind(n,"gopInfo")),i.videoSegmentStream.on("segmentTimingInfo",n.trigger.bind(n,"videoSegmentTimingInfo")),i.videoSegmentStream.on("baseMediaDecodeTime",(function(t){r&&i.audioSegmentStream.setVideoBaseMediaDecodeTime(t)})),i.videoSegmentStream.on("timingInfo",n.trigger.bind(n,"videoTimingInfo")),i.h264Stream.pipe(i.videoSegmentStream).pipe(i.coalesceStream)),r&&!i.audioSegmentStream&&(i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new Ie(r,t),i.audioSegmentStream.on("timingInfo",n.trigger.bind(n,"audioTimingInfo")),i.audioSegmentStream.on("segmentTimingInfo",n.trigger.bind(n,"audioSegmentTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)),n.trigger("trackinfo",{hasAudio:!!r,hasVideo:!!e})}})),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("id3Frame",(function(t){t.dispatchType=i.metadataStream.dispatchType,n.trigger("id3Frame",t)})),i.coalesceStream.on("caption",this.trigger.bind(this,"caption")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(n){var i=this.transmuxPipeline_;t.keepOriginalTimestamps||(this.baseMediaDecodeTime=n),r&&(r.timelineStartInfo.dts=void 0,r.timelineStartInfo.pts=void 0,Mt.clearDtsInfo(r),i.audioTimestampRolloverStream&&i.audioTimestampRolloverStream.discontinuity()),e&&(i.videoSegmentStream&&(i.videoSegmentStream.gopCache_=[]),e.timelineStartInfo.dts=void 0,e.timelineStartInfo.pts=void 0,Mt.clearDtsInfo(e),i.captionStream.reset()),i.timestampRolloverStream&&i.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(t){r&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(t)},this.setRemux=function(e){var r=this.transmuxPipeline_;t.remux=e,r&&r.coalesceStream&&r.coalesceStream.setRemux(e)},this.alignGopsWith=function(t){e&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(t)},this.push=function(t){if(i){var e=Ne(t);e&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():e||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),i=!1}this.transmuxPipeline_.headOfPipeline.push(t)},this.flush=function(){i=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new u;var He,Ve={Transmuxer:xe,VideoSegmentStream:Ce,AudioSegmentStream:Ie,AUDIO_PROPERTIES:Me,VIDEO_PROPERTIES:Fe,generateSegmentTimingInfo:je},Ke=Nt.discardEmulationPreventionBytes,ze=Jt.CaptionStream,We=function(t,e){for(var r=t,n=0;n<e.length;n++){var i=e[n];if(r<i.size)return i;r-=i.size}return null},Ye=function(t,e,r){var n,i,a,s,o=new DataView(t.buffer,t.byteOffset,t.byteLength),u=[];for(i=0;i+4<t.length;i+=a)if(a=o.getUint32(i),i+=4,!(a<=0))switch(31&t[i]){case 6:var l=t.subarray(i+1,i+1+a),c=We(i,e);if(n={nalUnitType:"sei_rbsp",size:a,data:l,escapedRBSP:Ke(l),trackId:r},c)n.pts=c.pts,n.dts=c.dts,s=c;else{if(!s){console.log("We've encountered a nal unit without data. See mux.js#233.");break}n.pts=s.pts,n.dts=s.dts}u.push(n)}return u},qe=function(t,e,r){var n=e,i=r.defaultSampleDuration||0,a=r.defaultSampleSize||0,s=r.trackId,o=[];return t.forEach((function(t){var e=vt(t).samples;e.forEach((function(t){void 0===t.duration&&(t.duration=i),void 0===t.size&&(t.size=a),t.trackId=s,t.dts=n,void 0===t.compositionTimeOffset&&(t.compositionTimeOffset=0),t.pts=n+t.compositionTimeOffset,n+=t.duration})),o=o.concat(e)})),o},Xe=function(t,e){var r=pt(t,["moof","traf"]),n=pt(t,["mdat"]),i={},a=[];return n.forEach((function(t,e){var n=r[e];a.push({mdat:t,traf:n})})),a.forEach((function(t){var r,n,a=t.mdat,s=t.traf,o=pt(s,["tfhd"]),u=gt(o[0]),l=u.trackId,c=pt(s,["tfdt"]),d=c.length>0?bt(c[0]).baseMediaDecodeTime:0,f=pt(s,["trun"]);e===l&&f.length>0&&(r=qe(f,d,u),n=Ye(a,r,l),i[l]||(i[l]=[]),i[l]=i[l].concat(n))})),i},$e=function(t,e,r){return null===e?null:{seiNals:Xe(t,e)[e],timescale:r}},Qe=function(){var t,e,r,n,i,a,s=!1;this.isInitialized=function(){return s},this.init=function(e){t=new ze,s=!0,a=!!e&&e.isPartial,t.on("data",(function(t){t.startTime=t.startPts/n,t.endTime=t.endPts/n,i.captions.push(t),i.captionStreams[t.stream]=!0}))},this.isNewInit=function(t,e){return!(t&&0===t.length||e&&"object"===typeof e&&0===Object.keys(e).length)&&(r!==t[0]||n!==e[r])},this.parse=function(t,a,s){var o;if(!this.isInitialized())return null;if(!a||!s)return null;if(this.isNewInit(a,s))r=a[0],n=s[r];else if(null===r||!n)return e.push(t),null;for(;e.length>0;){var u=e.shift();this.parse(u,a,s)}return null!==(o=$e(t,r,n))&&o.seiNals?(this.pushNals(o.seiNals),this.flushStream(),i):null},this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length)return null;e.forEach((function(e){t.push(e)}))},this.flushStream=function(){if(!this.isInitialized())return null;a?t.partialFlush():t.flush()},this.clearParsedCaptions=function(){i.captions=[],i.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;t.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){e=[],r=null,n=null,i?this.clearParsedCaptions():i={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()},Je={generator:ct,probe:wt,Transmuxer:Ve.Transmuxer,AudioSegmentStream:Ve.AudioSegmentStream,VideoSegmentStream:Ve.VideoSegmentStream,CaptionParser:Qe};(He=function(t,e){var r,n=0,i=16384,a=function(t,e){var r,n=t.position+e;n<t.bytes.byteLength||((r=new Uint8Array(2*n)).set(t.bytes.subarray(0,t.position),0),t.bytes=r,t.view=new DataView(t.bytes.buffer))},s=He.widthBytes||new Uint8Array("width".length),o=He.heightBytes||new Uint8Array("height".length),u=He.videocodecidBytes||new Uint8Array("videocodecid".length);if(!He.widthBytes){for(r=0;r<"width".length;r++)s[r]="width".charCodeAt(r);for(r=0;r<"height".length;r++)o[r]="height".charCodeAt(r);for(r=0;r<"videocodecid".length;r++)u[r]="videocodecid".charCodeAt(r);He.widthBytes=s,He.heightBytes=o,He.videocodecidBytes=u}switch(this.keyFrame=!1,t){case He.VIDEO_TAG:this.length=16,i*=6;break;case He.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case He.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw new Error("Unknown FLV tag type")}this.bytes=new Uint8Array(i),this.view=new DataView(this.bytes.buffer),this.bytes[0]=t,this.position=this.length,this.keyFrame=e,this.pts=0,this.dts=0,this.writeBytes=function(t,e,r){var n,i=e||0;n=i+(r=r||t.byteLength),a(this,r),this.bytes.set(t.subarray(i,n),this.position),this.position+=r,this.length=Math.max(this.length,this.position)},this.writeByte=function(t){a(this,1),this.bytes[this.position]=t,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(t){a(this,2),this.view.setUint16(this.position,t),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(t){return this.bytes[this.length-t]},this.nalUnitSize=function(){return 0===n?0:this.length-(n+4)},this.startNalUnit=function(){if(n>0)throw new Error("Attempted to create new NAL wihout closing the old one");n=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(t){var e,r;this.length===n+4?this.length-=4:n>0&&(e=n+4,r=this.length-e,this.position=n,this.view.setUint32(this.position,r),this.position=this.length,t&&t.push(this.bytes.subarray(e,e+r))),n=0},this.writeMetaDataDouble=function(t,e){var r;if(a(this,2+t.length+9),this.view.setUint16(this.position,t.length),this.position+=2,"width"===t)this.bytes.set(s,this.position),this.position+=5;else if("height"===t)this.bytes.set(o,this.position),this.position+=6;else if("videocodecid"===t)this.bytes.set(u,this.position),this.position+=12;else for(r=0;r<t.length;r++)this.bytes[this.position]=t.charCodeAt(r),this.position++;this.position++,this.view.setFloat64(this.position,e),this.position+=8,this.length=Math.max(this.length,this.position),++n},this.writeMetaDataBoolean=function(t,e){var r;for(a(this,2),this.view.setUint16(this.position,t.length),this.position+=2,r=0;r<t.length;r++)a(this,1),this.bytes[this.position]=t.charCodeAt(r),this.position++;a(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,e?1:0),this.position++,this.length=Math.max(this.length,this.position),++n},this.finalize=function(){var t,r;switch(this.bytes[0]){case He.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||e?16:32),this.bytes[12]=e?0:1,t=this.pts-this.dts,this.bytes[13]=(16711680&t)>>>16,this.bytes[14]=(65280&t)>>>8,this.bytes[15]=(255&t)>>>0;break;case He.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=e?0:1;break;case He.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,n),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return r=this.length-11,this.bytes[1]=(16711680&r)>>>16,this.bytes[2]=(65280&r)>>>8,this.bytes[3]=(255&r)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,a(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=He.frameTime(this.bytes),this}}).AUDIO_TAG=8,He.VIDEO_TAG=9,He.METADATA_TAG=18,He.isAudioFrame=function(t){return He.AUDIO_TAG===t[0]},He.isVideoFrame=function(t){return He.VIDEO_TAG===t[0]},He.isMetaData=function(t){return He.METADATA_TAG===t[0]},He.isKeyFrame=function(t){return He.isVideoFrame(t)?23===t[11]:!!He.isAudioFrame(t)||!!He.isMetaData(t)},He.frameTime=function(t){var e=t[4]<<16;return e|=t[5]<<8,e|=t[6]<<0,e|=t[7]<<24};var Ze=He,tr=function t(e){this.numberOfTracks=0,this.metadataStream=e.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,this.processedTracks=0,t.prototype.init.call(this),this.push=function(t){return t.text?this.pendingCaptions.push(t):t.frames?this.pendingMetadata.push(t):("video"===t.track.type&&(this.videoTrack=t.track,this.videoTags=t.tags,this.pendingTracks++),void("audio"===t.track.type&&(this.audioTrack=t.track,this.audioTags=t.tags,this.pendingTracks++)))}};tr.prototype=new u,tr.prototype.flush=function(t){var e,r,n,i,a={tags:{},captions:[],captionStreams:{},metadata:[]};if(this.pendingTracks<this.numberOfTracks){if("VideoSegmentStream"!==t&&"AudioSegmentStream"!==t)return;if(0===this.pendingTracks&&(this.processedTracks++,this.processedTracks<this.numberOfTracks))return}if(this.processedTracks+=this.pendingTracks,this.pendingTracks=0,!(this.processedTracks<this.numberOfTracks)){for(this.videoTrack?i=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(i=this.audioTrack.timelineStartInfo.pts),a.tags.videoTags=this.videoTags,a.tags.audioTags=this.audioTags,n=0;n<this.pendingCaptions.length;n++)(r=this.pendingCaptions[n]).startTime=r.startPts-i,r.startTime/=9e4,r.endTime=r.endPts-i,r.endTime/=9e4,a.captionStreams[r.stream]=!0,a.captions.push(r);for(n=0;n<this.pendingMetadata.length;n++)(e=this.pendingMetadata[n]).cueTime=e.pts-i,e.cueTime/=9e4,a.metadata.push(e);a.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.processedTracks=0,this.trigger("data",a),this.trigger("done")}};var er,rr,nr,ir,ar,sr,or=tr,ur=function(){var t=this;this.list=[],this.push=function(t){this.list.push({bytes:t.bytes,dts:t.dts,pts:t.pts,keyFrame:t.keyFrame,metaDataTag:t.metaDataTag})},Object.defineProperty(this,"length",{get:function(){return t.list.length}})},lr=et.H264Stream;ir=function(t,e){"number"===typeof e.pts&&(void 0===t.timelineStartInfo.pts?t.timelineStartInfo.pts=e.pts:t.timelineStartInfo.pts=Math.min(t.timelineStartInfo.pts,e.pts)),"number"===typeof e.dts&&(void 0===t.timelineStartInfo.dts?t.timelineStartInfo.dts=e.dts:t.timelineStartInfo.dts=Math.min(t.timelineStartInfo.dts,e.dts))},ar=function(t,e){var r=new Ze(Ze.METADATA_TAG);return r.dts=e,r.pts=e,r.writeMetaDataDouble("videocodecid",7),r.writeMetaDataDouble("width",t.width),r.writeMetaDataDouble("height",t.height),r},sr=function(t,e){var r,n=new Ze(Ze.VIDEO_TAG,!0);for(n.dts=e,n.pts=e,n.writeByte(1),n.writeByte(t.profileIdc),n.writeByte(t.profileCompatibility),n.writeByte(t.levelIdc),n.writeByte(255),n.writeByte(225),n.writeShort(t.sps[0].length),n.writeBytes(t.sps[0]),n.writeByte(t.pps.length),r=0;r<t.pps.length;++r)n.writeShort(t.pps[r].length),n.writeBytes(t.pps[r]);return n},(nr=function(t){var e,r=[],n=[];nr.prototype.init.call(this),this.push=function(e){ir(t,e),t&&(t.audioobjecttype=e.audioobjecttype,t.channelcount=e.channelcount,t.samplerate=e.samplerate,t.samplingfrequencyindex=e.samplingfrequencyindex,t.samplesize=e.samplesize,t.extraData=t.audioobjecttype<<11|t.samplingfrequencyindex<<7|t.channelcount<<3),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),r.push(e)},this.flush=function(){var i,a,s,o=new ur;if(0!==r.length){for(s=-1/0;r.length;)i=r.shift(),n.length&&i.pts>=n[0]&&(s=n.shift(),this.writeMetaDataTags(o,s)),(t.extraData!==e||i.pts-s>=1e3)&&(this.writeMetaDataTags(o,i.pts),e=t.extraData,s=i.pts),(a=new Ze(Ze.AUDIO_TAG)).pts=i.pts,a.dts=i.dts,a.writeBytes(i.data),o.push(a.finalize());n.length=0,e=null,this.trigger("data",{track:t,tags:o.list}),this.trigger("done","AudioSegmentStream")}else this.trigger("done","AudioSegmentStream")},this.writeMetaDataTags=function(e,r){var n;(n=new Ze(Ze.METADATA_TAG)).pts=r,n.dts=r,n.writeMetaDataDouble("audiocodecid",10),n.writeMetaDataBoolean("stereo",2===t.channelcount),n.writeMetaDataDouble("audiosamplerate",t.samplerate),n.writeMetaDataDouble("audiosamplesize",16),e.push(n.finalize()),(n=new Ze(Ze.AUDIO_TAG,!0)).pts=r,n.dts=r,n.view.setUint16(n.position,t.extraData),n.position+=2,n.length=Math.max(n.length,n.position),e.push(n.finalize())},this.onVideoKeyFrame=function(t){n.push(t)}}).prototype=new u,(rr=function(t){var e,r,n=[];rr.prototype.init.call(this),this.finishFrame=function(n,i){if(i){if(e&&t&&t.newMetadata&&(i.keyFrame||0===n.length)){var a=ar(e,i.dts).finalize(),s=sr(t,i.dts).finalize();a.metaDataTag=s.metaDataTag=!0,n.push(a),n.push(s),t.newMetadata=!1,this.trigger("keyframe",i.dts)}i.endNalUnit(),n.push(i.finalize()),r=null}},this.push=function(e){ir(t,e),e.pts=Math.round(e.pts/90),e.dts=Math.round(e.dts/90),n.push(e)},this.flush=function(){for(var i,a=new ur;n.length&&"access_unit_delimiter_rbsp"!==n[0].nalUnitType;)n.shift();if(0!==n.length){for(;n.length;)"seq_parameter_set_rbsp"===(i=n.shift()).nalUnitType?(t.newMetadata=!0,e=i.config,t.width=e.width,t.height=e.height,t.sps=[i.data],t.profileIdc=e.profileIdc,t.levelIdc=e.levelIdc,t.profileCompatibility=e.profileCompatibility,r.endNalUnit()):"pic_parameter_set_rbsp"===i.nalUnitType?(t.newMetadata=!0,t.pps=[i.data],r.endNalUnit()):"access_unit_delimiter_rbsp"===i.nalUnitType?(r&&this.finishFrame(a,r),(r=new Ze(Ze.VIDEO_TAG)).pts=i.pts,r.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(r.keyFrame=!0),r.endNalUnit()),r.startNalUnit(),r.writeBytes(i.data);r&&this.finishFrame(a,r),this.trigger("data",{track:t,tags:a.list}),this.trigger("done","VideoSegmentStream")}else this.trigger("done","VideoSegmentStream")}}).prototype=new u,(er=function(t){var e,r,n,i,a,s,o,u,l,c,d,f,h=this;er.prototype.init.call(this),t=t||{},this.metadataStream=new Se.MetadataStream,t.metadataStream=this.metadataStream,e=new Se.TransportPacketStream,r=new Se.TransportParseStream,n=new Se.ElementaryStream,i=new Se.TimestampRolloverStream("video"),a=new Se.TimestampRolloverStream("audio"),s=new Se.TimestampRolloverStream("timed-metadata"),o=new v,u=new lr,f=new or(t),e.pipe(r).pipe(n),n.pipe(i).pipe(u),n.pipe(a).pipe(o),n.pipe(s).pipe(this.metadataStream).pipe(f),d=new Se.CaptionStream(t),u.pipe(d).pipe(f),n.on("data",(function(t){var e,r,n;if("metadata"===t.type){for(e=t.tracks.length;e--;)"video"===t.tracks[e].type?r=t.tracks[e]:"audio"===t.tracks[e].type&&(n=t.tracks[e]);r&&!l&&(f.numberOfTracks++,l=new rr(r),u.pipe(l).pipe(f)),n&&!c&&(f.numberOfTracks++,c=new nr(n),o.pipe(c).pipe(f),l&&l.on("keyframe",c.onVideoKeyFrame))}})),this.push=function(t){e.push(t)},this.flush=function(){e.flush()},this.resetCaptions=function(){d.reset()},f.on("data",(function(t){h.trigger("data",t)})),f.on("done",(function(){h.trigger("done")}))}).prototype=new u;var cr=function(t,e,r){var n,i,a,s=new Uint8Array(9),o=new DataView(s.buffer);return t=t||0,e=void 0===e||e,r=void 0===r||r,o.setUint8(0,70),o.setUint8(1,76),o.setUint8(2,86),o.setUint8(3,1),o.setUint8(4,(e?4:0)|(r?1:0)),o.setUint32(5,s.byteLength),t<=0?((i=new Uint8Array(s.byteLength+4)).set(s),i.set([0,0,0,0],s.byteLength),i):((n=new Ze(Ze.METADATA_TAG)).pts=n.dts=0,n.writeMetaDataDouble("duration",t),a=n.finalize().length,(i=new Uint8Array(s.byteLength+a)).set(s),i.set(o.byteLength,a),i)},dr={tag:Ze,Transmuxer:er,getFlvHeader:cr},fr=Se,hr=d.ONE_SECOND_IN_TS,pr=function t(e,r){var n=[],i=0,a=0,s=0,o=1/0,u=null,l=null;r=r||{},t.prototype.init.call(this),this.push=function(t){Mt.collectDtsInfo(e,t),e&&Me.forEach((function(r){e[r]=t[r]})),n.push(t)},this.setEarliestDts=function(t){a=t},this.setVideoBaseMediaDecodeTime=function(t){o=t},this.setAudioAppendStart=function(t){s=t},this.processFrames_=function(){var t,c,d,f,h;0!==n.length&&0!==(t=Ot.trimAdtsFramesByEarliestDts(n,e,a)).length&&(e.baseMediaDecodeTime=Mt.calculateTrackBaseMediaDecodeTime(e,r.keepOriginalTimestamps),Ot.prefixWithSilence(e,t,s,o),e.samples=Ot.generateSampleTable(t),d=ct.mdat(Ot.concatenateFrameData(t)),n=[],c=ct.moof(i,[e]),i++,e.initSegment=ct.initSegment([e]),(f=new Uint8Array(c.byteLength+d.byteLength)).set(c),f.set(d,c.byteLength),Mt.clearDtsInfo(e),null===u&&(l=u=t[0].pts),l+=t.length*(1024*hr/e.samplerate),h={start:u},this.trigger("timingInfo",h),this.trigger("data",{track:e,boxes:f}))},this.flush=function(){this.processFrames_(),this.trigger("timingInfo",{start:u,end:l}),this.resetTiming_(),this.trigger("done","AudioSegmentStream")},this.partialFlush=function(){this.processFrames_(),this.trigger("partialdone","AudioSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","AudioSegmentStream")},this.resetTiming_=function(){Mt.clearDtsInfo(e),u=null,l=null},this.reset=function(){this.resetTiming_(),n=[],this.trigger("reset")}};pr.prototype=new u;var gr=pr,mr=function t(e,r){var n,i,a,s=0,o=[],u=[],l=null,c=null,d=!0;r=r||{},t.prototype.init.call(this),this.push=function(t){Mt.collectDtsInfo(e,t),"undefined"===typeof e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),"seq_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.config,e.sps=[t.data],Fe.forEach((function(t){e[t]=n[t]}),this)),"pic_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.data,e.pps=[t.data]),o.push(t)},this.processNals_=function(t){var n;for(o=u.concat(o);o.length&&"access_unit_delimiter_rbsp"!==o[0].nalUnitType;)o.shift();if(0!==o.length){var i=At.groupNalsIntoFrames(o);if(i.length)if(u=i[i.length-1],t&&(i.pop(),i.duration-=u.duration,i.nalCount-=u.length,i.byteLength-=u.byteLength),i.length){if(this.trigger("timelineStartInfo",e.timelineStartInfo),d){if(!(a=At.groupFramesIntoGops(i))[0][0].keyFrame){if(!(a=At.extendFirstKeyFrame(a))[0][0].keyFrame)return o=[].concat.apply([],i).concat(u),void(u=[]);(i=[].concat.apply([],a)).duration=a.duration}d=!1}for(null===l&&(l=i[0].pts,c=l),c+=i.duration,this.trigger("timingInfo",{start:l,end:c}),n=0;n<i.length;n++){var f=i[n];e.samples=At.generateSampleTableForFrame(f);var h=ct.mdat(At.concatenateNalDataForFrame(f));Mt.clearDtsInfo(e),Mt.collectDtsInfo(e,f),e.baseMediaDecodeTime=Mt.calculateTrackBaseMediaDecodeTime(e,r.keepOriginalTimestamps);var p=ct.moof(s,[e]);s++,e.initSegment=ct.initSegment([e]);var g=new Uint8Array(p.byteLength+h.byteLength);g.set(p),g.set(h,p.byteLength),this.trigger("data",{track:e,boxes:g,sequence:s,videoFrameDts:f.dts,videoFramePts:f.pts})}o=[]}else o=[]}},this.resetTimingAndConfig_=function(){n=void 0,i=void 0,l=null,c=null},this.partialFlush=function(){this.processNals_(!0),this.trigger("partialdone","VideoSegmentStream")},this.flush=function(){this.processNals_(!1),this.resetTimingAndConfig_(),this.trigger("done","VideoSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","VideoSegmentStream")},this.reset=function(){this.resetTimingAndConfig_(),u=[],o=[],d=!0,this.trigger("reset")}};mr.prototype=new u;var vr=mr,yr=Re.isLikelyAacData,br=function(t){return t.prototype=new u,t.prototype.init.call(t),t},Er=function(t){var e={type:"ts",tracks:{audio:null,video:null},packet:new Se.TransportPacketStream,parse:new Se.TransportParseStream,elementary:new Se.ElementaryStream,timestampRollover:new Se.TimestampRolloverStream,adts:new rt.Adts,h264:new rt.h264.H264Stream,captionStream:new Se.CaptionStream(t),metadataStream:new Se.MetadataStream};return e.headOfPipeline=e.packet,e.packet.pipe(e.parse).pipe(e.elementary).pipe(e.timestampRollover),e.timestampRollover.pipe(e.h264),e.h264.pipe(e.captionStream),e.timestampRollover.pipe(e.metadataStream),e.timestampRollover.pipe(e.adts),e.elementary.on("data",(function(r){if("metadata"===r.type){for(var n=0;n<r.tracks.length;n++)e.tracks[r.tracks[n].type]||(e.tracks[r.tracks[n].type]=r.tracks[n],e.tracks[r.tracks[n].type].timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime);e.tracks.video&&!e.videoSegmentStream&&(e.videoSegmentStream=new vr(e.tracks.video,t),e.videoSegmentStream.on("timelineStartInfo",(function(r){e.tracks.audio&&!t.keepOriginalTimestamps&&e.audioSegmentStream.setEarliestDts(r.dts-t.baseMediaDecodeTime)})),e.videoSegmentStream.on("timingInfo",e.trigger.bind(e,"videoTimingInfo")),e.videoSegmentStream.on("data",(function(t){e.trigger("data",{type:"video",data:t})})),e.videoSegmentStream.on("done",e.trigger.bind(e,"done")),e.videoSegmentStream.on("partialdone",e.trigger.bind(e,"partialdone")),e.videoSegmentStream.on("endedtimeline",e.trigger.bind(e,"endedtimeline")),e.h264.pipe(e.videoSegmentStream)),e.tracks.audio&&!e.audioSegmentStream&&(e.audioSegmentStream=new gr(e.tracks.audio,t),e.audioSegmentStream.on("data",(function(t){e.trigger("data",{type:"audio",data:t})})),e.audioSegmentStream.on("done",e.trigger.bind(e,"done")),e.audioSegmentStream.on("partialdone",e.trigger.bind(e,"partialdone")),e.audioSegmentStream.on("endedtimeline",e.trigger.bind(e,"endedtimeline")),e.audioSegmentStream.on("timingInfo",e.trigger.bind(e,"audioTimingInfo")),e.adts.pipe(e.audioSegmentStream)),e.trigger("trackinfo",{hasAudio:!!e.tracks.audio,hasVideo:!!e.tracks.video})}})),e.captionStream.on("data",(function(r){var n;n=e.tracks.video&&e.tracks.video.timelineStartInfo.pts||0,r.startTime=d.metadataTsToSeconds(r.startPts,n,t.keepOriginalTimestamps),r.endTime=d.metadataTsToSeconds(r.endPts,n,t.keepOriginalTimestamps),e.trigger("caption",r)})),(e=br(e)).metadataStream.on("data",e.trigger.bind(e,"id3Frame")),e},Tr=function(t){var e={type:"aac",tracks:{audio:null},metadataStream:new Se.MetadataStream,aacStream:new Pe,audioRollover:new Se.TimestampRolloverStream("audio"),timedMetadataRollover:new Se.TimestampRolloverStream("timed-metadata"),adtsStream:new v(!0)};return e.headOfPipeline=e.aacStream,e.aacStream.pipe(e.audioRollover).pipe(e.adtsStream),e.aacStream.pipe(e.timedMetadataRollover).pipe(e.metadataStream),e.metadataStream.on("timestamp",(function(t){e.aacStream.setTimestamp(t.timeStamp)})),e.aacStream.on("data",(function(r){"timed-metadata"!==r.type&&"audio"!==r.type||e.audioSegmentStream||(e.tracks.audio=e.tracks.audio||{timelineStartInfo:{baseMediaDecodeTime:t.baseMediaDecodeTime},codec:"adts",type:"audio"},e.audioSegmentStream=new gr(e.tracks.audio,t),e.audioSegmentStream.on("data",(function(t){e.trigger("data",{type:"audio",data:t})})),e.audioSegmentStream.on("partialdone",e.trigger.bind(e,"partialdone")),e.audioSegmentStream.on("done",e.trigger.bind(e,"done")),e.audioSegmentStream.on("endedtimeline",e.trigger.bind(e,"endedtimeline")),e.audioSegmentStream.on("timingInfo",e.trigger.bind(e,"audioTimingInfo")),e.adtsStream.pipe(e.audioSegmentStream),e.trigger("trackinfo",{hasAudio:!!e.tracks.audio,hasVideo:!!e.tracks.video}))})),(e=br(e)).metadataStream.on("data",e.trigger.bind(e,"id3Frame")),e},Sr=function(t,e){t.on("data",e.trigger.bind(e,"data")),t.on("done",e.trigger.bind(e,"done")),t.on("partialdone",e.trigger.bind(e,"partialdone")),t.on("endedtimeline",e.trigger.bind(e,"endedtimeline")),t.on("audioTimingInfo",e.trigger.bind(e,"audioTimingInfo")),t.on("videoTimingInfo",e.trigger.bind(e,"videoTimingInfo")),t.on("trackinfo",e.trigger.bind(e,"trackinfo")),t.on("id3Frame",(function(r){r.dispatchType=t.metadataStream.dispatchType,r.cueTime=d.videoTsToSeconds(r.pts),e.trigger("id3Frame",r)})),t.on("caption",(function(t){e.trigger("caption",t)}))},wr=function t(e){var r=null,n=!0;e=e||{},t.prototype.init.call(this),e.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.push=function(t){if(n){var i=yr(t);!i||r&&"aac"===r.type?i||r&&"ts"===r.type||(r=Er(e),Sr(r,this)):(r=Tr(e),Sr(r,this)),n=!1}r.headOfPipeline.push(t)},this.flush=function(){r&&(n=!0,r.headOfPipeline.flush())},this.partialFlush=function(){r&&r.headOfPipeline.partialFlush()},this.endTimeline=function(){r&&r.headOfPipeline.endTimeline()},this.reset=function(){r&&r.headOfPipeline.reset()},this.setBaseMediaDecodeTime=function(t){e.keepOriginalTimestamps||(e.baseMediaDecodeTime=t),r&&(r.tracks.audio&&(r.tracks.audio.timelineStartInfo.dts=void 0,r.tracks.audio.timelineStartInfo.pts=void 0,Mt.clearDtsInfo(r.tracks.audio),r.audioRollover&&r.audioRollover.discontinuity()),r.tracks.video&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[]),r.tracks.video.timelineStartInfo.dts=void 0,r.tracks.video.timelineStartInfo.pts=void 0,Mt.clearDtsInfo(r.tracks.video)),r.timestampRollover&&r.timestampRollover.discontinuity())},this.setRemux=function(t){e.remux=t,r&&r.coalesceStream&&r.coalesceStream.setRemux(t)},this.setAudioAppendStart=function(t){r&&r.tracks.audio&&r.audioSegmentStream&&r.audioSegmentStream.setAudioAppendStart(t)},this.alignGopsWith=function(t){}};wr.prototype=new u;var _r,kr,Ar={Transmuxer:wr},Lr=Math.pow(2,32),Dr=function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:e.getUint32(4),timescale:e.getUint32(8)},n=12;0===r.version?(r.earliestPresentationTime=e.getUint32(n),r.firstOffset=e.getUint32(n+4),n+=8):(r.earliestPresentationTime=e.getUint32(n)*Lr+e.getUint32(n+4),r.firstOffset=e.getUint32(n+8)*Lr+e.getUint32(n+12),n+=16),n+=2;var i=e.getUint16(n);for(n+=2;i>0;n+=12,i--)r.references.push({referenceType:(128&t[n])>>>7,referencedSize:2147483647&e.getUint32(n),subsegmentDuration:e.getUint32(n+4),startsWithSap:!!(128&t[n+8]),sapType:(112&t[n+8])>>>4,sapDeltaTime:268435455&e.getUint32(n+8)});return r},Rr=Math.pow(2,32),Cr=function(t){return new Date(1e3*t-20828448e5)},Ir=function(t){var e,r,n=new DataView(t.buffer,t.byteOffset,t.byteLength),i=[];for(e=0;e+4<t.length;e+=r)if(r=n.getUint32(e),e+=4,r<=0)i.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&t[e]){case 1:i.push("slice_layer_without_partitioning_rbsp");break;case 5:i.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:i.push("sei_rbsp");break;case 7:i.push("seq_parameter_set_rbsp");break;case 8:i.push("pic_parameter_set_rbsp");break;case 9:i.push("access_unit_delimiter_rbsp");break;default:i.push("UNKNOWN NAL - "+t[e]&31)}return i},xr={avc1:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:e.getUint16(6),width:e.getUint16(24),height:e.getUint16(26),horizresolution:e.getUint16(28)+e.getUint16(30)/16,vertresolution:e.getUint16(32)+e.getUint16(34)/16,frameCount:e.getUint16(40),depth:e.getUint16(74),config:_r(t.subarray(78,t.byteLength))}},avcC:function(t){var e,r,n,i,a=new DataView(t.buffer,t.byteOffset,t.byteLength),s={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:3&t[4],sps:[],pps:[]},o=31&t[5];for(n=6,i=0;i<o;i++)r=a.getUint16(n),n+=2,s.sps.push(new Uint8Array(t.subarray(n,n+r))),n+=r;for(e=t[n],n++,i=0;i<e;i++)r=a.getUint16(n),n+=2,s.pps.push(new Uint8Array(t.subarray(n,n+r))),n+=r;return s},btrt:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:e.getUint32(0),maxBitrate:e.getUint32(4),avgBitrate:e.getUint32(8)}},edts:function(t){return{boxes:_r(t)}},elst:function(t){var e,r=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),edits:[]},i=r.getUint32(4);for(e=8;i;i--)0===n.version?(n.edits.push({segmentDuration:r.getUint32(e),mediaTime:r.getInt32(e+4),mediaRate:r.getUint16(e+8)+r.getUint16(e+10)/65536}),e+=12):(n.edits.push({segmentDuration:r.getUint32(e)*Rr+r.getUint32(e+4),mediaTime:r.getUint32(e+8)*Rr+r.getUint32(e+12),mediaRate:r.getUint16(e+16)+r.getUint16(e+18)/65536}),e+=20);return n},esds:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:31&t[8],decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(7&t[26])<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function(t){for(var e=new DataView(t.buffer,t.byteOffset,t.byteLength),r={majorBrand:ft(t.subarray(0,4)),minorVersion:e.getUint32(4),compatibleBrands:[]},n=8;n<t.byteLength;)r.compatibleBrands.push(ft(t.subarray(n,n+4))),n+=4;return r},dinf:function(t){return{boxes:_r(t)}},dref:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:_r(t.subarray(8))}},hdlr:function(t){var e={version:new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0),flags:new Uint8Array(t.subarray(1,4)),handlerType:ft(t.subarray(8,12)),name:""},r=8;for(r=24;r<t.byteLength;r++){if(0===t[r]){r++;break}e.name+=String.fromCharCode(t[r])}return e.name=decodeURIComponent(escape(e.name)),e},mdat:function(t){return{byteLength:t.byteLength,nals:Ir(t)}},mdhd:function(t){var e,r=new DataView(t.buffer,t.byteOffset,t.byteLength),n=4,i={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};return 1===i.version?(n+=4,i.creationTime=Cr(r.getUint32(n)),n+=8,i.modificationTime=Cr(r.getUint32(n)),n+=4,i.timescale=r.getUint32(n),n+=8,i.duration=r.getUint32(n)):(i.creationTime=Cr(r.getUint32(n)),n+=4,i.modificationTime=Cr(r.getUint32(n)),n+=4,i.timescale=r.getUint32(n),n+=4,i.duration=r.getUint32(n)),n+=4,e=r.getUint16(n),i.language+=String.fromCharCode(96+(e>>10)),i.language+=String.fromCharCode(96+((992&e)>>5)),i.language+=String.fromCharCode(96+(31&e)),i},mdia:function(t){return{boxes:_r(t)}},mfhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function(t){return{boxes:_r(t)}},mp4a:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),r={dataReferenceIndex:e.getUint16(6),channelcount:e.getUint16(16),samplesize:e.getUint16(18),samplerate:e.getUint16(24)+e.getUint16(26)/65536};return t.byteLength>28&&(r.streamDescriptor=_r(t.subarray(28))[0]),r},moof:function(t){return{boxes:_r(t)}},moov:function(t){return{boxes:_r(t)}},mvex:function(t){return{boxes:_r(t)}},mvhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,n={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===n.version?(r+=4,n.creationTime=Cr(e.getUint32(r)),r+=8,n.modificationTime=Cr(e.getUint32(r)),r+=4,n.timescale=e.getUint32(r),r+=8,n.duration=e.getUint32(r)):(n.creationTime=Cr(e.getUint32(r)),r+=4,n.modificationTime=Cr(e.getUint32(r)),r+=4,n.timescale=e.getUint32(r),r+=4,n.duration=e.getUint32(r)),r+=4,n.rate=e.getUint16(r)+e.getUint16(r+2)/16,r+=4,n.volume=e.getUint8(r)+e.getUint8(r+1)/8,r+=2,r+=2,r+=8,n.matrix=new Uint32Array(t.subarray(r,r+36)),r+=36,r+=24,n.nextTrackId=e.getUint32(r),n},pdin:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:e.getUint32(4),initialDelay:e.getUint32(8)}},sdtp:function(t){var e,r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]};for(e=4;e<t.byteLength;e++)r.samples.push({dependsOn:(48&t[e])>>4,isDependedOn:(12&t[e])>>2,hasRedundancy:3&t[e]});return r},sidx:Dr,smhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function(t){return{boxes:_r(t)}},ctts:function(t){var e,r=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),compositionOffsets:[]},i=r.getUint32(4);for(e=8;i;e+=8,i--)n.compositionOffsets.push({sampleCount:r.getUint32(e),sampleOffset:r[0===n.version?"getUint32":"getInt32"](e+4)});return n},stss:function(t){var e,r=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:r.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),syncSamples:[]},i=r.getUint32(4);for(e=8;i;e+=4,i--)n.syncSamples.push(r.getUint32(e));return n},stco:function(t){var e,r=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},i=r.getUint32(4);for(e=8;i;e+=4,i--)n.chunkOffsets.push(r.getUint32(e));return n},stsc:function(t){var e,r=new DataView(t.buffer,t.byteOffset,t.byteLength),n=r.getUint32(4),i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]};for(e=8;n;e+=12,n--)i.sampleToChunks.push({firstChunk:r.getUint32(e),samplesPerChunk:r.getUint32(e+4),sampleDescriptionIndex:r.getUint32(e+8)});return i},stsd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:_r(t.subarray(8))}},stsz:function(t){var e,r=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:r.getUint32(4),entries:[]};for(e=12;e<t.byteLength;e+=4)n.entries.push(r.getUint32(e));return n},stts:function(t){var e,r=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},i=r.getUint32(4);for(e=8;i;e+=8,i--)n.timeToSamples.push({sampleCount:r.getUint32(e),sampleDelta:r.getUint32(e+4)});return n},styp:function(t){return xr.ftyp(t)},tfdt:bt,tfhd:gt,tkhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),r=4,n={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===n.version?(r+=4,n.creationTime=Cr(e.getUint32(r)),r+=8,n.modificationTime=Cr(e.getUint32(r)),r+=4,n.trackId=e.getUint32(r),r+=4,r+=8,n.duration=e.getUint32(r)):(n.creationTime=Cr(e.getUint32(r)),r+=4,n.modificationTime=Cr(e.getUint32(r)),r+=4,n.trackId=e.getUint32(r),r+=4,r+=4,n.duration=e.getUint32(r)),r+=4,r+=8,n.layer=e.getUint16(r),r+=2,n.alternateGroup=e.getUint16(r),r+=2,n.volume=e.getUint8(r)+e.getUint8(r+1)/8,r+=2,r+=2,n.matrix=new Uint32Array(t.subarray(r,r+36)),r+=36,n.width=e.getUint16(r)+e.getUint16(r+2)/65536,r+=4,n.height=e.getUint16(r)+e.getUint16(r+2)/65536,n},traf:function(t){return{boxes:_r(t)}},trak:function(t){return{boxes:_r(t)}},trex:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:e.getUint32(4),defaultSampleDescriptionIndex:e.getUint32(8),defaultSampleDuration:e.getUint32(12),defaultSampleSize:e.getUint32(16),sampleDependsOn:3&t[20],sampleIsDependedOn:(192&t[21])>>6,sampleHasRedundancy:(48&t[21])>>4,samplePaddingValue:(14&t[21])>>1,sampleIsDifferenceSample:!!(1&t[21]),sampleDegradationPriority:e.getUint16(22)}},trun:vt,"url ":function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:e.getUint16(4),opcolor:new Uint16Array([e.getUint16(6),e.getUint16(8),e.getUint16(10)])}}},Or={inspect:_r=function(t){for(var e,r,n,i,a,s=0,o=[],u=new ArrayBuffer(t.length),l=new Uint8Array(u),c=0;c<t.length;++c)l[c]=t[c];for(e=new DataView(u);s<t.byteLength;)r=e.getUint32(s),n=ft(t.subarray(s+4,s+8)),i=r>1?s+r:t.byteLength,(a=(xr[n]||function(t){return{data:t}})(t.subarray(s+8,i))).size=r,a.type=n,o.push(a),s=i;return o},textify:kr=function(t,e){var r;return e=e||0,r=new Array(2*e+1).join(" "),t.map((function(t,n){return r+t.type+"\n"+Object.keys(t).filter((function(t){return"type"!==t&&"boxes"!==t})).map((function(e){var n=r+"  "+e+": ",i=t[e];if(i instanceof Uint8Array||i instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(i.buffer,i.byteOffset,i.byteLength)).map((function(t){return" "+("00"+t.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);return a?1===a.length?n+"<"+a.join("").slice(1)+">":n+"<\n"+a.map((function(t){return r+"  "+t})).join("\n")+"\n"+r+"  >":n+"<>"}return n+JSON.stringify(i,null,2).split("\n").map((function(t,e){return 0===e?t:r+"  "+t})).join("\n")})).join("\n")+(t.boxes?"\n"+kr(t.boxes,e+1):"")})).join("\n")},parseType:ft,findBox:pt,parseTraf:xr.traf,parseTfdt:xr.tfdt,parseHdlr:xr.hdlr,parseTfhd:xr.tfhd,parseTrun:xr.trun,parseSidx:xr.sidx},Pr={8:"audio",9:"video",18:"metadata"},Mr=function(t){return"0x"+("00"+t.toString(16)).slice(-2).toUpperCase()},Fr=function(t){for(var e,r=[];t.byteLength>0;)e=0,r.push(Mr(t[e++])),t=t.subarray(e);return r.join(" ")},Ur=function(t,e){var r=["AVC Sequence Header","AVC NALU","AVC End-of-Sequence"],n=t[1]&parseInt("01111111",2)<<16|t[2]<<8|t[3];return(e=e||{}).avcPacketType=r[t[0]],e.CompositionTime=t[1]&parseInt("10000000",2)?-n:n,1===t[0]?e.nalUnitTypeRaw=Fr(t.subarray(4,100)):e.data=Fr(t.subarray(4)),e},Nr=function(t,e){var r=["Unknown","Keyframe (for AVC, a seekable frame)","Inter frame (for AVC, a nonseekable frame)","Disposable inter frame (H.263 only)","Generated keyframe (reserved for server use only)","Video info/command frame"],n=t[0]&parseInt("00001111",2);return(e=e||{}).frameType=r[(t[0]&parseInt("11110000",2))>>>4],e.codecID=n,7===n?Ur(t.subarray(1),e):e},Br=function(t,e){var r=["AAC Sequence Header","AAC Raw"];return(e=e||{}).aacPacketType=r[t[0]],e.data=Fr(t.subarray(1)),e},Gr=function(t,e){var r=["Linear PCM, platform endian","ADPCM","MP3","Linear PCM, little endian","Nellymoser 16-kHz mono","Nellymoser 8-kHz mono","Nellymoser","G.711 A-law logarithmic PCM","G.711 mu-law logarithmic PCM","reserved","AAC","Speex","MP3 8-Khz","Device-specific sound"],n=["5.5-kHz","11-kHz","22-kHz","44-kHz"],i=(t[0]&parseInt("11110000",2))>>>4;return(e=e||{}).soundFormat=r[i],e.soundRate=n[(t[0]&parseInt("00001100",2))>>>2],e.soundSize=(t[0]&parseInt("00000010",2))>>>1?"16-bit":"8-bit",e.soundType=t[0]&parseInt("00000001",2)?"Stereo":"Mono",10===i?Br(t.subarray(1),e):e},jr=function(t){return{tagType:Pr[t[0]],dataSize:t[1]<<16|t[2]<<8|t[3],timestamp:t[7]<<24|t[4]<<16|t[5]<<8|t[6],streamID:t[8]<<16|t[9]<<8|t[10]}},Hr=function(t){var e=jr(t);switch(t[0]){case 8:Gr(t.subarray(11),e);break;case 9:Nr(t.subarray(11),e)}return e},Vr=function(t){var e,r,n=9,i=[];for(n+=4;n<t.byteLength;)e=t[n+1]<<16,e|=t[n+2]<<8,e|=t[n+3],e+=11,r=t.subarray(n,n+e),i.push(Hr(r)),n+=e+4;return i},Kr={inspectTag:Hr,inspect:Vr,textify:function(t){return JSON.stringify(t,null,2)}},zr=function(t){var e=31&t[1];return e<<=8,e|=t[2]},Wr=function(t){return!!(64&t[1])},Yr=function(t){var e=0;return(48&t[3])>>>4>1&&(e+=t[4]+1),e},qr=function(t){if(!Wr(t))return null;var e=4+Yr(t);if(e>=t.byteLength)return null;var r,n=null;return 192&(r=t[e+7])&&((n={}).pts=(14&t[e+9])<<27|(255&t[e+10])<<20|(254&t[e+11])<<12|(255&t[e+12])<<5|(254&t[e+13])>>>3,n.pts*=4,n.pts+=(6&t[e+13])>>>1,n.dts=n.pts,64&r&&(n.dts=(14&t[e+14])<<27|(255&t[e+15])<<20|(254&t[e+16])<<12|(255&t[e+17])<<5|(254&t[e+18])>>>3,n.dts*=4,n.dts+=(6&t[e+18])>>>1)),n},Xr=function(t){switch(t){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},$r={parseType:function(t,e){var r=zr(t);return 0===r?"pat":r===e?"pmt":e?"pes":null},parsePat:function(t){var e=Wr(t),r=4+Yr(t);return e&&(r+=t[r]+1),(31&t[r+10])<<8|t[r+11]},parsePmt:function(t){var e={},r=Wr(t),n=4+Yr(t);if(r&&(n+=t[n]+1),1&t[n+5]){var i;i=3+((15&t[n+1])<<8|t[n+2])-4;for(var a=12+((15&t[n+10])<<8|t[n+11]);a<i;){var s=n+a;e[(31&t[s+1])<<8|t[s+2]]=t[s],a+=5+((15&t[s+3])<<8|t[s+4])}return e}},parsePayloadUnitStartIndicator:Wr,parsePesType:function(t,e){switch(e[zr(t)]){case Zt.H264_STREAM_TYPE:return"video";case Zt.ADTS_STREAM_TYPE:return"audio";case Zt.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:qr,videoPacketContainsKeyFrame:function(t){for(var e=4+Yr(t),r=t.subarray(e),n=0,i=0,a=!1;i<r.byteLength-3;i++)if(1===r[i+2]){n=i+5;break}for(;n<r.byteLength;)switch(r[n]){case 0:if(0!==r[n-1]){n+=2;break}if(0!==r[n-2]){n++;break}i+3!==n-2&&"slice_layer_without_partitioning_rbsp_idr"===Xr(31&r[i+3])&&(a=!0);do{n++}while(1!==r[n]&&n<r.length);i=n-2,n+=3;break;case 1:if(0!==r[n-1]||0!==r[n-2]){n+=3;break}"slice_layer_without_partitioning_rbsp_idr"===Xr(31&r[i+3])&&(a=!0),i=n-2,n+=3;break;default:n+=3}return r=r.subarray(i),n-=i,i=0,r&&r.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===Xr(31&r[i+3])&&(a=!0),a}},Qr=se.handleRollover,Jr={};Jr.ts=$r,Jr.aac=Re;var Zr=d.ONE_SECOND_IN_TS,tn=188,en=71,rn=function(t,e){for(var r,n=0,i=tn;i<t.byteLength;)if(t[n]!==en||t[i]!==en)n++,i++;else{switch(r=t.subarray(n,i),Jr.ts.parseType(r,e.pid)){case"pat":e.pid||(e.pid=Jr.ts.parsePat(r));break;case"pmt":e.table||(e.table=Jr.ts.parsePmt(r))}if(e.pid&&e.table)return;n+=tn,i+=tn}},nn=function(t,e,r){for(var n,i,a,s,o=0,u=tn,l=!1;u<=t.byteLength;)if(t[o]!==en||t[u]!==en&&u!==t.byteLength)o++,u++;else{switch(n=t.subarray(o,u),Jr.ts.parseType(n,e.pid)){case"pes":i=Jr.ts.parsePesType(n,e.table),a=Jr.ts.parsePayloadUnitStartIndicator(n),"audio"===i&&a&&(s=Jr.ts.parsePesTime(n))&&(s.type="audio",r.audio.push(s),l=!0)}if(l)break;o+=tn,u+=tn}for(o=(u=t.byteLength)-tn,l=!1;o>=0;)if(t[o]!==en||t[u]!==en&&u!==t.byteLength)o--,u--;else{switch(n=t.subarray(o,u),Jr.ts.parseType(n,e.pid)){case"pes":i=Jr.ts.parsePesType(n,e.table),a=Jr.ts.parsePayloadUnitStartIndicator(n),"audio"===i&&a&&(s=Jr.ts.parsePesTime(n))&&(s.type="audio",r.audio.push(s),l=!0)}if(l)break;o-=tn,u-=tn}},an=function(t,e,r){for(var n,i,a,s,o,u,l,c=0,d=tn,f=!1,h={data:[],size:0};d<t.byteLength;)if(t[c]!==en||t[d]!==en)c++,d++;else{switch(n=t.subarray(c,d),Jr.ts.parseType(n,e.pid)){case"pes":if(i=Jr.ts.parsePesType(n,e.table),a=Jr.ts.parsePayloadUnitStartIndicator(n),"video"===i&&(a&&!f&&(s=Jr.ts.parsePesTime(n))&&(s.type="video",r.video.push(s),f=!0),!r.firstKeyFrame)){if(a&&0!==h.size){for(o=new Uint8Array(h.size),u=0;h.data.length;)l=h.data.shift(),o.set(l,u),u+=l.byteLength;if(Jr.ts.videoPacketContainsKeyFrame(o)){var p=Jr.ts.parsePesTime(o);p?(r.firstKeyFrame=p,r.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}h.size=0}h.data.push(n),h.size+=n.byteLength}}if(f&&r.firstKeyFrame)break;c+=tn,d+=tn}for(c=(d=t.byteLength)-tn,f=!1;c>=0;)if(t[c]!==en||t[d]!==en)c--,d--;else{switch(n=t.subarray(c,d),Jr.ts.parseType(n,e.pid)){case"pes":i=Jr.ts.parsePesType(n,e.table),a=Jr.ts.parsePayloadUnitStartIndicator(n),"video"===i&&a&&(s=Jr.ts.parsePesTime(n))&&(s.type="video",r.video.push(s),f=!0)}if(f)break;c-=tn,d-=tn}},sn=function(t,e){if(t.audio&&t.audio.length){var r=e;("undefined"===typeof r||isNaN(r))&&(r=t.audio[0].dts),t.audio.forEach((function(t){t.dts=Qr(t.dts,r),t.pts=Qr(t.pts,r),t.dtsTime=t.dts/Zr,t.ptsTime=t.pts/Zr}))}if(t.video&&t.video.length){var n=e;if(("undefined"===typeof n||isNaN(n))&&(n=t.video[0].dts),t.video.forEach((function(t){t.dts=Qr(t.dts,n),t.pts=Qr(t.pts,n),t.dtsTime=t.dts/Zr,t.ptsTime=t.pts/Zr})),t.firstKeyFrame){var i=t.firstKeyFrame;i.dts=Qr(i.dts,n),i.pts=Qr(i.pts,n),i.dtsTime=i.dts/Zr,i.ptsTime=i.pts/Zr}}},on=function(t){for(var e,r=!1,n=0,i=null,a=null,s=0,o=0;t.length-o>=3;){switch(Jr.aac.parseType(t,o)){case"timed-metadata":if(t.length-o<10){r=!0;break}if((s=Jr.aac.parseId3TagSize(t,o))>t.length){r=!0;break}null===a&&(e=t.subarray(o,o+s),a=Jr.aac.parseAacTimestamp(e)),o+=s;break;case"audio":if(t.length-o<7){r=!0;break}if((s=Jr.aac.parseAdtsSize(t,o))>t.length){r=!0;break}null===i&&(e=t.subarray(o,o+s),i=Jr.aac.parseSampleRate(e)),n++,o+=s;break;default:o++}if(r)return null}if(null===i||null===a)return null;var u=Zr/i;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*n*u,pts:a+1024*n*u}]}},un=function(t){var e={pid:null,table:null},r={};for(var n in rn(t,e),e.table)if(e.table.hasOwnProperty(n))switch(e.table[n]){case Zt.H264_STREAM_TYPE:r.video=[],an(t,e,r),0===r.video.length&&delete r.video;break;case Zt.ADTS_STREAM_TYPE:r.audio=[],nn(t,e,r),0===r.audio.length&&delete r.audio}return r},ln={inspect:function(t,e){var r;return(r=Jr.aac.isLikelyAacData(t)?on(t):un(t))&&(r.audio||r.video)?(sn(r,e),r):null},parseAudioPes_:nn},cn={codecs:rt,mp4:Je,flv:dr,mp2t:fr,partial:Ar};return cn.mp4.tools=Or,cn.flv.tools=Kr,cn.mp2t.tools=ln,cn}()},,function(t,e,r){"use strict";r.r(e),r.d(e,"LineStream",(function(){return d})),r.d(e,"ParseStream",(function(){return g})),r.d(e,"Parser",(function(){return y}));var n=r(28),i=r.n(n),a=function(){function t(){this.listeners={}}var e=t.prototype;return e.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e.off=function(t,e){if(!this.listeners[t])return!1;var r=this.listeners[t].indexOf(e);return this.listeners[t]=this.listeners[t].slice(0),this.listeners[t].splice(r,1),r>-1},e.trigger=function(t){var e=this.listeners[t];if(e)if(2===arguments.length)for(var r=e.length,n=0;n<r;++n)e[n].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),a=e.length,s=0;s<a;++s)e[s].apply(this,i)},e.dispose=function(){this.listeners={}},e.pipe=function(t){this.on("data",(function(e){t.push(e)}))},t}(),s=r(32),o=r.n(s),u=r(45),l=r.n(u),c=r(46),d=function(t){function e(){var e;return(e=t.call(this)||this).buffer="",e}return i()(e,t),e.prototype.push=function(t){var e;for(this.buffer+=t,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)},e}(a),f=String.fromCharCode(9),h=function(t){var e=/([0-9.]*)?@?([0-9.]*)?/.exec(t||""),r={};return e[1]&&(r.length=parseInt(e[1],10)),e[2]&&(r.offset=parseInt(e[2],10)),r},p=function(t){for(var e,r=t.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),n={},i=r.length;i--;)""!==r[i]&&((e=/([^=]*)=(.*)/.exec(r[i]).slice(1))[0]=e[0].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^['"](.*)['"]$/g,"$1"),n[e[0]]=e[1]);return n},g=function(t){function e(){var e;return(e=t.call(this)||this).customParsers=[],e.tagMappers=[],e}i()(e,t);var r=e.prototype;return r.push=function(t){var e,r,n=this;0!==(t=t.trim()).length&&("#"===t[0]?this.tagMappers.reduce((function(e,r){var n=r(t);return n===t?e:e.concat([n])}),[t]).forEach((function(t){for(var i=0;i<n.customParsers.length;i++)if(n.customParsers[i].call(n,t))return;if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t))n.trigger("data",{type:"tag",tagType:"m3u"});else{if(e=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return r={type:"tag",tagType:"inf"},e[1]&&(r.duration=parseFloat(e[1])),e[2]&&(r.title=e[2]),void n.trigger("data",r);if(e=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"targetduration"},e[1]&&(r.duration=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return r={type:"tag",tagType:"version"},e[1]&&(r.version=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return r={type:"tag",tagType:"media-sequence"},e[1]&&(r.number=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return r={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(r.number=parseInt(e[1],10)),void n.trigger("data",r);if(e=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return r={type:"tag",tagType:"playlist-type"},e[1]&&(r.playlistType=e[1]),void n.trigger("data",r);if(e=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(t))return r=o()(h(e[1]),{type:"tag",tagType:"byterange"}),void n.trigger("data",r);if(e=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return r={type:"tag",tagType:"allow-cache"},e[1]&&(r.allowed=!/NO/.test(e[1])),void n.trigger("data",r);if(e=/^#EXT-X-MAP:?(.*)$/.exec(t)){if(r={type:"tag",tagType:"map"},e[1]){var a=p(e[1]);a.URI&&(r.uri=a.URI),a.BYTERANGE&&(r.byterange=h(a.BYTERANGE))}n.trigger("data",r)}else if(e=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t)){if(r={type:"tag",tagType:"stream-inf"},e[1]){if(r.attributes=p(e[1]),r.attributes.RESOLUTION){var s=r.attributes.RESOLUTION.split("x"),u={};s[0]&&(u.width=parseInt(s[0],10)),s[1]&&(u.height=parseInt(s[1],10)),r.attributes.RESOLUTION=u}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}n.trigger("data",r)}else{if(e=/^#EXT-X-MEDIA:?(.*)$/.exec(t))return r={type:"tag",tagType:"media"},e[1]&&(r.attributes=p(e[1])),void n.trigger("data",r);if(e=/^#EXT-X-ENDLIST/.exec(t))n.trigger("data",{type:"tag",tagType:"endlist"});else if(e=/^#EXT-X-DISCONTINUITY/.exec(t))n.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(e=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(t))return r={type:"tag",tagType:"program-date-time"},e[1]&&(r.dateTimeString=e[1],r.dateTimeObject=new Date(e[1])),void n.trigger("data",r);if(e=/^#EXT-X-KEY:?(.*)$/.exec(t))return r={type:"tag",tagType:"key"},e[1]&&(r.attributes=p(e[1]),r.attributes.IV&&("0x"===r.attributes.IV.substring(0,2).toLowerCase()&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),void n.trigger("data",r);if(e=/^#EXT-X-START:?(.*)$/.exec(t))return r={type:"tag",tagType:"start"},e[1]&&(r.attributes=p(e[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),void n.trigger("data",r);if(e=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(t))return r={type:"tag",tagType:"cue-out-cont"},e[1]?r.data=e[1]:r.data="",void n.trigger("data",r);if(e=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(t))return r={type:"tag",tagType:"cue-out"},e[1]?r.data=e[1]:r.data="",void n.trigger("data",r);if(e=/^#EXT-X-CUE-IN:?(.*)?$/.exec(t))return r={type:"tag",tagType:"cue-in"},e[1]?r.data=e[1]:r.data="",void n.trigger("data",r);if((e=/^#EXT-X-SKIP:(.*)$/.exec(t))&&e[1])return(r={type:"tag",tagType:"skip"}).attributes=p(e[1]),r.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(r.attributes["SKIPPED-SEGMENTS"]=parseInt(r.attributes["SKIPPED-SEGMENTS"],10)),r.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(r.attributes["RECENTLY-REMOVED-DATERANGES"]=r.attributes["RECENTLY-REMOVED-DATERANGES"].split(f)),void n.trigger("data",r);if((e=/^#EXT-X-PART:(.*)$/.exec(t))&&e[1])return(r={type:"tag",tagType:"part"}).attributes=p(e[1]),["DURATION"].forEach((function(t){r.attributes.hasOwnProperty(t)&&(r.attributes[t]=parseFloat(r.attributes[t]))})),["INDEPENDENT","GAP"].forEach((function(t){r.attributes.hasOwnProperty(t)&&(r.attributes[t]=/YES/.test(r.attributes[t]))})),r.attributes.hasOwnProperty("BYTERANGE")&&(r.attributes.byterange=h(r.attributes.BYTERANGE)),void n.trigger("data",r);if((e=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(t))&&e[1])return(r={type:"tag",tagType:"server-control"}).attributes=p(e[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach((function(t){r.attributes.hasOwnProperty(t)&&(r.attributes[t]=parseFloat(r.attributes[t]))})),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach((function(t){r.attributes.hasOwnProperty(t)&&(r.attributes[t]=/YES/.test(r.attributes[t]))})),void n.trigger("data",r);if((e=/^#EXT-X-PART-INF:(.*)$/.exec(t))&&e[1])return(r={type:"tag",tagType:"part-inf"}).attributes=p(e[1]),["PART-TARGET"].forEach((function(t){r.attributes.hasOwnProperty(t)&&(r.attributes[t]=parseFloat(r.attributes[t]))})),void n.trigger("data",r);if((e=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(t))&&e[1])return(r={type:"tag",tagType:"preload-hint"}).attributes=p(e[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach((function(t){if(r.attributes.hasOwnProperty(t)){r.attributes[t]=parseInt(r.attributes[t],10);var e="BYTERANGE-LENGTH"===t?"length":"offset";r.attributes.byterange=r.attributes.byterange||{},r.attributes.byterange[e]=r.attributes[t],delete r.attributes[t]}})),void n.trigger("data",r);if((e=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(t))&&e[1])return(r={type:"tag",tagType:"rendition-report"}).attributes=p(e[1]),["LAST-MSN","LAST-PART"].forEach((function(t){r.attributes.hasOwnProperty(t)&&(r.attributes[t]=parseInt(r.attributes[t],10))})),void n.trigger("data",r);n.trigger("data",{type:"tag",data:t.slice(4)})}}}else n.trigger("data",{type:"comment",text:t.slice(1)})})):this.trigger("data",{type:"uri",uri:t}))},r.addParser=function(t){var e=this,r=t.expression,n=t.customType,i=t.dataParser,a=t.segment;"function"!==typeof i&&(i=function(t){return t}),this.customParsers.push((function(t){if(r.exec(t))return e.trigger("data",{type:"custom",data:i(t),customType:n,segment:a}),!0}))},r.addTagMapper=function(t){var e=t.expression,r=t.map;this.tagMappers.push((function(t){return e.test(t)?r(t):t}))},e}(a),m=function(t){var e={};return Object.keys(t).forEach((function(r){var n;e[(n=r,n.toLowerCase().replace(/-(\w)/g,(function(t){return t[1].toUpperCase()})))]=t[r]})),e},v=function(t){var e=t.serverControl,r=t.targetDuration,n=t.partTargetDuration;if(e){var i="#EXT-X-SERVER-CONTROL",a="holdBack",s="partHoldBack",o=r&&3*r,u=n&&2*n;r&&!e.hasOwnProperty(a)&&(e[a]=o,this.trigger("info",{message:i+" defaulting HOLD-BACK to targetDuration * 3 ("+o+")."})),o&&e[a]<o&&(this.trigger("warn",{message:i+" clamping HOLD-BACK ("+e[a]+") to targetDuration * 3 ("+o+")"}),e[a]=o),n&&!e.hasOwnProperty(s)&&(e[s]=3*n,this.trigger("info",{message:i+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+e[s]+")."})),n&&e[s]<u&&(this.trigger("warn",{message:i+" clamping PART-HOLD-BACK ("+e[s]+") to partTargetDuration * 2 ("+u+")."}),e[s]=u)}},y=function(t){function e(){var e;(e=t.call(this)||this).lineStream=new d,e.parseStream=new g,e.lineStream.pipe(e.parseStream);var r,n,i=l()(e),a=[],s={},u=!1,f=function(){},h={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},p=0;e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var y=0,b=0;return e.on("end",(function(){s.uri||!s.parts&&!s.preloadHints||(!s.map&&r&&(s.map=r),!s.key&&n&&(s.key=n),s.timeline||"number"!==typeof p||(s.timeline=p),e.manifest.preloadSegment=s)})),e.parseStream.on("data",(function(t){var e,l;({tag:function(){({version:function(){t.version&&(this.manifest.version=t.version)},"allow-cache":function(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var e={};"length"in t&&(s.byterange=e,e.length=t.length,"offset"in t||(t.offset=y)),"offset"in t&&(s.byterange=e,e.offset=t.offset),y=e.offset+e.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),t.duration>0&&(s.duration=t.duration),0===t.duration&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){if(t.attributes)if("NONE"!==t.attributes.METHOD)if(t.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===t.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(t.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===t.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==t.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):t.attributes.KEYID&&"0x"===t.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:t.attributes.KEYFORMAT,keyId:t.attributes.KEYID.substring(2)},pssh:Object(c.a)(t.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),n={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},"undefined"!==typeof t.attributes.IV&&(n.iv=t.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else n=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence":function(){isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,p=t.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type":function(){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map:function(){r={},t.uri&&(r.uri=t.uri),t.byterange&&(r.byterange=t.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||h,t.attributes?(s.attributes||(s.attributes={}),o()(s.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||h,t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME){var r=this.manifest.mediaGroups[t.attributes.TYPE];r[t.attributes["GROUP-ID"]]=r[t.attributes["GROUP-ID"]]||{},e=r[t.attributes["GROUP-ID"]],(l={default:/yes/i.test(t.attributes.DEFAULT)}).default?l.autoselect=!0:l.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(l.language=t.attributes.LANGUAGE),t.attributes.URI&&(l.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(l.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(l.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(l.forced=/yes/i.test(t.attributes.FORCED)),e[t.attributes.NAME]=l}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){p+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){"undefined"===typeof this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject),s.dateTimeString=t.dateTimeString,s.dateTimeObject=t.dateTimeObject},targetduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):(this.manifest.targetDuration=t.duration,v.call(this,this.manifest))},start:function(){t.attributes&&!isNaN(t.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){s.cueOut=t.data},"cue-out-cont":function(){s.cueOutCont=t.data},"cue-in":function(){s.cueIn=t.data},skip:function(){this.manifest.skip=m(t.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",t.attributes,["SKIPPED-SEGMENTS"])},part:function(){var e=this;u=!0;var r=this.manifest.segments.length,n=m(t.attributes);s.parts=s.parts||[],s.parts.push(n),n.byterange&&(n.byterange.hasOwnProperty("offset")||(n.byterange.offset=b),b=n.byterange.offset+n.byterange.length);var i=s.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #"+i+" for segment #"+r,t.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((function(t,r){t.hasOwnProperty("lastPart")||e.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+r+" lacks required attribute(s): LAST-PART"})}))},"server-control":function(){var e=this.manifest.serverControl=m(t.attributes);e.hasOwnProperty("canBlockReload")||(e.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),v.call(this,this.manifest),e.canSkipDateranges&&!e.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function(){var e=this.manifest.segments.length,r=m(t.attributes),n=r.type&&"PART"===r.type;s.preloadHints=s.preloadHints||[],s.preloadHints.push(r),r.byterange&&(r.byterange.hasOwnProperty("offset")||(r.byterange.offset=n?b:0,n&&(b=r.byterange.offset+r.byterange.length)));var i=s.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+i+" for segment #"+e,t.attributes,["TYPE","URI"]),r.type)for(var a=0;a<s.preloadHints.length-1;a++){var o=s.preloadHints[a];o.type&&(o.type===r.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+i+" for segment #"+e+" has the same TYPE "+r.type+" as preload hint #"+a}))}},"rendition-report":function(){var e=m(t.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(e);var r=this.manifest.renditionReports.length-1,n=["LAST-MSN","URI"];u&&n.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+r,t.attributes,n)},"part-inf":function(){this.manifest.partInf=m(t.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",t.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),v.call(this,this.manifest)}}[t.tagType]||f).call(i)},uri:function(){s.uri=t.uri,a.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),n&&(s.key=n),s.timeline=p,r&&(s.map=r),b=0,s={}},comment:function(){},custom:function(){t.segment?(s.custom=s.custom||{},s.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(i)})),e}i()(e,t);var r=e.prototype;return r.warnOnMissingAttributes_=function(t,e,r){var n=[];r.forEach((function(t){e.hasOwnProperty(t)||n.push(t)})),n.length&&this.trigger("warn",{message:t+" lacks required attribute(s): "+n.join(", ")})},r.push=function(t){this.lineStream.push(t)},r.end=function(){this.lineStream.push("\n"),this.trigger("end")},r.addParser=function(t){this.parseStream.addParser(t)},r.addTagMapper=function(t){this.parseStream.addTagMapper(t)},e}(a)},,,function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(1),i=r(8);function a(t){return function(e){var r=new s(t),n=e.lift(r);return r.caught=n}}var s=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.selector,this.caught))},t}(),o=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.selector=r,i.caught=n,i}return n.a(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=void 0;try{r=this.selector(e,this.caught)}catch(s){return void t.prototype.error.call(this,s)}this._unsubscribeAndRecycle();var n=new i.a(this);this.add(n);var a=Object(i.c)(r,n);a!==n&&this.add(a)}},e}(i.b)},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(1),i=r(3);function a(t){return void 0===t&&(t=-1),function(e){return e.lift(new s(t,e))}}var s=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new o(t,this.count,this.source))},t}(),o=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.count=r,i.source=n,i}return n.a(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=this.source,n=this.count;if(0===n)return t.prototype.error.call(this,e);n>-1&&(this.count=n-1),r.subscribe(this._unsubscribeAndRecycle())}},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(1),i=r(26),a=r(15),s=r(8);function o(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"===typeof e?function(n){return n.pipe(o((function(r,n){return Object(a.a)(t(r,n)).pipe(Object(i.a)((function(t,i){return e(r,t,n,i)})))}),r))}:("number"===typeof e&&(r=e),function(e){return e.lift(new u(t,r))})}var u=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.project,this.concurrent))},t}(),l=function(t){function e(e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=r,i.concurrent=n,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return n.a(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new s.a(this),r=this.destination;r.add(e);var n=Object(s.c)(t,e);n!==e&&r.add(n)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(s.b)},function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(0),i=r(21),a=r(26),s=r(13),o=r(15);function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){var r=t[0];if(Object(i.a)(r))return l(r,null);if(Object(s.a)(r)&&Object.getPrototypeOf(r)===Object.prototype){var n=Object.keys(r);return l(n.map((function(t){return r[t]})),n)}}if("function"===typeof t[t.length-1]){var o=t.pop();return l(t=1===t.length&&Object(i.a)(t[0])?t[0]:t,null).pipe(Object(a.a)((function(t){return o.apply(void 0,t)})))}return l(t,null)}function l(t,e){return new n.a((function(r){var n=t.length;if(0!==n)for(var i=new Array(n),a=0,s=0,u=function(u){var l=Object(o.a)(t[u]),c=!1;r.add(l.subscribe({next:function(t){c||(c=!0,s++),i[u]=t},error:function(t){return r.error(t)},complete:function(){++a!==n&&c||(s===n&&r.next(e?e.reduce((function(t,e,r){return t[e]=i[r],t}),{}):i),r.complete())}}))},l=0;l<n;l++)u(l);else r.complete()}))}},function(t,e,r){"use strict";r.d(e,"a",(function(){return p}));var n=r(1),i=r(0),a=r(3),s=r(4),o=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),u=function(t){function e(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return n.a(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(s.a),l=r(12),c=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return n.a(e,t),e}(a.a),d=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return n.a(e,t),e.prototype[l.a]=function(){return new c(this)},e.prototype.lift=function(t){var e=new f(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new o;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new o;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new o;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new o;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new o;return this.hasError?(t.error(this.thrownError),s.a.EMPTY):this.isStopped?(t.complete(),s.a.EMPTY):(this.observers.push(t),new u(this,t))},e.prototype.asObservable=function(){var t=new i.a;return t.source=this,t},e.create=function(t,e){return new f(t,e)},e}(i.a),f=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return n.a(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):s.a.EMPTY},e}(d),h=r(8);function p(t){return function(e){return e.lift(new g(t,e))}}var g=function(){function t(t,e){this.notifier=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new m(t,this.notifier,this.source))},t}(),m=function(t){function e(e,r,n){var i=t.call(this,e)||this;return i.notifier=r,i.source=n,i}return n.a(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=this.errors,n=this.retries,i=this.retriesSubscription;if(n)this.errors=void 0,this.retriesSubscription=void 0;else{r=new d;try{n=(0,this.notifier)(r)}catch(a){return t.prototype.error.call(this,a)}i=Object(h.c)(n,new h.a(this))}this._unsubscribeAndRecycle(),this.errors=r,this.retries=n,this.retriesSubscription=i,r.next(e)}},e.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=void 0),e&&(e.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype.notifyNext=function(){var t=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=t,this.source.subscribe(this)},e}(h.b)},function(t,e,r){"use strict";function n(t){return t&&"function"===typeof t.schedule}r.d(e,"a",(function(){return u}));var i=r(0),a=r(24),s=r(14);function o(t,e){return e?Object(s.a)(t,e):new i.a(Object(a.a)(t))}function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return n(r)?(t.pop(),Object(s.a)(t,r)):o(t)}},function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(0),i=r(15),a=new n.a((function(t){return t.complete()}));function s(t){return t?function(t){return new n.a((function(e){return t.schedule((function(){return e.complete()}))}))}(t):a}function o(t){return new n.a((function(e){var r;try{r=t()}catch(n){return void e.error(n)}return(r?Object(i.a)(r):s()).subscribe(e)}))}}]]);
//# sourceMappingURL=2.b9e1cf1f.chunk.js.map
(this["webpackJsonpmy-video-app"]=this["webpackJsonpmy-video-app"]||[]).push([[0],{51:function(e,n,t){},53:function(e,n,t){},79:function(e,n,t){"use strict";t.r(n);var r,c,u=t(6),a=t.n(u),o=t(42),i=t.n(o),s=(t(51),t(32)),d=t(28),f=t.n(d),p=t(43),b=t(46),l=(t(53),t(29)),j=t.n(l),m=t(89),v=t(88),O=t(86),g=t(24),h=t(87),y=t(83),x=t(84),w=t(85),L=t(9),k=t(80),S=t(78),R="https://uskid.oss-accelerate.aliyuncs.com/playback/20200523/qn5w3mn75/2_6gr4jM07dBixDv4D.m3u8",U=null!==(r=null===(c=R.match(/(.*)\/.*.m3u8$/))||void 0===c?void 0:c[1])&&void 0!==r?r:"";var B=function(){var e=Object(u.useState)(!1),n=Object(b.a)(e,2),t=n[0],r=n[1],c=Object(u.useMemo)((function(){return new S.mp4.Transmuxer}),[]),a=Object(u.useMemo)((function(){return new MediaSource}),[]),o=Object(u.useRef)(),i=Object(u.useRef)(null),d=Object(u.useRef)([]);return Object(u.useEffect)((function(){i.current&&(i.current.src=URL.createObjectURL(a));var e=function(){var e;a.endOfStream(),null===(e=i.current)||void 0===e||e.play(),r(!0)},n=function(){var n=Object(p.a)(f.a.mark((function n(){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(d.current.length<=0)){n.next=2;break}return n.abrupt("return");case 2:i.current&&URL.revokeObjectURL(i.current.src),o.current=a.addSourceBuffer('video/mp4; codecs="mp4a.40.2,avc1.64001f"'),c.on("data",(function(n){console.log('transmuxer.on("data"',n);var t=new Uint8Array(n.initSegment.byteLength+n.data.byteLength);t.set(n.initSegment,0),t.set(n.data,n.initSegment.byteLength),console.log(S.mp4.tools.inspect(t)),o.current.addEventListener("updateend",e),o.current.appendBuffer(t)}));case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();a.addEventListener("sourceopen",n);var t;(t=R,Object(m.a)((function(){return j.a.get(t)})).pipe(Object(g.a)((function(e){return e.data})),Object(h.a)((function(e){return e})),Object(y.a)((function(e){return Object(v.a)({error:!0,message:e.message})})))).subscribe({next:function(e){var n,t=function(e){var n=new k.Parser;return n.push(e),n.end(),n.manifest.segments.map((function(e){return e.uri})).map((function(e){return"".concat(U,"/").concat(e)}))}(e);(n=d.current).push.apply(n,Object(s.a)(t)),Object(v.a)(t).pipe(Object(w.a)((function(e){return O.a.apply(void 0,Object(s.a)(e.map((function(e){return(n=e,Object(m.a)((function(){return j.a.get(n,{responseType:"arraybuffer"})})).pipe(Object(g.a)((function(e){return e.data})),Object(x.a)(10))).pipe(Object(g.a)((function(e){return new Uint8Array(e)})));var n}))))})),Object(y.a)((function(e){return Object(v.a)({error:!0,message:e.message})}))).subscribe({next:function(e){console.log("segments$.subscribe-item",e),e.forEach((function(e){return c.push(e)})),c.flush()},error:console.log,complete:function(){return console.log("segments-done")}})},complete:function(){return console.log("data-done")}})}),[]),Object(L.jsxs)("div",{className:"App",children:[!t&&"loading",Object(L.jsx)("video",{id:"video",width:400,height:300,className:"video",controls:!0,ref:i}),t&&Object(L.jsxs)("div",{children:[Object(L.jsx)("button",{onClick:function(){var e;return null===(e=i.current)||void 0===e?void 0:e.play()},children:"\u64ad\u653e"}),Object(L.jsx)("button",{onClick:function(){var e;return null===(e=i.current)||void 0===e?void 0:e.pause()},children:"\u6682\u505c"})]})]})},C=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,90)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,u=n.getLCP,a=n.getTTFB;t(e),r(e),c(e),u(e),a(e)}))};i.a.render(Object(L.jsx)(a.a.StrictMode,{children:Object(L.jsx)(B,{})}),document.getElementById("root")),C()}},[[79,1,2]]]);
//# sourceMappingURL=main.0119b21d.chunk.js.map